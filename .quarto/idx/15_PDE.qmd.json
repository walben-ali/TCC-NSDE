{"title":"Heat Equation","markdown":{"headingText":"Heat Equation","containsRefs":false,"markdown":"::: {.content-hidden}\n{{< include _macros.qmd >}}\n:::\n\nOrdinary differential equations have been the main focus of this course so far but this will now be extended to *partial differential equations*.  The differential equations that will be studied here are the *1-Dimensional Heat (or Diffusion) Equation* and the *1-Dimensional Advection (or Convection) Equation*.\n\n\nThe 1-dimensional *heat* (or *diffusion*) *equation* is a partial differential equation that represents the heat transfer across a rod and is given by\n$$\\pdiff{u}{t}=\\alpha \\Pdiff{u}{x}{2} \\qtq{with} 0<x<L \\qtq{and} t>0$$\nwhere $u=u(x,t)$ is the temperature at location $x$ at time $t$ and $\\alpha$ is the thermal diffusivity[^alpha].  This equation represents the flow of heat along the length of a rod of length $L$.\n\n[^alpha]:  The thermal diffusivity will always be regarded as a constant and usually takes the form $\\alpha=\\frac{k}{\\rho Cp}$ where $k$ is the thermal conductivity, $\\rho$ is the density of the material and $Cp$ is the specific heat capacity.\n\nThis partial differential equation has three derivatives in total, two derivatives in $x$ and one derivative in $t$, this means that three conditions are needed, two on $x$ and one on $t$:\n\n- $u(x,0)=u_{init}(x)$ for $x \\in [0,L]$:  Initial heat distribution across the rod;\n- $u(0,t)=u_l(t)$ for $t>0$:  The temperature at the left end of the rod;\n- $u(L,t)=u_r(t)$ for $t>0$:  The temperature at the right end of the rod.\n\nThis set of conditions along with the differential equation are known collectively as an ***Initial-Boundary Value Problem*** and can be solved using the ***Method of Lines***.\n\n## The Method of Lines for the Heat Equation\n\nThe outline of the method of lines for the heat equation is as follows:\n\n1. Divide the spatial interval $[0,L]$ into $N_x$ equally sized sections and label the points as $x_0, x_1, x_2, \\dots, x_N$ where $x_n=nh$ and the spatial interval width is $h_x=\\frac{L}{N}$.\n\n![](figures/Disc.jpg)\n\n2. **Left Hand Side**:  For each point $x_n$, define the approximation $U_n(t) \\approx u(x_n,t)$.  Therefore the left hand side of the heat equation can be written as\n$$\\pdiff{u}{t}(x_n,t) \\approx \\odiff{U_n}{t}(t)$$\nand this holds for $n=1, 2, \\dots, N-1$ since $U_0(t) \\approx u(0,t)=u_l(t)$ and $U_N(t) \\approx u(L,t)=u_r(t)$ are already known from the boundary conditions.  Notice that the derivative of $U_n$ is an ordinary derivative since $U_n$ is a function of $t$ only.\n\n3. **Right Hand Side**:  Use the finite difference approximation to approximate the *spatial* derivative in the differential equation.  Here, the centred difference approximation for the second derivative will be used, namely\n$$\\Pdiff{u}{x}{2}(x_n,t) \\approx \\frac{U_{n+1}(t)-2U_{n}(t)+U_{n-1}(t)}{h_x^2}.$$\nTherefore the right hand side of the heat equation will become\n$$\\alpha \\Pdiff{u}{x}{2}(x_n,t) \\approx \\frac{\\alpha}{h_x^2}\\left[ U_{n-1}(t)-2U_n(t)+U_{n+1}(t) \\right].$$\nThis holds for $n=1, 2, \\dots, N-1$ bearing in mind, once again, that $U_0(t) \\approx u(0,t)=u_l(t)$ and $U_N(t) \\approx u(L,t)=u_r(t)$ are known beforehand.\n\n4.  These can be combined to give the discretised form of the heat equation\n$$\\odiff{U_n}{t}=\\frac{\\alpha}{h_x^2}\\left[ U_{n-1}-2U_n+U_{n+1} \\right]$$\nfor all $n=1,2,\\dots,N-1$ where $U_n=U_n(t)$.  This means that the partial differential equation has been split into $N-1$ ordinary differential equations.\n\n5. This entire system of $N-1$ equations can now be written in matrix form as $\\Btdiff{U}=A\\B{U}+\\B{b}$ where\n\\begin{multline*}\n\\odiff{}{t}\\underbrace{\\begin{pmatrix}\n\tU_1(t) \\\\\n\tU_2(t) \\\\\n\tU_3(t) \\\\\n\t\\vdots \\\\\n\tU_{N-3}(t) \\\\\n\tU_{N-2}(t) \\\\\n\tU_{N-1}(t) \\\\\n\\end{pmatrix}}_{\\B{U}}=\n\\underbrace{\\frac{\\alpha}{h_x^2}\\begin{pmatrix}\n\t-2 & 1 & 0 & \\dots & 0 & 0 & 0 \\\\\n\t1 & -2 & 1 & \\dots & 0 & 0 & 0 \\\\\n\t0 & 1 & -2 & \\dots & 0 & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots & \\vdots \\\\\n\t0 & 0 & 0 & \\dots & -2 & 1 & 0 \\\\\n\t0 & 0 & 0 & \\dots & 1 & -2 & 1 \\\\\n\t0 & 0 & 0 & \\dots & 0 & 1 & -2 \\\\\n\\end{pmatrix}}_{A}\n\\underbrace{\\begin{pmatrix}\n\tU_1(t) \\\\\n\tU_2(t) \\\\\n\tU_3(t) \\\\\n\t\\vdots \\\\\n\tU_{N-3}(t) \\\\\n\tU_{N-2}(t) \\\\\n\tU_{N-1}(t) \\\\\n\\end{pmatrix}}_{\\B{U}} \\\\\n+\\underbrace{\\frac{\\alpha}{h_x^2}\\begin{pmatrix}\n\tu_l(t) \\\\\n\t0 \\\\\n\t0 \\\\\n\t\\vdots \\\\\n\t0 \\\\\n\t0 \\\\\n\tu_r(t) \\\\\n\\end{pmatrix}}_{\\B{b}}\n\\end{multline*}\nsubject to the *initial condition*\n$$\n\\B{U}_0=\\begin{pmatrix}\nU_1(0) \\\\ U_2(0) \\\\ U_3(0) \\\\ \\vdots \\\\ U_{N-3}(0) \\\\ U_{N-2}(0) \\\\ U_{N-1}(0)\n\\end{pmatrix}\\approx\\begin{pmatrix}\nu(x_1,0) \\\\ u(x_2,0) \\\\ u(x_3,0) \\\\ \\vdots \\\\ u(x_{N-3},0) \\\\ u(x_{N-2},0) \\\\ u(x_{N-1},0)\n\\end{pmatrix} =\\begin{pmatrix}\n\tu_{init}(x_1) \\\\\n\tu_{init}(x_2) \\\\\n\tu_{init}(x_3) \\\\\n\t\\vdots \\\\\n\tu_{init}(x_{N-3}) \\\\\n\tu_{init}(x_{N-2}) \\\\\n\tu_{init}(x_{N-1}) \\\\\n\\end{pmatrix}.\n$$\nThis system can now be solved using any of the IVP solvers with a temporal stepsize $h_t$.\n\nIn essence, the *Method of Lines* has converted a PDE into a set of ODEs using the same techniques as BVPs and will be solved in the same way as IVPs.\n\n::: {.callout-caution title=\"Heat Equation\"}\nConsider an iron rod (of thermal diffusivity $\\alpha=2.3\\E{-5}$) of length 1 where the middle section of length 0.2 has been heated to a temperature of 1 while the rest is at 0.  The ends of the rod have been kept at a constant temperature of 2.  This system can be represented by the IBVP\n$$\\pdiff{u}{t}=\\alpha\\Pdiff{u}{t}{2}, \\quad x \\in [0,1], \\quad t>0$$\n$$u(x,0)=u_{init}(x)=\\left\\{\n\\begin{matrix}\n\t\t0 & 0 \\leq x<0.4 \\\\\n\t\t1 & 0.4 \\leq x <0.6 \\\\\n\t\t0 & 0.6 \\leq x \\leq 1 \\\\\n\\end{matrix} \\right. , \\quad u(0,t)=u_l(t)=2, \\quad u(L,t)=u_r(t)=2.$$\n\nFirst, divide the interval $[0,1]$ into five equal sections (which will be of width $h_x=\\frac{1-0}{5}=0.2$).\n![](figures/Disc02.jpg)\n\nThis system can be discretised using the centred difference method and written in matrix form as $\\Btdiff{U}=A\\B{U}+\\B{b}$ where\n$$\n\t\\odiff{}{t}\\underbrace{\\begin{pmatrix}\n\t\tU_1(t) \\\\\n\t\tU_2(t) \\\\\n\t\tU_3(t) \\\\\n\t\tU_4(t) \\\\\n\t\tU_5(t)\n\t\\end{pmatrix}}_{\\B{U}}=\n\t\\underbrace{\\frac{\\alpha}{h^2}\\begin{pmatrix}\n\t\t-2 & 1 & 0 & 0 & 0 \\\\\n\t\t1 & -2 & 1 & 0 & 0 \\\\\n\t\t0 & 1 & -2 & 1 & 0 \\\\\n\t\t0 & 0 & 1 & -2 & 1 \\\\\n\t\t0 & 0 & 0 & 1 & -2\n\t\\end{pmatrix}}_{A}\n\t\\underbrace{\\begin{pmatrix}\n\t\tU_1(t) \\\\\n\t\tU_2(t) \\\\\n\t\tU_3(t) \\\\\n\t\tU_4(t) \\\\\n\t\tU_5(t) \\\\\n\t\\end{pmatrix}}_{\\B{U}}+\n\t\\underbrace{\\frac{\\alpha}{h^2}\\begin{pmatrix}\n\t\tu_l(t) \\\\\n\t\t0 \\\\\n\t\t0 \\\\\n\t\t0 \\\\\n\t\tu_r(t) \\\\\n\t\\end{pmatrix}}_{\\B{b}}\n$$\nThe differential equation\n$$\\odiff{\\B{U}}{t}=A\\B{U}+\\B{b}$$\ncan be solved using the Euler method with the initial condition\n$$\n\t\\B{U}(0)=\\begin{pmatrix}\n\t\tu_{init}(x_1) \\\\\n\t\tu_{init}(x_2) \\\\\n\t\tu_{init}(x_3) \\\\\n\t\tu_{init}(x_4) \\\\\n\t\tu_{init}(x_5) \\\\\n\t\\end{pmatrix}\n$$\nsubject to a time stepsize $h_t$.  Below are the plots of the heat distribution at $t=0, 100, 1000$ for $N_x=500$ ($h_x=0.002$) and $h_t=0.02$ ($N_t=50000$).\n![](figures/Heat1.jpg)\n![](figures/Heat2.jpg)\n![](figures/Heat3.jpg)\nAt the beginning, the temperature at the ends is 2 and the middle section is at a temperature of 1.  As time progresses, the heat evens out across the iron bar until eventually, the whole bar will be the same temperature.\n:::\n\n## Linear Advection Equation\n\nThe heat equation deals with heat transfer through diffusion throughout a material.  Another way in which heat transfer can be achieved by advection (or convection) and this is given by\n$$\\pdiff{u}{t}=-v \\pdiff{u}{x} \\qtq{with} 0<x<L \\qtq{and} t>0$$\nwhere $u=u(x,t)$ is the temperature at location $x$ at time $t$ and $v$ is the flow speed.\n\nThis partial differential equation has two derivatives in total, one in $x$ and one in $t$, this means that two conditions are needed, one spatial and one temporal:\n\n- $u(x,0)=u_{init}(x)$ for $x \\in [0,L]$:  Initial heat distribution across the rod;\n- $u(0,t)=u_l(t)$ for $t>0$:  The temperature at the left end of the rod.\n\nConsider the PDE along with the initial condition only, namely $u(x,0)=u_{init}(x)$ for $x \\in [0,L]$.  The exact solution to this differential equation is given by\n$$u(x,t)=u_{init}(x-vt),$$\nthis can be verified from the partial differential equation as follows:\n$$\\pdiff{u}{t}=-v \\pdiff{u}{x} \\quad \\text{at} \\quad u(x,t)=u_{init}(x-vt)$$\n\\begin{align*}\n\t&\\text{LHS}=\\pdiff{}{t}u(x,t)=\\pdiff{}{t}\\nbr{u_{init}(x-vt)}=-vu_{init}'(x-vt)\\\\\n\t&\\text{RHS}=\\pdiff{}{x}u(x,t)=\\pdiff{}{x}\\nbr{u_{init}(x-vt)}=-vu_{init}'(x-vt).\n\\end{align*}\nThis means that if the initial heat profile takes the form of $u_{init}(x)$, then after time $t$, the profile will look exactly the same but shifted to the right by a distance $vt$.\n\n![](figures/Advection.jpg)\n\nThe \"information\" moves from left to right so if the finite differences are to be used, the centred differencing approach would not be suitable since the information on the right is not known yet.  Therefore the backwards differencing approximation will be the most suitable.  This is known as an *upwind/upstream scheme* (i.e. against the direction of the wind/stream) if $v>0$.  Therefore using the convention $U_n(t) \\approx u(x_n,t)$ where $x=x_n$ is the discretisation of the spatial points for $n=0,1,2,\\dots,N$, the backward differencing approximation to the spatial derivative is\n$$\\pdiff{u}{x}(x_n,t) \\approx \\pdiff{U_n}{x}=\\frac{U_n-U_{n-1}}{h_x}.$$\nTherefore is discretised advection equation is\n$$\\odiff{U_n}{t}= \\frac{v}{h_x}\\nbr{U_{n-1}-U_n} \\qtq{for} n=1,2,\\dots,N$$\nand this can be solved subject to the initial condition\n$$u(x,0)=u_{init}(x)$$\nand boundary condition\n$$u(0,t)=u_{l}(t)$$\nto give the discretised set of equations in the form $\\Btdiff{U}=A\\B{U}+\\B{b}$ where\n\\begin{multline*}\n     \\odiff{}{t}\\underbrace{\\begin{pmatrix}\n\t\tU_1(t) \\\\\n\t\tU_2(t) \\\\\n\t\tU_3(t) \\\\\n\t\t\\vdots \\\\\n\t\tU_{N-2}(t) \\\\\n\t\tU_{N-1}(t) \\\\\n\t\tU_N(t)\n\t\\end{pmatrix}}_{\\B{U}}=\n\t\\underbrace{\\frac{v}{h_x}\\begin{pmatrix}\n\t\t-1 & 0 & 0 & \\dots & 0 & 0 & 0 \\\\\n\t\t1 & -1 & 0 & \\dots & 0 & 0 & 0 \\\\\n\t\t0 & 1 & -1 & \\dots & 0 & 0 & 0 \\\\\n\t\t\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots & \\vdots \\\\\n\t\t0 & 0 & 0 & \\dots & -1 & 0 & 0 \\\\\n\t\t0 & 0 & 0 & \\dots & 1 & -1 & 0 \\\\\n\t\t0 & 0 & 0 & \\dots & 0 & 1 & -1 \\\\\n\t\\end{pmatrix}}_{A}\n\t\\underbrace{\\begin{pmatrix}\n\t\tU_1(t) \\\\\n\t\tU_2(t) \\\\\n\t\tU_3(t) \\\\\n\t\t\\vdots \\\\\n\t\tU_{N-2}(t) \\\\\n\t\tU_{N-1}(t) \\\\\n\t\tU_N(t)\n\t\\end{pmatrix}}_{\\B{U}}\\\\+\n\t\\underbrace{\\frac{v}{h_x}\\begin{pmatrix}\n\t\tu_l(t) \\\\\n\t\t0 \\\\\n\t\t0 \\\\\n\t\t\\vdots \\\\\n\t\t0 \\\\\n\t\t0 \\\\\n\t\t0 \\\\\n\t\\end{pmatrix}}_{\\B{b}}\n\\end{multline*}\nand the initial condition is\n$$\n\\B{U}_0=\\begin{pmatrix}\n\tU_1(0) \\\\ U_2(0) \\\\ U_3(0) \\\\ \\vdots \\\\ U_{N-3}(0) \\\\ U_{N-2}(0) \\\\ U_{N-1}(0)\n\\end{pmatrix}\\approx\\begin{pmatrix}\n\tu(x_1,0) \\\\ u(x_2,0) \\\\ u(x_3,0) \\\\ \\vdots \\\\ u(x_{N-3},0) \\\\ u(x_{N-2},0) \\\\ u(x_{N-1},0)\n\\end{pmatrix} =\\begin{pmatrix}\n\tu_{init}(x_1) \\\\\n\tu_{init}(x_2) \\\\\n\tu_{init}(x_3) \\\\\n\t\\vdots \\\\\n\tu_{init}(x_{N-3}) \\\\\n\tu_{init}(x_{N-2}) \\\\\n\tu_{init}(x_{N-1}) \\\\\n\\end{pmatrix}\n$$.\n\n## Convection-Diffusion Equation\n\nThe heat (or diffusion) equation dictates the spread of heat across a length of material while on the other hand, the advection (or convection) equation dictates the flow of heat in a certain direction.  The combination of these two effects gives rise to the ***Convection-Diffusion Equation*** which takes the form\n$$\\pdiff{u}{t}=\\alpha \\Pdiff{u}{x}{2}-v \\pdiff{u}{x} \\qtq{with} 0<x<L, \\quad t>0.$$\n\nJust as in the heat equation, this partial differential equation has three derivatives in total, two derivatives in $x$ and one derivative in $t$, this means that three conditions are needed, two on $x$ and one on $t$, these will be as follows:\n\n- $u(x,0)=u_{init}(x)$ for $x \\in [0,L]$:  Initial heat distribution across the rod;\n- $u(0,t)=u_l(t)$ for $t>0$:  The temperature at the left end of the rod;\n- $u(L,t)=u_r(t)$ for $t>0$:  The temperature at the right end of the rod.\n\nIn order to discretise this system, a finite difference approximation needs to be chosen first.  The centred difference approximation was used for the heat equation and the backwards difference approximation for the advection.  Here, the combination of both will be used.  Even though this might initially seem like an inconsistency, but in fact, this will allow the system to present a distinct stable advantage as will be seen in the next section.\n\nThis system can be discretised in exactly the same way as before\n$$\\odiff{U_n}{t}(t)= \\frac{\\alpha}{h_x^2}\\left[ U_{n-1}(t)-2U_n(t)+U_{n+1}(t) \\right]-\\frac{v}{h_x}\\left[U_n(t)+U_{n-1}(t) \\right] \\qtq{for} n=1,2,\\dots,N-1.$$\nThis system can be written in the form $\\Btdiff{U}=A\\B{U}+\\B{b}$ where\n$$\n\t\tA=\\frac{\\alpha}{h_x^2}\\begin{pmatrix}\n\t\t\t-2 & 1 & 0 & \\dots & 0 & 0 & 0 \\\\\n\t\t\t1 & -2 & 1 & \\dots & 0 & 0 & 0 \\\\\n\t\t\t0 & 1 & -2 & \\dots & 0 & 0 & 0 \\\\\n\t\t\t\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots & \\vdots \\\\\n\t\t\t0 & 0 & 0 & \\dots & -2 & 1 & 0 \\\\\n\t\t\t0 & 0 & 0 & \\dots & 1 & -2 & 1 \\\\\n\t\t\t0 & 0 & 0 & \\dots & 0 & 1 & -2 \\\\\n\t\t\\end{pmatrix}+\\frac{v}{h_x}\\begin{pmatrix}\n\t\t\t-1 & 0 & 0 & \\dots & 0 & 0 & 0 \\\\\n\t\t\t1 & -1 & 0 & \\dots & 0 & 0 & 0 \\\\\n\t\t\t0 & 1 & -1 & \\dots & 0 & 0 & 0 \\\\\n\t\t\t\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots & \\vdots \\\\\n\t\t\t0 & 0 & 0 & \\dots & -1 & 0 & 0 \\\\\n\t\t\t0 & 0 & 0 & \\dots & 1 & -1 & 0 \\\\\n\t\t\t0 & 0 & 0 & \\dots & 0 & 1 & -1 \\\\\n\t\t\\end{pmatrix}\n$$\n\t$$\n\t\t\\B{U}\\begin{pmatrix}\n\t\t\tU_1(t) \\\\\n\t\t\tU_2(t) \\\\\n\t\t\t\\vdots \\\\\n\t\t\tU_{N-2}(t) \\\\\n\t\t\tU_{N-1}(t) \\\\\n\t\t\\end{pmatrix}, \\quad \\B{b}=\\frac{\\alpha}{h_x^2}\\begin{pmatrix}\n\t\t\tu_l(t) \\\\\n\t\t\t0 \\\\\n\t\t\t\\vdots \\\\\n\t\t\t0 \\\\\n\t\t\tu_r(t) \\\\\n\t\t\\end{pmatrix}+\\frac{v}{h_x}\\begin{pmatrix}\n\t\t\tu_l(t) \\\\\n\t\t\t0 \\\\\n\t\t\t\\vdots \\\\\n\t\t\t0 \\\\\n\t\t\t0 \\\\\n\t\t\\end{pmatrix}.\n$$\nand this system can be solved using an Euler iteration subject to the initial condition $u(x,0)=u_{init}(x)$.\n\n## Asymptotic Stability\n\nThe method of lines is essentially a hybrid method that makes use of a combination between a finite difference approximation and the Euler method and is very effective at solving partial differential equations, as seen from solving the heat, advection and convection-diffusion equations.  The derivation of the method of lines for the different methods builds on the very same principle and the codes can be adapted quite easily.  One main issue that arises here is the choice for the stepsizes for both the spatial and temporal discretisations, i.e. the choice of $h_t$ and $h_x$ respectively. When both methods are combined, there needs to be a restriction on both stepsizes.\n\nThe first issue that needs to be addressed is the asymptotic stability of the heat equation and the advection equation.  For arbitrarily large matrices, it may not be simple to determine if all the eigenvalues are negative since it may be computationally restrictive to do so.  However, a result can be used to see if all the eigenvalues are negative without explicitly calculating them.\n\n::: {#thm-Gersh}\n## Gershgorin Circle Theorem\n\nLet $A$ be an $N \\times N$ given by\n$$\nA=\\begin{pmatrix}\n\ta_{11} & a_{12} & a_{13} & \\dots  & a_{1N} \\\\\n\ta_{21} & a_{22} & a_{23} & \\dots  & a_{2N} \\\\\n\ta_{31} & a_{32} & a_{33} & \\dots  & a_{3N} \\\\\n\t\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n\ta_{N1} & a_{N2} & a_{N3} & \\dots  & a_{NN}\n\\end{pmatrix}.\n$$\nOn the complex plane, consider $N$ closed discs, each centred at the locations $a_{ii}$ for $i=1,2,\\dots,n$ (the diagonal terms) where the disc centred at $a_{ii}$ has a radius $R_i$ where\n$$R_i=\\sum_{j \\neq i}{|a_{ij}|}.$$\nThen all the eigenvalues of the matrix $A$ will have to lie in at least one of these discs.  In other words, every eigenvalues of $A$ satisfies\n$$|\\lambda-a_{ii}| \\leq R_i \\qtq{for at least one } i=1,2,\\dots,n.$$\n:::\n\n::: {.callout-caution title=\"Gershgorin Circle Theorem Exapmple\"}\nConsider the matrix\n$$\nA=\\begin{pmatrix}\n\t-1 & 3 & 4 & 2 & -4 \\\\\n\t0 & 5 & 4 & 7 & 1 \\\\\n\t4 & -2 & 0 & -3 & 0 \\\\\n\t6 & -6 & -4 & -6 & -1 \\\\\n\t7 & 4 & 7 & 9 & 7\n\\end{pmatrix}.\n$$\nFollowing the steps of the theorem:\n\n1. Indicate the locations of the diagonal terms (namely $-1, 5, 0, -6, 7$) on the complex plane.\n\n2. Find the radii $R_i$ which are equal to the row sum of the absolute terms *without* the diagonal terms, in other words,\n$$\n\t\\text{abs}(A)=\\begin{pmatrix}\n\t1 & 3 & 4 & 2 & 4 \\\\\n\t0 & 5 & 4 & 7 & 1 \\\\\n\t4 & 2 & 0 & 3 & 0 \\\\\n\t6 & 6 & 4 & 6 & 1 \\\\\n\t7 & 4 & 7 & 9 & 7\n\\end{pmatrix}\n\\begin{matrix}\n\t\\rightarrow \\\\ \\rightarrow \\\\ \\rightarrow \\\\ \\rightarrow \\\\ \\rightarrow\n\\end{matrix}\n\\begin{matrix}\n\t3+4+2+4 \\\\ 0+4+7+1 \\\\ 4+2+3+0 \\\\ 6+6+4+1 \\\\ 7+4+7+9\n\\end{matrix}\n\\begin{matrix}\n\t=13 \\\\ =12 \\\\ =9 \\\\ =17 \\\\ =27\n\\end{matrix}\n\\begin{matrix}\n\t\\rightarrow R_1 \\\\ \\rightarrow R_2 \\\\ \\rightarrow R_3 \\\\ \\rightarrow R_4 \\\\ \\rightarrow R_5\n\\end{matrix}\n$$\n\n3. Draw a circle around $a_{11}=-1$ with radius $R_1=13$, a circle around $a_{22}=5$ with radius $R_2=12$ and so on.\n\n4. All the eigenvalues of the matrix $A$ must lie in at least one of the circles indicated.  Indeed, the following figure shows the diagonal terms each with circles around them with the appropriate radius.  The eigenvalues are given in red and the blue circles are those which contain all said eigenvalues.\n![](figures/Ger.jpg)\n:::\n\n### Stability of the Euler Method for the Advection Equation\n\nConsider the matrix $A_2$ of size $N \\times N$ from the advection equation\n$$\nA_2=\\begin{pmatrix}\n\t-1 & 0 & \\dots & 0 & 0 \\\\\n\t1 & -1 & \\dots & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n\t0 & 0 & \\dots & -1 & 0 \\\\\n\t0 & 0 & \\dots & 1 & -1 \\\\\n\\end{pmatrix}.\n$$\nFollowing the steps of the Gershgorin theorem, the centres of all the circles on the complex plane will be located at the diagonal terms, all of which are $-1$.  The radii of these circles are the row sums of the matrix $A_2$ without the diagonal terms, which means that all the radii will be 1.  The figure below shows the circle that results on the complex plane.  Therefore regardless of what the eigenvalues might be, it is known that they will always have negative real parts and therefore the advection matrix forms an asymptotically stable system.\n![](figures/Ger_Ad.jpg)\n\nSince the advection equation is asymptotically stable, a bound for the temporal stepsize needs to be found.  Consider the advection equation after the discretisation $\\Btdiff{U}=A\\B{U}+\\B{b}$ where $A=\\frac{v}{h_x}A_2$.  The Euler method is numerically stable if the time step $h_t$ satisfies\n$$\\INorm{\\II+h_t A} \\leq 1.$$\nFirst calculate $\\II+h_t A$:\n$$\n\\II+h_t A=\\II+\\frac{vh_t}{h_x}A_2=\n\\begin{pmatrix}\n\t1-\\tilde{v} & 0 & 0 & \\dots & 0 & 0 & 0 \\\\\n\t\\tilde{v} & 1-\\tilde{v} & 0 & \\dots & 0 & 0 & 0 \\\\\n\t0 & \\tilde{v} & 1-\\tilde{v} & \\dots & 0 & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots & \\vdots\\\\\n\t0 & 0 & 0 & \\dots & 0&  \\tilde{v} & 1-\\tilde{v}\n\\end{pmatrix}.\n$$\nwhere $\\tilde{v}=\\frac{vh_t}{h_x}$.  Now taking the absolute value of all the terms and taking the row sums gives:\n$$\n\\mathrm{abs}\\nbr{\\II+\\frac{vh_t}{h_x}A_2}=\n\\begin{pmatrix}\n\t|1-\\tilde{v}| & 0 & 0 & \\dots & 0 & 0 & 0 \\\\\n\t\\tilde{v} & |1-\\tilde{v}| & 0 & \\dots & 0 & 0 & 0 \\\\\n\t0 & \\tilde{v} & |1-\\tilde{v}| & \\dots & 0 & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots & \\vdots\\\\\n\t0 & 0 & 0 & \\dots & 0&  \\tilde{v} & |1-\\tilde{v}|\n\\end{pmatrix}\\begin{matrix}\n\\to \\\\ \\to \\\\ \\to \\\\ \\vdots \\\\ \\to\n\\end{matrix}\\begin{matrix}\n|1-\\tilde{v}| \\\\ \\tilde{v}+|1-\\tilde{v}| \\\\ \\tilde{v}+|1-\\tilde{v}| \\\\ \\vdots \\\\ \\tilde{v}+|1-\\tilde{v}|\n\\end{matrix}.\n$$\nThe row sums of the absolute terms of this matrix are\n$$a=|1-\\tilde{v}| \\qtq{and} b=|1-\\tilde{v}|+\\tilde{v}.$$\nSince it is assumed that $v>0$, then $b>a$ therefore, $\\INorm{\\II+h_tA}=b=|1-\\tilde{v}|+\\tilde{v}$.  Consider the two cases when $1-\\tilde{v}>0$ and $1-\\tilde{v}<0.$$\n1.  If $1-\\tilde{v}>0$, then $0<\\tilde{v}<1$:\n$$\\INorm{\\II+h_tA}=|1-\\tilde{v}|+\\tilde{v}=1-\\tilde{v}+\\tilde{v}=1.$$\nTherefore if $1-\\tilde{v}>0$, then $\\INorm{\\II+h_tA}\\leq 1$.\n\n2.  If $1-\\tilde{v}<0$, then $\\tilde{v}>1$:\n$$\\INorm{\\II+h_tA}=|1-\\tilde{v}|+\\tilde{v}=\\tilde{v}-1+\\tilde{v}=2\\tilde{v}-1,$$\ntherefore in this case, if $\\INorm{\\II+h_tA}$ needs to be less than or equal to $1$, then\n$$\\INorm{\\II+h_tA}\\leq 1 \\qiq 2\\tilde{v}-1\\leq 1 \\qiq \\tilde{v} \\leq 1$$\nwhich contradicts with the assumption that $\\tilde{v}>1$.\n\nTherefore, the Euler method will produce a convergent solution if\n$$\\tilde{v} < 1 \\quad \\implies \\quad v\\frac{h_t}{h_x}<1.$$\nIn terms of number of spatial and temporal points $N_x$ and $N_t$ respectively, this restriction would be\n$$v \\frac{t_f-t_0}{L-x_0} \\frac{N_x}{N_t} < 1$$\nSo for a fixed velocity $v$, if the time step $h_t$ is to be halved, then the spatial step would also need to be halved as well.\n\n### Stability of the Euler Method for the Heat Equation\n\nConsider the matrix $A_1$ of size $N \\times N$ from the heat equation\n$$\nA_1=\\begin{pmatrix}\n\t-2 & 1 & \\dots & 0 & 0 \\\\\n\t1 & -2 & \\dots & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n\t0 & 0 & \\dots & -2 & 1 \\\\\n\t0 & 0 & \\dots & 1 & -2 \\\\\n\\end{pmatrix}.\n$$\nThe steps of the Gershgorin theorem can be followed to produce the following figure on the complex plane.\n![](figures/Ger_Heat.jpg)\nOnce again, this shows that all the eigenvalues will have negative real parts even though their explicit values are not known.\n\nTo determine the bound on the stepsize, consider the heat equation after the discretisation, which is $\\Btdiff{U}=A\\B{U}+\\B{b}$ where $A=\\frac{\\alpha}{h_x^2}A_1$.  The Euler method is numerically stable if the time step $h_t$ satisfies\n$$\\INorm{\\II+h_t A} \\leq 1.$$\nFirst calculate $\\II+h_t A$:\n$$\n\\II+h_t A=\\II+\\frac{\\alpha h_t}{h_x^2}A_1=\n\\begin{pmatrix}\n\t1-2\\tilde{\\alpha} & \\tilde{\\alpha} & 0 & \\dots & 0 & 0 & 0 \\\\\n\t\\tilde{\\alpha} & 1-2\\tilde{\\alpha} & \\tilde{\\alpha} & \\dots & 0 & 0 & 0 \\\\\n\t0 & \\tilde{\\alpha} & 1-2\\tilde{\\alpha} & \\dots & 0 & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots & \\vdots\\\\\n\t0 & 0 & 0 & \\dots & 0&  \\tilde{\\alpha} & 1-2\\tilde{\\alpha}\n\\end{pmatrix}\n$$\nwhere $\\tilde{\\alpha}=\\frac{\\alpha h_t}{h_x^2}$.  Now taking the absolute value of all the terms and taking the row sums gives:\n$$\n\\mathrm{abs}\\nbr{\\II+\\frac{\\alpha h_t}{h_x^2}A_1}=\n\\begin{pmatrix}\n\t|1-2\\tilde{\\alpha}| & \\tilde{\\alpha} & 0 & \\dots & 0 & 0 & 0 \\\\\n\t\\tilde{\\alpha} & |1-2\\tilde{\\alpha}| & \\tilde{\\alpha} & \\dots & 0 & 0 & 0 \\\\\n\t0 & \\tilde{\\alpha} & |1-2\\tilde{\\alpha}| & \\dots & 0 & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots & \\vdots\\\\\n\t0 & 0 & 0 & \\dots & 0&  \\tilde{\\alpha} & |1-2\\tilde{\\alpha}|\n\\end{pmatrix}\\begin{matrix}\n\t\\to \\; \\; \\tilde{\\alpha}+|1-2\\tilde{\\alpha}| \\\\ \\to 2\\tilde{\\alpha}+|1-2\\tilde{\\alpha}|\\\\ \\to 2\\tilde{\\alpha}+|1-2\\tilde{\\alpha}|\\\\ \\vdots \\\\ \\to \\; \\; \\tilde{\\alpha}+|1-2\\tilde{\\alpha}|.\n\\end{matrix}\n$$\nThe row sums of the absolute terms of this matrix are\n$$a=\\tilde{\\alpha}+|1-2\\tilde{\\alpha}| \\qtq{and} b=2\\tilde{\\alpha}+|1-2\\tilde{\\alpha}|.$$\nSince $tilde{\\alpha}>0$, then $b>a$ and therefore, $\\INorm{\\II+h_tA}=b=2\\tilde{\\alpha}+|1-2\\tilde{\\alpha}|$.  Consider the two cases $1-2\\tilde{\\alpha}>0$ and $1-2\\tilde{\\alpha}<0$.\n\n1.  If $1-2\\tilde{\\alpha}>0$, then $0<\\tilde{\\alpha}<\\frac{1}{2}$:\n$$\\INorm{\\II+h_tA}=|1-2\\tilde{\\alpha}|+2\\tilde{\\alpha}=1-2\\tilde{\\alpha}+2\\tilde{\\alpha}=1,$$\ntherefore $\\INorm{\\II+h_tA} \\leq 1$.\n\n2.  If $1-2\\tilde{\\alpha}<0$, then $\\tilde{\\alpha}>\\frac{1}{2}$:\n$$\\INorm{\\II+h_tA}=|1-2\\tilde{\\alpha}|+2\\tilde{\\alpha}=2\\tilde{\\alpha}-1+2\\tilde{\\alpha}=4\\tilde{\\alpha}-1,$$\ntherefore in this case, if $\\INorm{\\II+h_tA}$ needs to be less than or equal to $1$, then\n$$\\INorm{\\II+h_tA}\\leq 1 \\qiq 4\\tilde{\\alpha}-1\\leq 1 \\qiq \\tilde{\\alpha} \\leq \\frac{1}{2}$$\nwhich contradicts with the assumption that $\\tilde{\\alpha}>\\frac{1}{2}$.\n\nThis means that the Euler method produces a stable convergent solution if\n$$\\tilde{\\alpha} < \\frac{1}{2} \\quad \\implies \\quad \\alpha\\frac{h_t}{h_x^2}<\\frac{1}{2}.$$\nIn terms of number of spatial and temporal points $N_x$ and $N_t$ respectively, this restriction would be\n$$2 \\alpha \\frac{t_f-t_0}{(L-x_0)^2} \\frac{N_x^2}{N_t} < 1$$\nSo for a fixed diffusivity $\\alpha$, if the time step $h_t$ is to be halved, then the spatial step would should be quartered.\n\n## Stability of the Convection-Diffusion Equation\n\nNow that it has been established that both the heat and advection equations are asymptotically stable and the stepsize bounds have been found, it is time to combine both cases to tackle the convection-diffusion equation.\n\nWhen discretised, the convection-diffusion equation can be written as $\\Btdiff{U}=A\\B{U}+\\B{b}$ where the matrix $A$ is given by\n$$\nA=\\frac{\\alpha}{h_x^2}\\begin{pmatrix}\n\t-2 & 1 & \\dots & 0 & 0 \\\\\n\t1 & -2 & \\dots & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n\t0 & 0 & \\dots & -2 & 1 \\\\\n\t0 & 0 & \\dots & 1 & -2 \\\\\n\\end{pmatrix}+\\frac{v}{h_x}\\begin{pmatrix}\n\t-1 & 0 & \\dots & 0 & 0 \\\\\n\t1 & -1 & \\dots & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n\t0 & 0 & \\dots & -1 & 0 \\\\\n\t0 & 0 & \\dots & 1 & -1 \\\\\n\\end{pmatrix}.\n$$\n\nThe Gershgorin theorem can be applied to the matrix $A$ to show that all the eigenvectors have negative real parts.  Indeed,\n$$\nA=\n\\begin{pmatrix}\n\t-2\\hat{\\alpha}-\\hat{v} & \\hat{\\alpha} & 0 & \\dots & 0 & 0 & 0 \\\\\n\t\\hat{\\alpha}+\\hat{v} & -2\\hat{\\alpha}-\\hat{v} & \\hat{\\alpha} & \\dots & 0 & 0 & 0 \\\\\n\t0 & \\hat{\\alpha}+\\hat{v} & -2\\hat{\\alpha}-\\hat{v} & \\dots & 0 & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots & \\vdots\\\\\n\t0 & 0 & 0 & \\dots & 0&  \\hat{\\alpha}+\\hat{v} & -2\\hat{\\alpha}-\\hat{v}\n\\end{pmatrix}.\n$$\nwhere $\\hat{\\alpha}=\\frac{\\alpha}{h_x^2}$ and $\\hat{v}=\\frac{v}{h_x}$.  By the Gershgorin theorem, the centres of the circles will be located at the diagonal terms, namely at $-2\\hat{\\alpha}-\\hat{v}$ with the radii $\\hat{\\alpha}$, $\\hat{\\alpha}+\\hat{v}$ and $2\\hat{\\alpha}+\\hat{v}$.  The largest radius is $2\\hat{\\alpha}+\\hat{v}$ which means that all the eigenvalues will be negative as shown below.  Therefore the convection-diffusion equation is asymptotically stable.\n\n![](figures/Gersch.jpg)\n\nTo find the bound for the stepsizes, consider the convection-diffusion equation after the discretisation $\\Btdiff{U}=A\\B{U}+\\B{b}$ where $A=\\frac{\\alpha}{h_x^2}A_1+\\frac{v}{h_x}A_2$.  The Euler method is numerically stable if the time step $h_t$ satisfies\n$$\\INorm{\\II+h_t A} \\leq 1.$$\nCalculating $\\II+h_t A$:\n$$\n\\II+h_t A=\n\\begin{pmatrix}\n\t1-2\\tilde{\\alpha}-\\tilde{v} & \\tilde{\\alpha} & 0 & \\dots & 0 & 0 & 0 \\\\\n\t\\tilde{\\alpha}+\\tilde{v} & 1-2\\tilde{\\alpha}-\\tilde{v} & \\tilde{\\alpha} & \\dots & 0 & 0 & 0 \\\\\n\t0 & \\tilde{\\alpha}+\\tilde{v} & 1-2\\tilde{\\alpha}-\\tilde{v} & \\dots & 0 & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots & \\vdots\\\\\n\t0 & 0 & 0 & \\dots & 1-2\\tilde{\\alpha}-\\tilde{v} & \\tilde{\\alpha} & 0\\\\\n\t0 & 0 & 0 & \\dots & \\tilde{\\alpha}+\\tilde{v} & 1-2\\tilde{\\alpha}-\\tilde{v} & \\tilde{\\alpha} \\\\\n\t0 & 0 & 0 & \\dots & 0&  \\tilde{\\alpha}+\\tilde{v} & 1-2\\tilde{\\alpha}-\\tilde{v}\n\\end{pmatrix}\n$$\nwhere $\\tilde{\\alpha}=\\frac{\\alpha h_t}{h_x^2}$ and $\\tilde{v}=\\frac{v h_t}{h_x}$.  Taking the absolute value of all the terms and adding the rows gives\n\\begin{multline*}\n\\mathrm{abs}\\nbr{\\II+h_t A}=\n\\begin{pmatrix}\n\t|1-2\\tilde{\\alpha}-\\tilde{v}| & \\tilde{\\alpha} & 0 & \\dots & 0 & 0 & 0 \\\\\n\t\\tilde{\\alpha}+\\tilde{v} & |1-2\\tilde{\\alpha}-\\tilde{v}| & \\tilde{\\alpha} & \\dots & 0 & 0 & 0 \\\\\n\t0 & \\tilde{\\alpha}+\\tilde{v} & |1-2\\tilde{\\alpha}-\\tilde{v}| & \\dots & 0 & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots & \\vdots\\\\\n\t0 & 0 & 0 & \\dots & 0&  \\tilde{\\alpha}+\\tilde{v} & |1-2\\tilde{\\alpha}-\\tilde{v}|\n\\end{pmatrix}\\\\\\begin{matrix}\n\\to \\; \\; \\; \\; \\; \\; \\; \\; \\tilde{\\alpha} +|1-2\\tilde{\\alpha}-\\tilde{v}| \\\\ \\to 2\\tilde{\\alpha}+\\tilde{v}+|1-2\\tilde{\\alpha}-\\tilde{v}|\\\\ \\to 2\\tilde{\\alpha}+\\tilde{v}+|1-2\\tilde{\\alpha}-\\tilde{v}|\\\\ \\vdots \\\\ \\to \\; \\; \\tilde{\\alpha}+\\tilde{v}+|1-2\\tilde{\\alpha}-\\tilde{v}|\n\\end{matrix}.\n\\end{multline*}\n\nThe row sums of the absolute terms of this matrix are\n$$a=\\tilde{\\alpha}+|1-2\\tilde{\\alpha}-\\tilde{v}|, \\quad b=2\\tilde{\\alpha}+\\tilde{v}+|1-2\\tilde{\\alpha}-\\tilde{v}| \\qtq{and} c=\\tilde{\\alpha}+\\tilde{v}+|1-2\\tilde{\\alpha}-\\tilde{v}|.$$\nSince $\\tilde{\\alpha}>0$ and $\\tilde{v}>0$, then $b>c>a$, therefore, $\\INorm{\\II+h_tA}=b=2\\tilde{\\alpha}+\\tilde{v}+|1-2\\tilde{\\alpha}-\\tilde{v}|$.  Consider the two cases $1-2\\tilde{\\alpha}-\\tilde{v}>0$ and $1-2\\tilde{\\alpha}-\\tilde{v}<0$.\n\n1. If $1-2\\tilde{\\alpha}-\\tilde{v}>0$, then $2\\tilde{\\alpha}+\\tilde{v}<1$:\n$$\\INorm{\\II+h_tA}=|1-2\\tilde{\\alpha}-\\tilde{v}|+2\\tilde{\\alpha}+\\tilde{v}=1-2\\tilde{\\alpha}-\\tilde{v}+2\\tilde{\\alpha}+\\tilde{v}=1,$$\ntherefore $\\INorm{\\II+h_tA} \\leq 1$.\n\n2.  If $1-2\\tilde{\\alpha}-\\tilde{v}<0$, then $2\\tilde{\\alpha}+\\tilde{v}>1$:\n$$\\INorm{\\II+h_tA}=|1-2\\tilde{\\alpha}-\\tilde{v}|+2\\tilde{\\alpha}+\\tilde{v}=2\\tilde{\\alpha}+\\tilde{v}-1+2\\tilde{\\alpha}+\\tilde{v}=4\\tilde{\\alpha}+2\\tilde{v}-1,$$\ntherefore in this case, if $\\INorm{\\II+h_tA}$ needs to be less than or equal to $1$, then\n$$\\INorm{\\II+h_tA}\\leq 1 \\qiq 4\\tilde{\\alpha}+2\\tilde{v}-1\\leq 1 \\qiq 2\\tilde{\\alpha}+\\tilde{v} \\leq 1$$\nwhich contradicts with the assumption that $2\\tilde{\\alpha}+\\tilde{v}>1$.\n\nThis means that the Euler method will produce a stable convergent solution if\n$$2\\tilde{\\alpha}+\\tilde{v} < 1 \\quad \\implies \\quad 2\\alpha\\frac{h_t}{h_x^2}+v\\frac{h_t}{h_x}<1.$$\nThis means that a choice can be made with regards to the bounds of the different components, for instance, the values of $h_x$ and $h_t$ can be chosen such that\n$$\\tilde{\\alpha}<\\frac{1}{4} \\qtq{and} \\tilde{v}<\\frac{1}{2} \\qtq{or} \\tilde{\\alpha}<\\frac{1}{3} \\qtq{and} \\tilde{v}<\\frac{1}{3}$$\nor any combination thereof provided that the choices satisfy the inequality $2\\tilde{\\alpha}+\\tilde{v} < 1$.\n\n::: {.callout-caution title=\"Bound for Convection-Diffusion\"}\n\nConsider the convection-diffusion equation\n$$\n\\pdiff{u}{t}=0.1\\Pdiff{u}{x}{2}-0.5\\pdiff{u}{x} \\quad\n\\begin{matrix}\n\tt \\in [0,10] \\\\ x \\in [-2,2]\n\\end{matrix}\n$$\n$$u(x,0)=u_{init}(x)=10, \\quad u(-2,t)=u_l(t)=1, \\quad u(2,t)=u_r(t)=0.$$\nThis can be discretised to give $\\Btdiff{U}=A\\B{U}$ where\n$$\n\\odiff{}{t}\\underbrace{\\begin{pmatrix}\n\tU_1(t) \\\\\n\tU_2(t) \\\\\n\t\\vdots \\\\\n\tU_{N-1}(t) \\\\\n\tU_N(t)\n\\end{pmatrix}}_{\\B{U}}$$\n$$=\n\\underbrace{\\left[\\frac{0.1}{h_x^2}\\begin{pmatrix}\n\t-2 & 1 & \\dots & 0 & 0 \\\\\n\t1 & -2 & \\dots & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n\t0 & 0 & \\dots & -2 & 1 \\\\\n\t0 & 0 & \\dots & 1 & -2 \\\\\n\\end{pmatrix}+\\frac{0.5}{h_x}\\begin{pmatrix}\n\t-1 & 0 & \\dots & 0 & 0 \\\\\n\t1 & -1 & \\dots & 0 & 0 \\\\\n\t\\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n\t0 & 0 & \\dots & -1 & 0 \\\\\n\t0 & 0 & \\dots & 1 & -1 \\\\\n\\end{pmatrix}\\right]}_{A}\n\\underbrace{\\begin{pmatrix}\n\tU_1(t) \\\\\n\tU_2(t) \\\\\n\t\\vdots \\\\\n\tU_{N-1}(t) \\\\\n\tU_N(t)\n\\end{pmatrix}}_{\\B{U}}\n$$\nsubject to\n$$\n\t\\B{U}(0)=\\begin{pmatrix}\n\t\tu_{init}(x_1) \\\\\n\t\tu_{init}(x_2) \\\\\n\t\t\\vdots \\\\\n\t\tu_{init}(x_{N-1}) \\\\\n\t\tu_{init}(x_{N}) \\\\\n\t\\end{pmatrix} \\qtq{where} u_{init}(x)=10.\n$$\nAs yet, the value of $N$ has not been put forward since the stepsizes need to be established first.  For a stable Euler method, the stepsizes $h_t$ and $h_x$ need to satisfy\n$$2\\alpha\\frac{h_t}{h_x^2}+v\\frac{h_t}{h_x} < 1 \\quad \\implies \\quad 2\\frac{h_t}{h_x}+5\\frac{h_t}{h_x^2}<10.$$\nIf $h_t=2.5\\E{-5}$ and $h_x=0.02$ (which corresponds to $N_t=40000$ and $N_x=100$), then the Euler method will be stable.\n:::","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["custom.scss"],"output-file":"15_PDE.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.40","fontsize":"14pt","mainfont":"Times New Roman","theme":{"light":"cosmo","dark":"darkly"}},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"pdflatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","toc":true,"output-file":"15_PDE.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"documentclass":"scrreport","papersize":"a4"},"extensions":{"book":{"selfContainedOutput":true}}},"docx":{"identifier":{"display-name":"MS Word","target-format":"docx","base-format":"docx"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"docx","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"page-width":6.5},"pandoc":{"default-image-extension":"png","to":"docx","toc":true,"output-file":"15_PDE.docx"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{},"extensions":{"book":{"selfContainedOutput":true}}},"epub":{"identifier":{"display-name":"ePub","target-format":"epub","base-format":"epub"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"epub","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":false,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"default-image-extension":"png","html-math-method":"mathml","to":"epub","output-file":"15_PDE.epub"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf","docx","epub"]}