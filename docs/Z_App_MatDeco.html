<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Numerical Solutions of Differential Equations – Appendix G — Matrix Decompositions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Z_App_GE.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Z_App_Basic.html">Appendices</a></li><li class="breadcrumb-item"><a href="./Z_App_MatDeco.html"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Matrix Decompositions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Numerical Solutions of Differential Equations</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.docx">
              <i class="bi bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Internal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Internal Workings of MATLAB</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_LinAlg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Algebra</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_LinAlg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Solving Linear Systems of Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_IVPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Initial Value Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_IVP_Euler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Euler Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_IVP_ModEuler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Modified Euler Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_IVP_RK4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The Runge-Kutta Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_IVP_InBuilt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">MATLAB’s In-Built Procedures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_IVP_Implicit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Implicit IVP Solvers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_BVPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Boundary Value Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_BVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Boundary Value Problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_MVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Mixed Value Problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_SBVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Symmetric Boundary Conditions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_PDEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Partial Differential Equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_PDE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Heat Equation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">MATLAB Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Arrays.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Arrays in MATLAB</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Loops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Loops</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Plotting in MATLAB</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_ReadWrite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Reading &amp; Writing Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_GE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Gaussian Elimination Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_MatDeco.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Matrix Decompositions</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-LU" id="toc-sec-LU" class="nav-link active" data-scroll-target="#sec-LU"><span class="header-section-number">G.1</span> LU Factorisation</a></li>
  <li><a href="#orthogonality-qr-factorisation" id="toc-orthogonality-qr-factorisation" class="nav-link" data-scroll-target="#orthogonality-qr-factorisation"><span class="header-section-number">G.2</span> Orthogonality &amp; QR Factorisation</a>
  <ul class="collapse">
  <li><a href="#qr-decomposition-using-reflections" id="toc-qr-decomposition-using-reflections" class="nav-link" data-scroll-target="#qr-decomposition-using-reflections"><span class="header-section-number">G.2.1</span> QR Decomposition Using Reflections</a></li>
  <li><a href="#qr-decomposition-using-rotations" id="toc-qr-decomposition-using-rotations" class="nav-link" data-scroll-target="#qr-decomposition-using-rotations"><span class="header-section-number">G.2.2</span> QR Decomposition Using Rotations</a></li>
  <li><a href="#qr-decomposition-in-matlab" id="toc-qr-decomposition-in-matlab" class="nav-link" data-scroll-target="#qr-decomposition-in-matlab"><span class="header-section-number">G.2.3</span> QR Decomposition in MATLAB</a></li>
  </ul></li>
  <li><a href="#eigenvalue-decomposition" id="toc-eigenvalue-decomposition" class="nav-link" data-scroll-target="#eigenvalue-decomposition"><span class="header-section-number">G.3</span> Eigenvalue Decomposition</a>
  <ul class="collapse">
  <li><a href="#eigendecomposition" id="toc-eigendecomposition" class="nav-link" data-scroll-target="#eigendecomposition"><span class="header-section-number">G.3.1</span> Eigendecomposition</a></li>
  </ul></li>
  <li><a href="#sec-SVD" id="toc-sec-SVD" class="nav-link" data-scroll-target="#sec-SVD"><span class="header-section-number">G.4</span> Singular Value Decomposition (SVD)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Z_App_Basic.html">Appendices</a></li><li class="breadcrumb-item"><a href="./Z_App_MatDeco.html"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Matrix Decompositions</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Appendix G — Matrix Decompositions</h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p>Consider the linear system <span class="math display">\[A \boldsymbol{x} = \boldsymbol{b} \quad \text{where} \quad A \in \mathbb{R}^{N \times N}, \quad \boldsymbol{x} \in \mathbb{R}^N, \quad \boldsymbol{b} \in \mathbb{R}^N.\]</span> In real-life situations, the matrix <span class="math inline">\(A\)</span> does not always have a form that lends itself to being easily solvable (like a diagonal, triangular, sparse, etc.). However, there are ways in which a matrix can be broken down into several matrices, each of which can be dealt with separately and reducing computational time.</p>
<section id="sec-LU" class="level2" data-number="G.1">
<h2 data-number="G.1" class="anchored" data-anchor-id="sec-LU"><span class="header-section-number">G.1</span> LU Factorisation</h2>
<p>Returning to the Gaussian elimination procedure outlined in <a href="Z_App_GE.html" class="quarto-xref"><span>Appendix F</span></a>, in order to convert the linear system <span class="math inline">\(A\boldsymbol{x}=\boldsymbol{b}\)</span> into the upper triangular matrix system <span class="math inline">\(U\boldsymbol{x}=\boldsymbol{g}\)</span>, a series of transformations had to be done, each represented by a matrix <span class="math inline">\(M^{(n)}\)</span> giving the form <span class="math display">\[U=MA \quad \text{where} \quad M=M^{(N-1)} M^{(N-2)} \dots M^{(1)}.\]</span> For every <span class="math inline">\(n=1,2,\dots,N-1\)</span>, the matrix <span class="math inline">\(M^{(n)}\)</span> is lower triangular which means that the product of all these matrices <span class="math inline">\(M\)</span> must also be lower triangular. Note that since <span class="math inline">\(M^{(n)}\)</span> and <span class="math inline">\(M\)</span> are both non-singular and lower triangular, then their inverses must also be lower triangular.</p>
<p>This means that the matrix <span class="math inline">\(A\)</span> can be written as <span class="math inline">\(A=LU\)</span> where <span class="math inline">\(L=M^{-1}\)</span> is a lower triangular matrix and <span class="math inline">\(U\)</span> is an upper triangular matrix. In fact <span class="math inline">\(U\)</span> is the end result of the Gaussian elimination, while <span class="math inline">\(L\)</span> has ones on the diagonal and the multipliers below the diagonal. This method is called the <strong><em>LU Decomposition</em></strong> of <span class="math inline">\(A\)</span>.</p>
<p>In the cases when there might be pivoting issues (which is when the pivot points might be equal to 0 during the Gaussian Elimination), the LU decomposition will more precisely be the <strong><em>PLU Decomposition</em></strong> (or the <strong><em>LU Decomposition with Partial Pivoting</em></strong>) where the method will produce an additional permutation matrix <span class="math inline">\(P\)</span> where <span class="math inline">\(PA=LU\)</span>. This matrix <span class="math inline">\(P\)</span> will swap rows when needed in order to have non-zero pivot points and is in fact orthogonal (i.e.&nbsp;<span class="math inline">\(P^{-1}={P}^{\mathrm{T}}\)</span>).</p>
<p>The LU decomposition can be used to solve the linear system <span class="math inline">\(A\boldsymbol{x}=\boldsymbol{b}\)</span> by splitting the matrix <span class="math inline">\(A\)</span> into two matrices with more manageable forms. Indeed, since <span class="math inline">\(A=LU\)</span>, then the system becomes <span class="math inline">\(LU\boldsymbol{x}=\boldsymbol{b}\)</span>, this can be solved as follows:</p>
<ul>
<li>Solve the lower triangular system <span class="math inline">\(L\boldsymbol{y}=\boldsymbol{b}\)</span> for <span class="math inline">\(\boldsymbol{y}\)</span> using forward substitution;</li>
<li>Solve the upper triangular <span class="math inline">\(U\boldsymbol{x}=\boldsymbol{y}\)</span> for <span class="math inline">\(\boldsymbol{x}\)</span> using backwards substitution.</li>
</ul>
<p>This is a much better way of solving the system since both equations involve a triangular matrix and this requires <span class="math inline">\(\mathcal{O}\left(N^2\right)\)</span> computations (forward and backward substitutions), which is much cheaper computationally compared to the full Gaussian elimination.</p>
<p>The advantage of using the LU decomposition is that if problems of the form <span class="math inline">\(A \boldsymbol{x}_i=\boldsymbol{b}_i\)</span> need to be solved with many different right hand sides <span class="math inline">\(\boldsymbol{b}_i\)</span> and a fixed <span class="math inline">\(A\)</span>, then only one LU decomposition is needed, and the cost for solving the individual systems is only the repeated forward and back substitutions. Note that there are other strategies optimised for specific cases (i.e.&nbsp;symmetric positive definite matrices, banded matrices, tridiagonal matrices).</p>
<p>In MATLAB, the LU decomposition can be done by a simple <code>lu</code> command:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">&gt;&gt;</span> <span class="va">A</span><span class="op">=</span>[<span class="fl">5</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">1</span><span class="op">;</span><span class="fl">1</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">1</span><span class="op">;</span><span class="fl">2</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="op">&gt;&gt;</span> [<span class="va">L</span><span class="op">,</span><span class="va">U</span>]<span class="op">=</span><span class="va">lu</span>(<span class="va">A</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="va">L</span> <span class="op">=</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>     <span class="fl">1.0000</span>        <span class="fl">0</span>        <span class="fl">0</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>     <span class="fl">0.2000</span>   <span class="fl">1.0000</span>        <span class="fl">0</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>     <span class="fl">0.4000</span>   <span class="fl">0.5000</span>   <span class="fl">1.0000</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="va">U</span> <span class="op">=</span></span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a>     <span class="fl">5.0000</span>        <span class="fl">0</span>   <span class="fl">1.0000</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>          <span class="fl">0</span>   <span class="fl">2.0000</span>   <span class="fl">0.8000</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>          <span class="fl">0</span>        <span class="fl">0</span>   <span class="fl">0.2000</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="op">&gt;&gt;</span> <span class="va">L</span><span class="op">*</span><span class="va">U</span><span class="op">-</span><span class="va">A</span>       <span class="co">% Verify if LU is equal to A</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="va">ans</span> <span class="op">=</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>     <span class="fl">0</span>   <span class="fl">0</span>   <span class="fl">0</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>     <span class="fl">0</span>   <span class="fl">0</span>   <span class="fl">0</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>     <span class="fl">0</span>   <span class="fl">0</span>   <span class="fl">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that if the output for <code>L</code> is <em>not</em> lower triangular, that means there are some pivoting issues that had to be overcome and <code>L</code> had to change to accommodate for that to maintain the fact that <span class="math inline">\(A=LU\)</span>. In this case, the PLU decomposition would be better suited to avoid that, this is done by adding one extra output to the <code>lu</code> command, in this case, <span class="math inline">\(A\)</span> will actually be the product <span class="math inline">\(A={P}^{\mathrm{T}}LU\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb2-1"><a href="#cb2-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="va">A</span><span class="op">=</span>[<span class="fl">1</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">1</span><span class="op">;</span><span class="fl">1</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">1</span><span class="op">;</span><span class="fl">2</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="op">&gt;&gt;</span> [<span class="va">L</span><span class="op">,</span><span class="va">U</span>]<span class="op">=</span><span class="va">lu</span>(<span class="va">A</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="va">L</span> <span class="op">=</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>     <span class="fl">0.5000</span>    <span class="fl">1.0000</span>    <span class="fl">1.0000</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>     <span class="fl">0.5000</span>    <span class="fl">1.0000</span>         <span class="fl">0</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>     <span class="fl">1.0000</span>         <span class="fl">0</span>         <span class="fl">0</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="va">U</span> <span class="op">=</span></span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a>     <span class="fl">2.0000</span>    <span class="fl">1.0000</span>    <span class="fl">1.0000</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>          <span class="fl">0</span>   <span class="op">-</span><span class="fl">0.5000</span>    <span class="fl">0.5000</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>          <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="op">&gt;&gt;</span> <span class="va">L</span><span class="op">*</span><span class="va">U</span><span class="op">-</span><span class="va">A</span>       <span class="co">% Verify if LU is equal to A even though</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>               <span class="co">% L is not lower triangular</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="va">ans</span> <span class="op">=</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>     <span class="fl">0</span>   <span class="fl">0</span>   <span class="fl">0</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>     <span class="fl">0</span>   <span class="fl">0</span>   <span class="fl">0</span></span>
<span id="cb2-17"><a href="#cb2-17"></a>     <span class="fl">0</span>   <span class="fl">0</span>   <span class="fl">0</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="op">&gt;&gt;</span> [<span class="va">L</span><span class="op">,</span><span class="va">U</span><span class="op">,</span><span class="va">P</span>]<span class="op">=</span><span class="va">lu</span>(<span class="va">A</span>)</span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="va">L</span> <span class="op">=</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>     <span class="fl">1.0000</span>         <span class="fl">0</span>         <span class="fl">0</span></span>
<span id="cb2-21"><a href="#cb2-21"></a>     <span class="fl">0.5000</span>    <span class="fl">1.0000</span>         <span class="fl">0</span></span>
<span id="cb2-22"><a href="#cb2-22"></a>     <span class="fl">0.5000</span>    <span class="fl">1.0000</span>    <span class="fl">1.0000</span></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="va">U</span> <span class="op">=</span></span>
<span id="cb2-24"><a href="#cb2-24"></a></span>
<span id="cb2-25"><a href="#cb2-25"></a>     <span class="fl">2.0000</span>    <span class="fl">1.0000</span>    <span class="fl">1.0000</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>          <span class="fl">0</span>   <span class="op">-</span><span class="fl">0.5000</span>    <span class="fl">0.5000</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>          <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="va">P</span> <span class="op">=</span></span>
<span id="cb2-29"><a href="#cb2-29"></a>     <span class="fl">0</span>   <span class="fl">0</span>   <span class="fl">1</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>     <span class="fl">0</span>   <span class="fl">1</span>   <span class="fl">0</span></span>
<span id="cb2-31"><a href="#cb2-31"></a>     <span class="fl">1</span>   <span class="fl">0</span>   <span class="fl">0</span></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="op">&gt;&gt;</span> <span class="va">L</span><span class="op">*</span><span class="va">U</span><span class="op">-</span><span class="va">A</span>       <span class="co">% Verify if P'LU is equal to A</span></span>
<span id="cb2-33"><a href="#cb2-33"></a><span class="va">ans</span> <span class="op">=</span></span>
<span id="cb2-34"><a href="#cb2-34"></a>     <span class="fl">0</span>   <span class="fl">0</span>   <span class="fl">0</span></span>
<span id="cb2-35"><a href="#cb2-35"></a>     <span class="fl">0</span>   <span class="fl">0</span>   <span class="fl">0</span></span>
<span id="cb2-36"><a href="#cb2-36"></a>     <span class="fl">0</span>   <span class="fl">0</span>   <span class="fl">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="orthogonality-qr-factorisation" class="level2" data-number="G.2">
<h2 data-number="G.2" class="anchored" data-anchor-id="orthogonality-qr-factorisation"><span class="header-section-number">G.2</span> Orthogonality &amp; QR Factorisation</h2>
<p>Intuitively, the concept of orthogonality is crucial for defining the “amount of information” in a set of vectors; although this is also associated with the concept of linear independence, the “most informative” linearly independent vectors are those that are also orthogonal.</p>
<p>Recall that for a set of vectors <span class="math inline">\(\boldsymbol{q}_1, \boldsymbol{q}_2, \dots, \boldsymbol{q}_M \in \mathbb{R}^N\)</span> where <span class="math inline">\(M \leq N\)</span>, the vectors are <strong><em>Orthogonal</em></strong> if <span class="math inline">\(\langle \boldsymbol{q}_m,\boldsymbol{q}_n \rangle=0\)</span> for all <span class="math inline">\(m \neq n\)</span>. The set of vectors is called <strong><em>Orthonormal</em></strong> if <span class="math display">\[\langle \boldsymbol{q}_m,\boldsymbol{q}_n \rangle=\delta_{mn}=\begin{cases}
0 &amp; \text{if} \quad m \neq n \\ 1 &amp; \text{if} \quad m=n.
\end{cases}\]</span> If <span class="math inline">\(N=M\)</span>, then the vectors form a linearly independent basis of <span class="math inline">\(\mathbb{R}^N\)</span>.</p>
<p>A square matrix <span class="math inline">\(Q\)</span> is called <strong><em>Orthogonal</em></strong> if all its columns are orthonormal to one another. Some of the properties of orthogonal matrices are:</p>
<ul>
<li>An orthogonal matrix <span class="math inline">\(Q\)</span> satisfies <span class="math inline">\(Q^{-1}={Q}^{\mathrm{T}}\)</span>, therefore <span class="math inline">\({Q}^{\mathrm{T}}Q=Q{Q}^{\mathrm{T}}=\mathcal{I}\)</span>;</li>
<li>The determinant of an orthogonal matrix is <span class="math inline">\(1\)</span> or <span class="math inline">\(-1\)</span>;</li>
<li>The product of two orthogonal matrices is orthogonal.</li>
<li>Given a matrix <span class="math inline">\(Q_1\in\mathbb{R}^{M\times K}\)</span> with <span class="math inline">\(K &lt; M\)</span> and with orthonormal columns, there exists a matrix <span class="math inline">\(Q_2\in\mathbb{R}^{M\times (M-K)}\)</span> such that <span class="math inline">\(Q = [Q_1, Q_2]\)</span> is orthogonal. In other words, for a “tall” rectangular matrix with orthonormal columns, there exist a set of vectors that can be concatenated with the matrix to form an orthogonal square matrix.</li>
<li>Orthogonal matrices preserve the 2-norm of vectors and matrices. In other words, if <span class="math inline">\(Q\in\mathbb{R}^{N\times N}\)</span> is an orthogonal matrix, then for every <span class="math inline">\(\boldsymbol{x}\in\mathbb{R}^{N}\)</span> and <span class="math inline">\(A\in\mathbb{R}^{N\times M}\)</span>: <span class="math display">\[\|Q\boldsymbol{x}\|_2 = \|\boldsymbol{x}\|_2 \quad ; \quad \|QA\|_2 = \|A\|_2.\]</span></li>
</ul>
<p>There are two particularly relevant classes of orthogonal matrices:</p>
<ul>
<li><p>The <strong><em>Householder Reflection Matrix</em></strong> (named after Alston Scott Householder) is a reflection matrix on a plane that contains the origin. The reflection matrix is given by <span class="math display">\[P = \mathcal{I}- 2\boldsymbol{v}{\boldsymbol{v}}^{\mathrm{T}}\]</span> where <span class="math inline">\(\boldsymbol{v}\)</span> is the unit vector that is normal to the hyperplane in which the reflection has been performed. The matrix <span class="math inline">\(P\)</span> is in fact symmetric and orthogonal (i.e.&nbsp;<span class="math inline">\(P^{-1}={P}^{\mathrm{T}}=P\)</span>). Reflection transformations appear in many numerical linear algebra algorithms and their main use is to transform a vector <span class="math inline">\(\boldsymbol{x} \in \mathbb{R}^N\)</span> to another vector <span class="math inline">\(\boldsymbol{y} \in \mathbb{R}^N\)</span> with the same magnitude (meaning that for given vectors <span class="math inline">\(\boldsymbol{x},\boldsymbol{y} \in \mathbb{R}^N\)</span> with <span class="math inline">\(\| \boldsymbol{x} \|_2=\| \boldsymbol{y} \|_2\)</span>, there exists a reflection matrix <span class="math inline">\(P\)</span> such that <span class="math inline">\(P\boldsymbol{x}=\boldsymbol{y}\)</span>).</p></li>
<li><p>The <strong><em>Givens Rotation Matrix</em></strong> (named after James Wallace Givens) represents a rotation in the plane that can be spanned by two vectors. The matrix of transformation is denoted <span class="math inline">\(G(i,j;\theta)\)</span> where the vector <span class="math inline">\(G(i,j;\theta)\boldsymbol{x}\)</span> is simply the vector <span class="math inline">\(\boldsymbol{x}\)</span> rotated <span class="math inline">\(\theta\)</span> radians anti-clockwise on a plane that is parallel to the <span class="math inline">\((i,j)\)</span>-plane. The matrix <span class="math inline">\(G(i,j;\theta)\)</span> is essentially an identity matrix with the <span class="math inline">\((i,i)\)</span> and <span class="math inline">\((j,j)\)</span> terms replaced by <span class="math inline">\(\cos(\theta)\)</span>, the <span class="math inline">\((i,j)\)</span> term replaced by <span class="math inline">\(\sin(\theta)\)</span> and the <span class="math inline">\((j,i)\)</span> term replaced by <span class="math inline">\(-\sin(\theta)\)</span>. For example, in <span class="math inline">\(\mathbb{R}^5\)</span>, the matrix <span class="math inline">\(G(2,4;\theta)\)</span> is <img src="figures/Rot_Mat.jpg" id="fig-Rot_Mat" class="img-fluid"></p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/Photo.jpg" class="img-fluid figure-img"></p>
<figcaption>Photo of (from the left): Jim Wilkinson, Wallace Givens, George Forsythe, Alston Householder, Peter Henrici, Fritz Bauer</figcaption>
</figure>
</div>
<p>Since both reflection and rotation matrices are orthogonal matrix transformations, a sequence of reflections and rotations can be represented by the matrix <span class="math inline">\({Q}^{\mathrm{T}}\)</span> (which would also be orthogonal). To this end, any matrix <span class="math inline">\(A \in \mathbb{R}^{M\times N}\)</span> with <span class="math inline">\(M \geq N\)</span> can be transformed by <span class="math inline">\({Q}^{\mathrm{T}} \in \mathbb{R}^{M \times M}\)</span> to give a block matrix with an upper triangular matrix occupying the first <span class="math inline">\(N\)</span> rows with <span class="math inline">\(M-N\)</span> zero rows below it, i.e. <span class="math display">\[{Q}^{\mathrm{T}}A= \left[ \begin{matrix} R_1 \\ 0 \end{matrix} \right]\]</span> where <span class="math inline">\(R_1 \in \mathbb{R}^{N\times N}\)</span> is an upper triangular square matrix. Equivalently, <span class="math inline">\(A\)</span> can be written as <span class="math inline">\(A=QR\)</span> where <span class="math inline">\(Q\)</span> is the orthogonal transformation matrix and <span class="math inline">\(R\)</span> is a block rectangular matrix consisting of a square lower triangular matrix and a block zero matrix. This type of decomposition is called the <strong><em>QR Factorisation</em></strong>. The full QR factorisation can be visually represented as follows:</p>
<div id="fig-QR1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-QR1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/QR1.jpg" id="fig-QR1" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-QR1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
</figcaption>
</figure>
</div>
<p>There is a much more concise form of the QR factorisation where only the first several columns of <span class="math inline">\(Q\)</span> are considered since the rest will be multiplied by 0 anyway, this gives an “economy version” of the QR factorisation written as <span class="math inline">\(A=Q_1R_1\)</span> which be visually represented as follows:</p>
<div id="fig-QR2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-QR2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/QR2.jpg" id="fig-QR2" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-QR2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
</figcaption>
</figure>
</div>
<p>The QR decomposition of a matrix can be performed on any matrix (square or rectangular). The following sections will show how this can be done using reflections and rotations.</p>
<section id="qr-decomposition-using-reflections" class="level3" data-number="G.2.1">
<h3 data-number="G.2.1" class="anchored" data-anchor-id="qr-decomposition-using-reflections"><span class="header-section-number">G.2.1</span> QR Decomposition Using Reflections</h3>
<p>The following will explain how the QR decomposition can be performed using reflection matrices on a square matrix <span class="math inline">\(A \in \mathbb{R}^{N \times N}\)</span>. Denote the <span class="math inline">\({n}^{\mathrm{th}}\)</span> column of the matrix <span class="math inline">\(A\)</span> by <span class="math inline">\(\boldsymbol{a}_n\)</span>, this means <span class="math inline">\(A\)</span> can be written as <span class="math display">\[A=\begin{pmatrix} \vdots &amp; \vdots &amp; &amp; \vdots \\ \boldsymbol{a}_1 &amp; \boldsymbol{a}_2 &amp; \dots &amp; \boldsymbol{a}_N \\ \vdots &amp; \vdots &amp; &amp; \vdots \end{pmatrix}.\]</span> The vector <span class="math inline">\(\boldsymbol{\mathrm{e}}_n\)</span> will denote the <span class="math inline">\({n}^{\mathrm{th}}\)</span> canonical basis vector, i.e.&nbsp;the vector with all its entries being equal to 0 except the element in location <span class="math inline">\(n\)</span> which is equal to 1.</p>
<div class="callout callout-style-default callout-caution callout-titled" title="Paralell Example">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Paralell Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>This process will also be applied in parallel to the following matrix <span class="math display">\[A=\begin{pmatrix} -1 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; -1 \\ 1 &amp; 1 &amp; 1 \end{pmatrix}.\]</span> In this case, <span class="math display">\[\boldsymbol{a}_1=\begin{pmatrix} -1 \\ 1 \\ 1 \end{pmatrix}, \quad \boldsymbol{a}_2=\begin{pmatrix} 1 \\ 1 \\ 1 \end{pmatrix} \quad \text{and} \quad \boldsymbol{a}_3=\begin{pmatrix} 1 \\ -1 \\ 1 \end{pmatrix}.\]</span></p>
</div>
</div>
<p>First, find a reflection matrix that transforms the first column of <span class="math inline">\(A\)</span> into <span class="math inline">\({(\alpha, 0, \dots, 0)}^{\mathrm{T}}\)</span> where <span class="math inline">\(\alpha=\|\boldsymbol{a}_1\|_2\)</span>. Let <span class="math inline">\(\boldsymbol{u}=\boldsymbol{a}_1-\alpha \boldsymbol{\mathrm{e}}_1\)</span> and <span class="math inline">\(\boldsymbol{v}=\frac{\boldsymbol{u}}{\| \boldsymbol{u} \|_2}\)</span>, then the first reflection matrix is <span class="math display">\[P_1=\mathcal{I}-2\boldsymbol{v} {\boldsymbol{v}}^{\mathrm{T}}.\]</span> This can be verified by checking that all the terms in the first column of the matrix <span class="math inline">\(A_2=P_1 A\)</span> are zero except for the first term.</p>
<div class="callout callout-style-default callout-caution callout-titled" title="First Reflection Matrix">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
First Reflection Matrix
</div>
</div>
<div class="callout-body-container callout-body">
<p>The 2-norm of the first column of <span class="math inline">\(A\)</span> is <span class="math inline">\(\alpha=\sqrt{3}\)</span>, then <span class="math display">\[\boldsymbol{u}=\boldsymbol{a}_1-\alpha \boldsymbol{\mathrm{e}}_1=\begin{pmatrix} -1 \\ 1 \\ 1 \end{pmatrix}-\sqrt{3}\begin{pmatrix} 1 \\ 0 \\ 0 \end{pmatrix}=\begin{pmatrix} -1-\sqrt{3} \\ 1 \\ 1 \end{pmatrix}\]</span> <span class="math display">\[\boldsymbol{v}=\frac{\boldsymbol{u}}{\| \boldsymbol{u} \|}=\frac{1}{\sqrt{6+2\sqrt{3}}}\begin{pmatrix} -1-\sqrt{3} \\ 1 \\ 1 \end{pmatrix}.\]</span> <span class="math display">\[P_1=\mathcal{I}-2\boldsymbol{v} {\boldsymbol{v}}^{\mathrm{T}}=\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix}-\frac{2}{6+2\sqrt{3}}\begin{pmatrix} -1-\sqrt{3} \\ 1 \\ 1 \end{pmatrix}\begin{pmatrix} -1-\sqrt{3} &amp; 1 &amp; 1 \end{pmatrix}\]</span> <span class="math display">\[=\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix}-\frac{1}{3+\sqrt{3}}\begin{pmatrix} 4+2\sqrt{3} &amp; -1-\sqrt{3} &amp; -1-\sqrt{3} \\ -1-\sqrt{3} &amp; 1 &amp; 1 \\ -1-\sqrt{3} &amp; 1 &amp; 1 \end{pmatrix}\]</span> <span class="math display">\[=\frac{1}{3+\sqrt{3}}\begin{pmatrix} -1-\sqrt{3} &amp; 1+\sqrt{3} &amp; 1+\sqrt{3} \\ 1+\sqrt{3} &amp; 2+\sqrt{3} &amp; -1 \\ 1+\sqrt{3} &amp; -1 &amp; 2+\sqrt{3} \end{pmatrix}\]</span></p>
<p>The matrix <span class="math inline">\(P_1\)</span> can be simplified to give <span class="math display">\[P_1=\frac{1}{6}\begin{pmatrix} -2\sqrt{3} &amp; 2\sqrt{3} &amp; 2\sqrt{3} \\ 2\sqrt{3} &amp; 3+\sqrt{3} &amp; -3+\sqrt{3} \\ 2\sqrt{3} &amp; -3+\sqrt{3} &amp; 3+\sqrt{3} \end{pmatrix}\]</span></p>
<p>To verify that this matrix is valid, consider the product <span class="math inline">\(A_2=P_1 A\)</span>: <span class="math display">\[A_2=P_1 A=\frac{1}{6}\begin{pmatrix} -2\sqrt{3} &amp; 2\sqrt{3} &amp; 2\sqrt{3} \\ 2\sqrt{3} &amp; 3+\sqrt{3} &amp; -3+\sqrt{3} \\ 2\sqrt{3} &amp; -3+\sqrt{3} &amp; 3+\sqrt{3} \end{pmatrix}=\begin{pmatrix} -1 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; -1 \\ 1 &amp; 1 &amp; 1 \end{pmatrix}\]</span> <span class="math display">\[=\frac{1}{3}\begin{pmatrix} 3\sqrt{3} &amp; \sqrt{3} &amp; -\sqrt{3} \\ 0 &amp; 2\sqrt{3} &amp; -3+\sqrt{3} \\ 0 &amp; 2\sqrt{3} &amp; 3+\sqrt{3} \end{pmatrix},\]</span> indeed, all the terms in the first column are 0 except for the first.</p>
</div>
</div>
<p>Repeat the same process for the <span class="math inline">\((N-1) \times (N-1)\)</span> bottom right submatrix of <span class="math inline">\(A_2\)</span> then once the new matrix <span class="math inline">\(P_2\)</span> is obtained (of size <span class="math inline">\((N-1)\times(N-1)\)</span>), place it at the bottom right of the <span class="math inline">\(N \times N\)</span> identity. When this process is repeated a total of <span class="math inline">\(N-1\)</span> times, the result will be an upper triangular matrix.</p>
<div class="callout callout-style-default callout-caution callout-titled" title="Second Reflection Matrix">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Second Reflection Matrix
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the matrix <span class="math display">\[A_2=\frac{1}{3}\begin{pmatrix} 3\sqrt{3} &amp; \sqrt{3} &amp; -\sqrt{3} \\ 0 &amp; 2\sqrt{3} &amp; -3+\sqrt{3} \\ 0 &amp; 2\sqrt{3} &amp; 3+\sqrt{3} \end{pmatrix}.\]</span> Let <span class="math inline">\(B\)</span> be the bottom right <span class="math inline">\(2 \times 2\)</span> submatrix of <span class="math inline">\(A_2\)</span>,</p>
<div id="fig-A2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-A2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/A2_MultCol.jpg" id="fig-A2" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-A2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
</figcaption>
</figure>
</div>
<p>Repeat the same process as before with the matrix <span class="math inline">\(B\)</span>: The 2-norm of the first column of <span class="math inline">\(B\)</span> is <span class="math inline">\(\beta=\frac{2\sqrt{6}}{3}\)</span>. Then <span class="math display">\[\boldsymbol{u}=\boldsymbol{b}_1-\beta \boldsymbol{\mathrm{e}}_1=\begin{pmatrix} \frac{2\sqrt{3}}{3} \\ \frac{2\sqrt{3}}{3} \end{pmatrix}-\frac{2\sqrt{6}}{3}\begin{pmatrix} 1 \\ 0 \end{pmatrix}=\frac{2\sqrt{3}}{3}\begin{pmatrix} 1-\sqrt{2} \\ 1 \end{pmatrix}\]</span> <span class="math display">\[\boldsymbol{v}=\frac{\boldsymbol{u}}{\| \boldsymbol{u} \|}=\frac{1}{\sqrt{4-2\sqrt{2}}}\begin{pmatrix} 1-\sqrt{2} \\ 1 \end{pmatrix}\]</span> <span class="math display">\[\tilde{P}_2=\mathcal{I}-2\boldsymbol{v}{\boldsymbol{v}}^{\mathrm{T}}=\begin{pmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{pmatrix}-\frac{2}{4-2\sqrt{2}}\begin{pmatrix} 1-\sqrt{2} \\ 1 \end{pmatrix} \begin{pmatrix} 1-\sqrt{2} &amp; 1 \end{pmatrix}\]</span> <span class="math display">\[=\begin{pmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{pmatrix}-\frac{1}{2-\sqrt{2}}\begin{pmatrix} 3-2\sqrt{2} &amp; 1-\sqrt{2} \\ 1-\sqrt{2} &amp; 1 \end{pmatrix}=\begin{pmatrix} \frac{\sqrt{2}}{2} &amp; \frac{\sqrt{2}}{2} \\ \frac{\sqrt{2}}{2} &amp; -\frac{\sqrt{2}}{2} \end{pmatrix}.\]</span></p>
<p>Consider the product <span class="math inline">\(\tilde{P}_2 B\)</span>: <span class="math display">\[\tilde{P}_2 B=\begin{pmatrix} \frac{\sqrt{2}}{2} &amp; \frac{\sqrt{2}}{2} \\ \frac{\sqrt{2}}{2} &amp; -\frac{\sqrt{2}}{2} \end{pmatrix}\begin{pmatrix} \frac{2\sqrt{3}}{3} &amp; \frac{-3+\sqrt{3}}{3} \\ \frac{2\sqrt{3}}{3} &amp; \frac{3+\sqrt{3}}{3} \end{pmatrix}=\begin{pmatrix} \frac{2\sqrt{6}}{3} &amp; \frac{\sqrt{6}}{3} \\ 0 &amp; 1 \end{pmatrix}\]</span> which does change the matrix <span class="math inline">\(B\)</span> into upper triangular form.</p>
<p>Let the matrix <span class="math inline">\(P_2\)</span> be the identity matrix with the bottom <span class="math inline">\(2 \times 2\)</span> submatrix replaced with <span class="math inline">\(\tilde{P}_2\)</span>, i.e. <span class="math display">\[P_2=\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; \frac{\sqrt{2}}{2} &amp; \frac{\sqrt{2}}{2} \\ 0 &amp; \frac{\sqrt{2}}{2} &amp; -\frac{\sqrt{2}}{2} \end{pmatrix}=\frac{1}{2}\begin{pmatrix} 2 &amp; 0 &amp; 0 \\ 0 &amp; \sqrt{2} &amp; \sqrt{2} \\ 0 &amp; \sqrt{2} &amp; -\sqrt{2} \end{pmatrix}.\]</span></p>
<p>The product <span class="math inline">\(P_2 A_2\)</span> should be lower triangular, indeed <span class="math display">\[P_2 A_2=\frac{1}{6}\begin{pmatrix} 2 &amp; 0 &amp; 0 \\ 0 &amp; \sqrt{2} &amp; \sqrt{2} \\ 0 &amp; \sqrt{2} &amp; -\sqrt{2} \end{pmatrix}\begin{pmatrix} 3\sqrt{3} &amp; \sqrt{3} &amp; -\sqrt{3} \\ 0 &amp; 2\sqrt{3} &amp; -3+\sqrt{3} \\ 0 &amp; 2\sqrt{3} &amp; 3+\sqrt{3} \end{pmatrix}=\frac{1}{6}\begin{pmatrix} 6\sqrt{3} &amp; 2\sqrt{3} &amp; -2\sqrt{3} \\ 0 &amp; 4\sqrt{6} &amp; 2\sqrt{6} \\ 0 &amp; 0 &amp; -6\sqrt{2} \end{pmatrix}.\]</span></p>
</div>
</div>
<p>This sequence of steps will generate <span class="math inline">\(N-1\)</span> reflection matrices denoted <span class="math inline">\(P_1, P_2, \dots P_{N-1}\)</span> which when applied to <span class="math inline">\(A\)</span> in reverse order (i.e.&nbsp;the product is <span class="math inline">\(P_{N-1} \dots P_2 P_1 A\)</span>), must give an upper triangular matrix <span class="math inline">\(R\)</span>. Since <span class="math inline">\(P_n\)</span> are orthogonal for all <span class="math inline">\(n=1,2,\dots,N-1\)</span>, then their product will also be orthogonal.</p>
<p>Let <span class="math inline">\(P=P_{N-1} \dots P_2 P_1\)</span>, then <span class="math inline">\(R=PA\)</span> meaning that <span class="math inline">\(A=P^{-1}R\)</span>. Since <span class="math inline">\(P\)</span> is orthogonal, then <span class="math inline">\(P^{-1}={P}^{\mathrm{T}}\)</span> which will be equal to <span class="math inline">\(Q\)</span> in the QR factorisation.</p>
<div class="callout callout-style-default callout-caution callout-titled" title="Final QR Decomposition">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Final QR Decomposition
</div>
</div>
<div class="callout-body-container callout-body">
<p>The matrices in question are <span class="math display">\[P_1=\frac{1}{6}\begin{pmatrix} -2\sqrt{3} &amp; 2\sqrt{3} &amp; 2\sqrt{3} \\ 2\sqrt{3} &amp; 3+\sqrt{3} &amp; -3+\sqrt{3} \\ 2\sqrt{3} &amp; -3+\sqrt{3} &amp; 3+\sqrt{3} \end{pmatrix}, \quad P_2=\frac{1}{2}\begin{pmatrix} 2 &amp; 0 &amp; 0 \\ 0 &amp; \sqrt{2} &amp; \sqrt{2} \\ 0 &amp; \sqrt{2} &amp; -\sqrt{2} \end{pmatrix}\]</span> The matrix product <span class="math inline">\(P_2 P_1 A\)</span> should give the matrix <span class="math inline">\(R\)</span> which is upper triangular, indeed <span class="math display">\[R=P_2 P_1 A=\frac{1}{6}\begin{pmatrix} 6\sqrt{3} &amp; 2\sqrt{3} &amp; -2\sqrt{3} \\ 0 &amp; 4\sqrt{6} &amp; 2\sqrt{6} \\ 0 &amp; 0 &amp; -6\sqrt{2} \end{pmatrix}.\]</span></p>
<p>Let <span class="math display">\[P=P_2 P_1=\frac{1}{12}\begin{pmatrix} 2 &amp; 0 &amp; 0 \\ 0 &amp; \sqrt{2} &amp; \sqrt{2} \\ 0 &amp; \sqrt{2} &amp; -\sqrt{2} \end{pmatrix}\begin{pmatrix} -2\sqrt{3} &amp; 2\sqrt{3} &amp; 2\sqrt{3} \\ 2\sqrt{3} &amp; 3+\sqrt{3} &amp; -3+\sqrt{3} \\ 2\sqrt{3} &amp; -3+\sqrt{3} &amp; 3+\sqrt{3} \end{pmatrix}\]</span> <span class="math display">\[=\begin{pmatrix} -\frac{\sqrt{3}}{3} &amp; \frac{\sqrt{3}}{3} &amp; \frac{\sqrt{3}}{3} \\ \frac{\sqrt{6}}{3} &amp; \frac{\sqrt{6}}{6} &amp; \frac{\sqrt{6}}{6} \\ 0 &amp; \frac{\sqrt{2}}{2} &amp; -\frac{\sqrt{2}}{2} \end{pmatrix}.\]</span> Therefore <span class="math display">\[Q=P^{-1}={P}^{\mathrm{T}}=\begin{pmatrix} -\frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{3} &amp; 0 \\ \frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{6} &amp; \frac{\sqrt{2}}{2} \\ \frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{6} &amp; -\frac{\sqrt{2}}{2} \end{pmatrix},\]</span> hence giving the QR decomposition of <span class="math inline">\(A\)</span> as <span class="math display">\[\underbrace{\begin{pmatrix} -1 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; -1 \\ 1 &amp; 1 &amp; 1 \end{pmatrix}}_{A}=\underbrace{\begin{pmatrix} -\frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{3} &amp; 0 \\ \frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{6} &amp; \frac{\sqrt{2}}{2} \\ \frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{6} &amp; -\frac{\sqrt{2}}{2} \end{pmatrix}}_{Q} \underbrace{\begin{pmatrix} \sqrt{3} &amp; \frac{\sqrt{3}}{3} &amp; -\frac{\sqrt{3}}{3} \\ 0 &amp; \frac{2\sqrt{6}}{3} &amp; \frac{\sqrt{6}}{3} \\ 0 &amp; 0 &amp; -\sqrt{2} \end{pmatrix}}_{R}\]</span></p>
</div>
</div>
</section>
<section id="qr-decomposition-using-rotations" class="level3" data-number="G.2.2">
<h3 data-number="G.2.2" class="anchored" data-anchor-id="qr-decomposition-using-rotations"><span class="header-section-number">G.2.2</span> QR Decomposition Using Rotations</h3>
<p>The following will explain how the QR decomposition can be performed using rotation matrices on a square matrix <span class="math inline">\(A \in \mathbb{R}^{N \times N}\)</span>.</p>
<div class="callout callout-style-default callout-caution callout-titled" title="Parallel Example">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parallel Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>This process will also be applied in parallel to the following matrix <span class="math display">\[A=\begin{pmatrix} -1 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; -1 \\ 1 &amp; 1 &amp; 1 \end{pmatrix}.\]</span></p>
</div>
</div>
<p>The rotation matrices should make all the terms in the lower triangular part of the matrix equal to zero. Starting with the lower left most element <span class="math inline">\(a_{N1}\)</span>, this element can be eliminated by using the rotation matrix <span class="math inline">\(G(1,N;\theta)\)</span> where <span class="math inline">\(\theta= \arctan \left( -\frac{a_{N1}}{a_{11}} \right)\)</span>. When applied to <span class="math inline">\(A\)</span>, this should eliminate the term <span class="math inline">\(a_{N1}\)</span>.</p>
<div class="callout callout-style-default callout-caution callout-titled" title="First Rotation Matrix">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
First Rotation Matrix
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the matrix <span class="math display">\[A=\begin{pmatrix} -1 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; -1 \\ 1 &amp; 1 &amp; 1 \end{pmatrix}.\]</span> The angle <span class="math inline">\(\theta\)</span> will be <span class="math inline">\(\theta=\arctan \left( -\frac{a_{31}}{a_{11}} \right)=\arctan \left( 1 \right)=\frac{\pi}{4}\)</span>. Therefore the rotation matrix will be <span class="math display">\[G_1=G \left( 1,3;\frac{\pi}{4} \right)=\begin{pmatrix} \cos \left( \frac{\pi}{4} \right) &amp; 0 &amp; -\sin \left( \frac{\pi}{4} \right) \\ 0 &amp; 1 &amp; 0 \\ \sin \left( \frac{\pi}{4} \right) &amp; 0 &amp; \cos \left( \frac{\pi}{4} \right) \end{pmatrix}=\begin{pmatrix} \frac{\sqrt{2}}{2} &amp; 0 &amp; -\frac{\sqrt{2}}{2} \\ 0 &amp; 1 &amp; 0 \\ \frac{\sqrt{2}}{2} &amp; 0 &amp; \frac{\sqrt{2}}{2} \end{pmatrix}.\]</span></p>
<p>This can be verified by considering the product <span class="math inline">\(A_2=G_1A\)</span>: <span class="math display">\[A_2=G_1 A=\begin{pmatrix} \frac{\sqrt{2}}{2} &amp; 0 &amp; \frac{\sqrt{2}}{2} \\ 0 &amp; 1 &amp; 0 \\ -\frac{\sqrt{2}}{2} &amp; 0 &amp; \frac{\sqrt{2}}{2} \end{pmatrix}\begin{pmatrix} -1 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; -1 \\ 1 &amp; 1 &amp; 1 \end{pmatrix}=\begin{pmatrix} -\sqrt{2} &amp; 0 &amp; 0 \\ 1 &amp; 1 &amp; -1 \\ 0 &amp; \sqrt{2} &amp; \sqrt{2} \end{pmatrix}\]</span> which does eliminate <span class="math inline">\(a_{31}\)</span>.</p>
</div>
</div>
<p>This process can be repeated for all other terms in the lower triangular section to reduce <span class="math inline">\(A\)</span> into an upper triangular matrix. In these cases, to eliminate the element in position <span class="math inline">\((m,n)\)</span>, the angle <span class="math inline">\(\theta=\arctan\left( -\frac{a_{mn}}{a_{nn}} \right)\)</span> and the rotation matrix is <span class="math inline">\(G(n,m;\theta)\)</span>.</p>
<div class="callout callout-style-default callout-caution callout-titled" title="Second &amp; Third Rotation Matrices">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Second &amp; Third Rotation Matrices
</div>
</div>
<div class="callout-body-container callout-body">
<p>Repeat the same process as above to the matrix <span class="math inline">\(A_2\)</span> to eliminate the term in position (2,1): <span class="math inline">\(\theta_2=\arctan\left( -\frac{a_{21}}{a_{11}} \right)=\arctan \left( \frac{1}{\sqrt{2}} \right)\)</span> and <span class="math inline">\(G_2=G(1,2;\theta_2)\)</span> is <span class="math display">\[G_2=G(1,2;\theta_2)=\begin{pmatrix} \cos(\theta_2) &amp; -\sin(\theta_2) &amp; 0 \\ \sin(\theta_2) &amp; \cos(\theta_2) &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix}=\begin{pmatrix} \frac{\sqrt{6}}{3} &amp; -\frac{\sqrt{3}}{3} &amp; 0 \\ \frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{3} &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix}.\]</span> Applying <span class="math inline">\(G_2\)</span> to <span class="math inline">\(A_2\)</span> should eliminate the (2,1) element, indeed <span class="math display">\[A_3=G_2 A_2=\begin{pmatrix} -\sqrt{3} &amp; -\frac{\sqrt{3}}{3} &amp; \frac{\sqrt{3}}{3} \\ 0 &amp; \frac{\sqrt{6}}{3} &amp; -\frac{\sqrt{6}}{3} \\ 0 &amp; \sqrt{2} &amp; \sqrt{2} \end{pmatrix}.\]</span></p>
<p>Finally, the term in position (2,3) needs to be eliminated: <span class="math inline">\(\theta_3=\arctan\left( -\frac{a_{32}}{a_{22}} \right)=\arctan\left( \sqrt{3} \right)\)</span> and <span class="math inline">\(G_3=G(2,3;\theta_3)\)</span> is <span class="math display">\[G_3=G(2,3;\theta_3)=\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; \cos(\theta_3) &amp; -\sin(\theta_3) \\ 0 &amp; \sin(\theta_3) &amp; \cos(\theta_3) \end{pmatrix}=\frac{1}{2}\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; \sqrt{3} \\ 0 &amp; -\sqrt{3} &amp; 1 \end{pmatrix}.\]</span></p>
<p>Applying <span class="math inline">\(G_3\)</span> to <span class="math inline">\(A_3\)</span> should eliminate the (3,2) element, indeed <span class="math display">\[G_3 A_3=\frac{1}{2}\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; \sqrt{3} \\ 0 &amp; -\sqrt{3} &amp; 1 \end{pmatrix}\begin{pmatrix} -\sqrt{3} &amp; -\frac{\sqrt{3}}{3} &amp; \frac{\sqrt{3}}{3} \\ 0 &amp; \frac{\sqrt{6}}{3} &amp; -\frac{\sqrt{6}}{3} \\ 0 &amp; \sqrt{2} &amp; \sqrt{2} \end{pmatrix}=\frac{1}{3}\begin{pmatrix} -3\sqrt{3} &amp; -\sqrt{3} &amp; \sqrt{3} \\ 0 &amp; 2\sqrt{6} &amp; \sqrt{6} \\ 0 &amp; 0 &amp; 3\sqrt{2} \end{pmatrix}.\]</span></p>
</div>
</div>
<p>This process will generate a sequence of <em>at most</em> <span class="math inline">\(\frac{1}{2}N(N-1)\)</span> rotation matrices (since this is the number of terms that need to be eliminated). Suppose that <span class="math inline">\(M\)</span> rotation matrices are needed where <span class="math inline">\(M \in \left\{ 1,2,\dots,\frac{1}{2}N(N-1) \right\}\)</span>, then when these are applied to <span class="math inline">\(A\)</span> in reverse order (the product <span class="math inline">\(G_M G_{M-1} \dots G_2 G_1 A\)</span>), then the result should be the upper triangular matrix <span class="math inline">\(R\)</span>. Let <span class="math inline">\(G=G_M G_{M-1} \dots G_2 G_1\)</span>, then <span class="math inline">\(R=GA\)</span>. Since all the rotation matrices are orthogonal, then their product must also be orthogonal, therefore if <span class="math inline">\(Q=G^{-1}={G}^{\mathrm{T}}\)</span>, then <span class="math inline">\(A=QR\)</span>, hence giving the QR decomposition of <span class="math inline">\(A\)</span>.</p>
<div class="callout callout-style-default callout-caution callout-titled" title="Final QR Decomposition">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Final QR Decomposition
</div>
</div>
<div class="callout-body-container callout-body">
<p>The matrices in question are <span class="math display">\[G_1=\begin{pmatrix} \frac{\sqrt{2}}{2} &amp; 0 &amp; \frac{\sqrt{2}}{2} \\ 0 &amp; 1 &amp; 0 \\ -\frac{\sqrt{2}}{2} &amp; 0 &amp; \frac{\sqrt{2}}{2} \end{pmatrix}, \quad G_2=\begin{pmatrix} \frac{\sqrt{6}}{3} &amp; -\frac{\sqrt{3}}{3} &amp; 0 \\ \frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{3} &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix} \quad \text{and} \quad G_3=\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{2} &amp; \frac{\sqrt{3}}{2} \\ 0 &amp; -\frac{\sqrt{3}}{2} &amp; \frac{1}{2} \end{pmatrix}.\]</span> The product of the rotation matrices is <span class="math display">\[G=G_3 G_2 G_1 = \begin{pmatrix} \frac{\sqrt{3}}{3} &amp; -\frac{\sqrt{3}}{3} &amp; -\frac{\sqrt{3}}{3} \\ \frac{\sqrt{6}}{3} &amp; \frac{\sqrt{6}}{6} &amp; \frac{\sqrt{6}}{6} \\ 0 &amp; \frac{\sqrt{2}}{2} &amp; -\frac{\sqrt{2}}{2} \end{pmatrix}.\]</span> Therefore <span class="math display">\[Q=G^{-1}={G}^{\mathrm{T}}=\begin{pmatrix} \frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{3} &amp; 0 \\ -\frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{6} &amp; \frac{\sqrt{2}}{2} \\ \frac{-\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{6} &amp; -\frac{\sqrt{2}}{2} \end{pmatrix}\]</span> hence giving the QR decomposition of <span class="math inline">\(A\)</span> as <span class="math display">\[\underbrace{\begin{pmatrix} -1 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; -1 \\ 1 &amp; 1 &amp; 1 \end{pmatrix}}_{A}=\underbrace{\begin{pmatrix} \frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{3} &amp; 0 \\ -\frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{6} &amp; \frac{\sqrt{2}}{2} \\ -\frac{\sqrt{3}}{3} &amp; \frac{\sqrt{6}}{6} &amp; -\frac{\sqrt{2}}{2} \end{pmatrix}}_{Q} \underbrace{\begin{pmatrix} -\sqrt{3} &amp; -\frac{\sqrt{3}}{3} &amp; \frac{\sqrt{3}}{3} \\ 0 &amp; \frac{2\sqrt{6}}{3} &amp; \frac{\sqrt{6}}{3} \\ 0 &amp; 0 &amp; \sqrt{2} \end{pmatrix}}_{R}.\]</span></p>
</div>
</div>
<p>Generally, the QR decomposition of a matrix is unique up to sign differences (as seen from the examples above where some of the rows and columns have different signs but in the end, the result will be the same).</p>
</section>
<section id="qr-decomposition-in-matlab" class="level3" data-number="G.2.3">
<h3 data-number="G.2.3" class="anchored" data-anchor-id="qr-decomposition-in-matlab"><span class="header-section-number">G.2.3</span> QR Decomposition in MATLAB</h3>
<p>In MATLAB, the QR decomposition can be done with the <code>qr</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb3-1"><a href="#cb3-1"></a><span class="op">&gt;&gt;</span> <span class="va">A</span><span class="op">=</span>[<span class="fl">4</span><span class="op">,</span><span class="fl">6</span><span class="op">,</span><span class="fl">1</span><span class="op">;</span><span class="fl">0</span><span class="op">,</span><span class="fl">1</span><span class="op">,-</span><span class="fl">1</span><span class="op">;</span><span class="fl">0</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="fl">2</span>]</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="va">A</span> <span class="op">=</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>     <span class="fl">4</span>   <span class="fl">6</span>   <span class="fl">1</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>     <span class="fl">0</span>   <span class="fl">1</span>  <span class="op">-</span><span class="fl">1</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>     <span class="fl">0</span>   <span class="fl">1</span>   <span class="fl">2</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="op">&gt;&gt;</span> [<span class="va">Q</span><span class="op">,</span><span class="va">R</span>]<span class="op">=</span><span class="va">qr</span>(<span class="va">A</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="va">Q</span> <span class="op">=</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>     <span class="fl">1.0000</span>         <span class="fl">0</span>         <span class="fl">0</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>          <span class="fl">0</span>   <span class="op">-</span><span class="fl">0.7071</span>   <span class="op">-</span><span class="fl">0.7071</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>          <span class="fl">0</span>   <span class="op">-</span><span class="fl">0.7071</span>    <span class="fl">0.7071</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="va">R</span> <span class="op">=</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>     <span class="fl">4.0000</span>    <span class="fl">6.0000</span>    <span class="fl">1.0000</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>          <span class="fl">0</span>   <span class="op">-</span><span class="fl">1.4142</span>   <span class="op">-</span><span class="fl">0.7071</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>          <span class="fl">0</span>         <span class="fl">0</span>    <span class="fl">2.1213</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If the matrix is rectangular, then the economy version of the QR decomposition can be found using <code>qr(A,"econ")</code>.</p>
</section>
</section>
<section id="eigenvalue-decomposition" class="level2" data-number="G.3">
<h2 data-number="G.3" class="anchored" data-anchor-id="eigenvalue-decomposition"><span class="header-section-number">G.3</span> Eigenvalue Decomposition</h2>
<p>For a matrix <span class="math inline">\(A \in \mathbb{C}^{N \times N}\)</span>, the value <span class="math inline">\(\lambda \in \mathbb{C}\)</span> and non-zero vector <span class="math inline">\(\boldsymbol{v} \in \mathbb{C}^N\)</span> are known as the <strong><em>Eigenvalue</em></strong> and <strong><em>Eigenvector</em></strong>, respectively, if they satisfy the relationship <span class="math inline">\(A\boldsymbol{v}=\lambda \boldsymbol{v}\)</span>. These can be written in eigenpair notation as <span class="math inline">\(\left\{ \lambda; \boldsymbol{v} \right\}\)</span>.</p>
<p>In MATLAB, to find the eigenvalues and eigenvectors of a matrix <code>A</code>, use <code>[V,E]=eig(A)</code>. This will produce a matrix <code>V</code> whose columns are the eigenvectors of <code>A</code> and a diagonal matrix <code>E</code> whose entries are the corresponding eigenvalues where the <span class="math inline">\((n,n)\)</span> element of <code>E</code> is the eigenvalue that corresponds to the eigenvector in column <span class="math inline">\(n\)</span> of <code>V</code>. However, if only <code>eig(A)</code> is run without specifying the outputs, MATLAB will produce a column vector of eigenvalues only.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb4-1"><a href="#cb4-1"></a><span class="op">&gt;&gt;</span> <span class="va">A</span><span class="op">=</span>[<span class="op">-</span><span class="fl">2</span><span class="op">,-</span><span class="fl">4</span><span class="op">,</span><span class="fl">2</span><span class="op">;-</span><span class="fl">2</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="fl">2</span><span class="op">;</span><span class="fl">4</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">5</span>]</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="va">A</span> <span class="op">=</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="op">-</span><span class="fl">2</span>  <span class="op">-</span><span class="fl">4</span>   <span class="fl">2</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="op">-</span><span class="fl">2</span>   <span class="fl">1</span>   <span class="fl">2</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>     <span class="fl">4</span>   <span class="fl">2</span>   <span class="fl">5</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="op">&gt;&gt;</span> <span class="va">eig</span>(<span class="va">A</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="va">ans</span> <span class="op">=</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="op">-</span><span class="fl">5</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>     <span class="fl">3</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>     <span class="fl">6</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="op">&gt;&gt;</span> [<span class="va">V</span><span class="op">,</span><span class="va">E</span>]<span class="op">=</span><span class="va">eig</span>(<span class="va">A</span>)</span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="va">v</span> <span class="op">=</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>     <span class="fl">0.8165</span>   <span class="fl">0.5345</span>   <span class="fl">0.0584</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>     <span class="fl">0.4082</span>  <span class="op">-</span><span class="fl">0.8018</span>   <span class="fl">0.3505</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>    <span class="op">-</span><span class="fl">0.4082</span>  <span class="op">-</span><span class="fl">0.2672</span>   <span class="fl">0.9347</span></span>
<span id="cb4-16"><a href="#cb4-16"></a></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="va">E</span> <span class="op">=</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>    <span class="op">-</span><span class="fl">5</span>   <span class="fl">0</span>   <span class="fl">0</span></span>
<span id="cb4-19"><a href="#cb4-19"></a>     <span class="fl">0</span>   <span class="fl">3</span>   <span class="fl">0</span></span>
<span id="cb4-20"><a href="#cb4-20"></a>     <span class="fl">0</span>   <span class="fl">0</span>   <span class="fl">6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Therefore, the matrix <span class="math inline">\(A\)</span> has the following eigenpairs <span class="math display">\[\left\{ -5 \; ; \; \begin{pmatrix} 0.8165 \\ 0.4082 \\ -0.4082 \end{pmatrix} \right\} \quad \text{,} \quad \left\{ 3 \; ; \; \begin{pmatrix} 0.5345 \\ -0.8018 \\ -0.2672 \end{pmatrix} \right\} \quad \text{,} \quad \left\{ 6 \; ; \; \begin{pmatrix} 0.0584 \\ 0.3505 \\ 0.9347 \end{pmatrix} \right\}.\]</span></p>
<p>Notice that the eigenvectors are not represented in the most pleasant form, the reason is that MATLAB normalises eigenvectors by default, meaning that the magnitude of every eigenvector is 1. In order to convert this to a more palatable form, the columns should be individually multiplied or divided by any scalar value<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. The easiest way to do this is to, first of all, divide every individual column by its minimum value, then any other manipulations can be carried out afterwards.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb5-1"><a href="#cb5-1"></a><span class="op">&gt;&gt;</span> <span class="va">v1</span><span class="op">=</span><span class="va">V</span>(<span class="op">:,</span><span class="fl">1</span>)<span class="op">/</span><span class="va">min</span>(<span class="va">V</span>(<span class="op">:,</span><span class="fl">1</span>))</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="va">ans</span> <span class="op">=</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="op">-</span><span class="fl">2</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="op">-</span><span class="fl">1</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>     <span class="fl">1</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="op">&gt;&gt;</span> <span class="va">v2</span><span class="op">=</span><span class="va">V</span>(<span class="op">:,</span><span class="fl">2</span>)<span class="op">/</span><span class="va">min</span>(<span class="va">V</span>(<span class="op">:,</span><span class="fl">2</span>))</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="va">ans</span> <span class="op">=</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>    <span class="op">-</span><span class="fl">0.6667</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>     <span class="fl">1.0000</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>     <span class="fl">0.3333</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="op">&gt;&gt;</span> <span class="va">v2</span><span class="op">=</span><span class="fl">3</span><span class="op">*</span><span class="va">v2</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="va">ans</span> <span class="op">=</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>    <span class="op">-</span><span class="fl">2</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>     <span class="fl">3</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>     <span class="fl">1</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="op">&gt;&gt;</span> <span class="va">v3</span><span class="op">=</span><span class="va">V</span>(<span class="op">:,</span><span class="fl">3</span>)<span class="op">/</span><span class="va">min</span>(<span class="va">V</span>(<span class="op">:,</span><span class="fl">3</span>))</span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="va">ans</span> <span class="op">=</span></span>
<span id="cb5-18"><a href="#cb5-18"></a>     <span class="fl">1</span></span>
<span id="cb5-19"><a href="#cb5-19"></a>     <span class="fl">6</span></span>
<span id="cb5-20"><a href="#cb5-20"></a>     <span class="fl">16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This produces a far more appealing set of eigenpairs: <span class="math display">\[\left\{ -5 \; ; \; \begin{pmatrix} -2 \\ -1 \\ 1 \end{pmatrix} \right\} \quad \text{,} \quad \left\{ 3 \; ; \; \begin{pmatrix} -2 \\ 3 \\ 1 \end{pmatrix} \right\} \quad \text{,} \quad \left\{ 6 \; ; \; \begin{pmatrix} 1 \\ 6 \\ 16 \end{pmatrix} \right\}.\]</span></p>
<section id="eigendecomposition" class="level3" data-number="G.3.1">
<h3 data-number="G.3.1" class="anchored" data-anchor-id="eigendecomposition"><span class="header-section-number">G.3.1</span> Eigendecomposition</h3>
<p>Suppose that the matrix <span class="math inline">\(A \in \mathbb{C}^{N \times N}\)</span> has <span class="math inline">\(N\)</span> linearly independent eigenvectors <span class="math inline">\(\boldsymbol{v}_1, \boldsymbol{v}_2, \dots, \boldsymbol{v}_N\)</span> with their associated eigenvalues <span class="math inline">\(\lambda_1, \lambda_2, \dots, \lambda_N\)</span>. Let <span class="math inline">\(V\)</span> be the matrix whose columns are the eigenvectors of <span class="math inline">\(A\)</span> and let <span class="math inline">\(\Lambda\)</span> be the diagonal matrix whose entries are the corresponding eigenvalues (in the same way that MATLAB produces the matrices <code>E</code> and <code>V</code>). In other words, if the matrix <span class="math inline">\(A\)</span> has the eigenpairs <span class="math display">\[\left\{ \lambda_1; \boldsymbol{v}_1 \right\}, \quad \left\{ \lambda_2; \boldsymbol{v}_2 \right\}, \quad \dots \left\{ \lambda_N; \boldsymbol{v}_N \right\},\]</span> then the matrices <span class="math inline">\(V\)</span> and <span class="math inline">\(\Lambda\)</span> are <span class="math display">\[V=\begin{pmatrix} \vdots &amp; \vdots &amp; &amp; \vdots \\ \boldsymbol{v}_1 &amp; \boldsymbol{v}_2 &amp; \dots &amp; \boldsymbol{v}_N \\ \vdots &amp; \vdots &amp;&amp; \vdots \end{pmatrix} \quad \text{and} \quad \Lambda=\begin{pmatrix} \lambda_1 \\ &amp; \lambda_2 \\ &amp;&amp; \ddots \\ &amp;&amp;&amp; \lambda_N \end{pmatrix}.\]</span> The matrix <span class="math inline">\(A\)</span> can then be written as <span class="math inline">\(A=V \Lambda V^{-1}\)</span> and this is called the <strong><em>Eigendecomposition</em></strong> of <span class="math inline">\(A\)</span>. If <span class="math inline">\(V\)</span> is an orthogonal matrix (as MATLAB produces it), then the eigendecomposition of <span class="math inline">\(A\)</span> is <span class="math inline">\(A=V \Lambda {V}^{\mathrm{T}}\)</span>.</p>
<p>This particular decomposition of matrices is useful when the matrix <span class="math inline">\(A\)</span> acts as a repeated transformation in a vector space. For example, suppose that the vector <span class="math inline">\(\boldsymbol{y}\)</span> can be found by applying the matrix transformation <span class="math inline">\(A\)</span> on the vector <span class="math inline">\(\boldsymbol{x}\)</span> 100 times, this means that <span class="math inline">\(\boldsymbol{y}=A^{100}\boldsymbol{x}\)</span>. Under usual circumstances, calculating <span class="math inline">\(A^{100}\)</span> is incredibly cumbersome but if the eigendecomposition of <span class="math inline">\(A\)</span> is used, then the problem can be reduced into taking the power of a diagonal matrix instead. Indeed, <span class="math display">\[\boldsymbol{y}=A^{100}\boldsymbol{x}\]</span> <span class="math display">\[\boldsymbol{y}=\underbrace{AA \dots A}_{\text{100 times}} \boldsymbol{x}\]</span> <span class="math display">\[\boldsymbol{y}=\underbrace{\left( V \Lambda V^{-1} \right) \left( V \Lambda V^{-1} \right) \dots \left( V \Lambda V^{-1} \right)}_{\text{100 times}} \boldsymbol{x}\]</span> <span class="math display">\[\boldsymbol{y}=V \Lambda V^{-1}V \Lambda V^{-1}V \Lambda V^{-1}\boldsymbol{x}\]</span> <span class="math display">\[\boldsymbol{y}=V \Lambda^{100} V^{-1} \boldsymbol{x}.\]</span></p>
<p>Therefore, instead of calculating <span class="math inline">\(A^{100}\)</span>, the matrix <span class="math inline">\(\Lambda^{100}\)</span> can be calculated instead which will be much easier since <span class="math inline">\(\Lambda\)</span> is a diagonal matrix (remember that the power of a diagonal matrix is just the power of its individual terms). If <span class="math inline">\(V\)</span> is orthogonal, then the calculation will be simpler since the matrix <span class="math inline">\(V\)</span> does not need to be inverted, only its transpose taken.</p>
<p>Luckily, MATLAB can perform this decomposition as seen with the <code>eig</code> command.</p>
</section>
</section>
<section id="sec-SVD" class="level2" data-number="G.4">
<h2 data-number="G.4" class="anchored" data-anchor-id="sec-SVD"><span class="header-section-number">G.4</span> Singular Value Decomposition (SVD)</h2>
<p>What happens if a square matrix <span class="math inline">\(A\)</span> does not have a full system of eigenvectors? What happens if <span class="math inline">\(A\)</span> is a rectangular matrix? In cases like this, some of the previous decompositions can fail, however there is one more way in which these issues can be resolved and it is by using the <strong><em>Singular Value Decomposition</em></strong>.</p>
<p>For <span class="math inline">\(A \in \mathbb{R}^{M \times N}\)</span>, orthogonal matrices <span class="math inline">\(U \in \mathbb{R}^{M \times M}\)</span> and <span class="math inline">\(V \in \mathbb{R}^{N \times N}\)</span> can always be found such that <span class="math inline">\(AV=U\Sigma\)</span> where <span class="math inline">\(\Sigma \in \mathbb{R}^{M \times N}\)</span> is a diagonal matrix that can be written as <span class="math inline">\(\Sigma=\mathrm{diag}(\sigma_1, \sigma_2, \dots, \sigma_p)\)</span> where <span class="math inline">\(p=\min \left\{ M,N \right\}\)</span> whose entries are positive and arranged in descending order, i.e. <span class="math display">\[\sigma_1 \geq \sigma_2 \geq \dots \geq \sigma_p \geq 0.\]</span> Since <span class="math inline">\(V\)</span> is an orthogonal matrix, then <span class="math inline">\(A\)</span> can be written as <span class="math inline">\(A = U\Sigma {V}^{\mathrm{T}}\)</span>, this form is called the <strong><em>Singular Value Decomposition</em></strong> (SVD) of <span class="math inline">\(A\)</span>. If <span class="math inline">\(M&gt;N\)</span>, this can be illustrated as follows:</p>
<p><img src="figures/SVD.jpg" class="img-fluid"></p>
<p>The scalar values <span class="math inline">\(\sigma_i\)</span> are called the <strong><em>Singular Values of <span class="math inline">\(\boldsymbol{A}\)</span></em></strong>, the columns of <span class="math inline">\(U\)</span> are called <strong><em>Left Singular Vectors</em></strong> and the columns of <span class="math inline">\(V\)</span> are called <strong><em>Right Singular Vectors</em></strong>. In a vector sense, the SVD of <span class="math inline">\(A\)</span> given by <span class="math inline">\(A=U \Sigma {V}^{\mathrm{T}}\)</span> can be written as <span class="math inline">\(A\boldsymbol{v}_i = \sigma_i\boldsymbol{u}_i\)</span> for all <span class="math inline">\(i=1,2,\dots,p\)</span> (where <span class="math inline">\(\boldsymbol{u}_i\)</span> and <span class="math inline">\(\boldsymbol{v}_i\)</span> are the columns of <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> respectively).</p>
<section id="properties-of-the-svd" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="properties-of-the-svd">Properties of the SVD</h4>
<ul>
<li>The SVD of a matrix <span class="math inline">\(A \in \mathbb{C}^{M \times N}\)</span> requires <span class="math inline">\(\mathcal{O}\left(MNp\right)\)</span> computations (where <span class="math inline">\(p=\min \left\{ M,N \right\}\)</span>).</li>
<li>The singular values are also useful when calculating the 2-norm of a matrix. Recall that for a matrix <span class="math inline">\(A \in \mathbb{C}^{M \times N}\)</span>, the 2-norm of <span class="math inline">\(A\)</span> can be written in terms of the spectral radius of <span class="math inline">\({A}^{\mathrm{H}}A\)</span> as <span class="math display">\[\|A\|_2=\sqrt{\rho({A}^{\mathrm{H}}A)}\]</span> where the spectral radius is the largest eigenvalue in absolute value. This can also be written in terms of the singular values as <span class="math display">\[\|A\|_2=\sqrt{\sigma_{max}(A)}\]</span> where <span class="math inline">\(\sigma_{max}(A)\)</span> represents the largest singular value of matrix <span class="math inline">\(A\)</span>, which (as per the the way in which the singular values have been arranged) is going to be <span class="math inline">\(\sigma_1\)</span>.</li>
<li>If <span class="math inline">\(A \in \mathbb{R}^{N \times N}\)</span>, then the eigenvalues of <span class="math inline">\(A {A}^{\mathrm{T}}\)</span> and <span class="math inline">\({A}^{\mathrm{T}}A\)</span> are equal to the squares of the singular values of <span class="math inline">\(A\)</span>, indeed, if <span class="math inline">\(A=U \Sigma {V}^{\mathrm{T}}\)</span>, then <span class="math display">\[A {A}^{\mathrm{T}}=\left( U \Sigma {V}^{\mathrm{T}} \right) {\left( U \Sigma {V}^{\mathrm{T}} \right)}^{\mathrm{T}}=U \Sigma {V}^{\mathrm{T}} V {\Sigma}^{\mathrm{T}} {U}^{\mathrm{T}}=U \Sigma^2 {U}^{\mathrm{T}}\]</span> <span class="math display">\[{A}^{\mathrm{T}}A={\left( U \Sigma {V}^{\mathrm{T}} \right)}^{\mathrm{T}} \left( U \Sigma {V}^{\mathrm{T}} \right)=V {\Sigma}^{\mathrm{T}} {U}^{\mathrm{T}} U \Sigma {V}^{\mathrm{T}}=V \Sigma^2 {V}^{\mathrm{T}}\]</span> since <span class="math inline">\(\Sigma\)</span> is a diagonal square matrix.</li>
<li>Let <span class="math inline">\(r,s \in \mathbb{N}\)</span> and <span class="math inline">\(\tau \in \mathbb{R}\)</span>, suppose that the singular values <span class="math inline">\(\sigma_1, \sigma_2, \dots, \sigma_p\)</span> of <span class="math inline">\(A\)</span> satisfy <span class="math display">\[\sigma_1 \geq \sigma_2 \geq \dots \geq \sigma_s &gt; \tau \geq \sigma_{s+1} \geq \dots \geq \sigma_r &gt; \sigma_{r+1} = \sigma_{r+2} = \dots = \sigma_p = 0.\]</span> Then <span class="math inline">\(r\)</span> is the <strong><em>Rank</em></strong> of <span class="math inline">\(A\)</span> and <span class="math inline">\(s\)</span> is the <span class="math inline">\(\boldsymbol{\tau}\)</span><strong><em>-rank</em></strong> of <span class="math inline">\(A\)</span>. In fact, if <span class="math inline">\(\tau=\varepsilon_M\)</span> (the machine precision), then <span class="math inline">\(s\)</span> is called the <strong><em>Numerical Rank</em></strong> of <span class="math inline">\(A\)</span>.</li>
<li>Specific singular vectors span specific subspaces defined in connection to <span class="math inline">\(A\)</span>. For instance, if the rank of <span class="math inline">\(A\)</span> is <span class="math inline">\(r\)</span>, then <span class="math inline">\(A\boldsymbol{v}_i=\boldsymbol{0}\)</span> for all <span class="math inline">\(i=r+1, \dots, N\)</span>. As a consequence, the vectors <span class="math inline">\(\boldsymbol{v}_{r+1}, \boldsymbol{v}_{r+2}, \dots, \boldsymbol{v}_N\)</span> span the null-space of <span class="math inline">\(A\)</span>, denoted by <span class="math display">\[\text{null}(A)=\left\{ \boldsymbol{x}\in\mathbb{R}^N : A\boldsymbol{x}=\boldsymbol{0} \right\}.\]</span></li>
<li>If <span class="math inline">\(A=U \Sigma {V}^{\mathrm{T}}\)</span>, then <span class="math inline">\(A\)</span> can be rewritten as <span class="math display">\[A=\sum_{i=1}^{r}{E_i}\]</span> where <span class="math inline">\(E_i=\sigma_i \boldsymbol{u}_i {\boldsymbol{v}_i}^{\mathrm{T}}\)</span> is a rank-1 matrix. It can be seen that <span class="math display">\[\| E_i \|=\|\sigma_i\boldsymbol{u}_i\boldsymbol{v}_i^T\|_2=\sigma_i.\]</span> Since the norm of a matrix is a measure of the “magnitude” of a matrix, it can be said that <span class="math inline">\(A\)</span> is made up of very specific elementary rank-1 matrices, in such a way that <span class="math inline">\(E_1\)</span> is the most “influential” one.</li>
</ul>
<p>The singular value decomposition of the matrix <span class="math inline">\(A \in \mathbb{R}^{M \times N}\)</span> can be done by following these steps:</p>
<div class="callout callout-style-default callout-caution callout-titled" title="Parallel Example">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parallel Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>These steps will be applied in parallel to the matrix <span class="math display">\[A=\begin{pmatrix} 3 &amp; 2 &amp; 2 \\ 2 &amp; 3 &amp; -2 \end{pmatrix}.\]</span></p>
</div>
</div>
<ol type="1">
<li>Calculate the eigenpairs of <span class="math inline">\(A{A}^{\mathrm{T}}\)</span> and <span class="math inline">\({A}^{\mathrm{T}}A\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-caution callout-titled" title="Eigenpairs">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Eigenpairs
</div>
</div>
<div class="callout-body-container callout-body">
<p>The eigenpairs of <span class="math inline">\(A {A}^{\mathrm{T}}\)</span> are <span class="math display">\[\left\{ 25 ; \begin{pmatrix} 1 \\ 1 \end{pmatrix} \right\} \quad \text{and} \quad \left\{ 9 ; \begin{pmatrix} -1 \\ 1 \end{pmatrix} \right\}.\]</span> Similarly, the eigenpairs of <span class="math inline">\({A}^{\mathrm{T}}A\)</span> are <span class="math display">\[\left\{ 25 ; \begin{pmatrix} 1 \\ 1 \\ 0 \end{pmatrix} \right\}, \quad \left\{ 9 ; \begin{pmatrix} 1 \\ -1 \\ 4 \end{pmatrix} \right\} \quad \text{and} \quad \left\{ 0 ; \begin{pmatrix}  -2 \\ 2 \\ 1 \end{pmatrix} \right\}.\]</span></p>
</div>
</div>
<ol start="2" type="1">
<li>Normalise the eigenvectors by dividing by their 2-norm (this will in fact be the default output from MATLAB’s <code>eig</code> function).</li>
</ol>
<div class="callout callout-style-default callout-caution callout-titled" title="Normalise Eigenvectors">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Normalise Eigenvectors
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <em>normalised</em> eigenpairs of <span class="math inline">\(A{A}^{\mathrm{T}}\)</span> are <span class="math display">\[\left\{ 25 ; \frac{1}{\sqrt{2}}\begin{pmatrix} 1 \\ 1 \end{pmatrix} \right\}  \quad \text{and} \quad \left\{ 9 ; \frac{1}{\sqrt{2}}\begin{pmatrix} -1 \\ 1 \end{pmatrix} \right\}.\]</span> Similarly, the <em>normalised</em> eigenpairs of <span class="math inline">\({A}^{\mathrm{T}}A\)</span> are <span class="math display">\[\left\{ 25 ; \frac{1}{\sqrt{2}}\begin{pmatrix} 1 \\ 1 \\ 0 \end{pmatrix} \right\}, \quad \left\{ 9 ; \frac{1}{\sqrt{18}}\begin{pmatrix} 1 \\ -1 \\ 4 \end{pmatrix} \right\} \quad \text{and} \quad \left\{ 0 ; \frac{1}{3}\begin{pmatrix}  -2 \\ 2 \\ 1 \end{pmatrix} \right\}.\]</span></p>
</div>
</div>
<ol start="3" type="1">
<li>The matrix of singular values <span class="math inline">\(\Sigma\)</span> must be of the same size as <span class="math inline">\(A\)</span>, i.e.&nbsp;<span class="math inline">\(\Sigma \in \mathbb{R}^{M \times N}\)</span>, where the diagonal terms are the square roots of the eigenvalues of <span class="math inline">\(A{A}^{\mathrm{T}}\)</span> and <span class="math inline">\({A}^{\mathrm{T}}A\)</span> (only the ones that are shared by the two matrix products) arranged in descending order. There will only be <span class="math inline">\(p\)</span> diagonal terms where <span class="math inline">\(p=\min \left\{ M ,N \right\}\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-caution callout-titled" title="Terms of $\Sigma$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Terms of <span class="math inline">\(\Sigma\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>The matrix <span class="math inline">\(\Sigma\)</span> must be of size <span class="math inline">\(2 \times 3\)</span>. The eigenvalues of <span class="math inline">\(A {A}^{\mathrm{T}}\)</span> and <span class="math inline">\({A}^{\mathrm{T}}A\)</span> are <span class="math inline">\(25\)</span> and <span class="math inline">\(9\)</span>. Therefore the matrix <span class="math inline">\(\Sigma\)</span> and is given by <span class="math display">\[\Sigma=\begin{pmatrix} \sqrt{25} &amp; 0 &amp; 0 \\ 0 &amp; \sqrt{9} &amp; 0 \end{pmatrix}=\begin{pmatrix} 5 &amp; 0 &amp; 0 \\ 0 &amp; 3 &amp; 0 \end{pmatrix}.\]</span></p>
</div>
</div>
<ol start="4" type="1">
<li>The matrix <span class="math inline">\(U \in \mathbb{R}^{M \times M}\)</span> will be the matrix whose columns are the normalised eigenvectors of <span class="math inline">\({A}^{\mathrm{T}}A\)</span> arranged in the same order as the values appear in <span class="math inline">\(\Sigma\)</span>. Note that if <span class="math inline">\(\boldsymbol{v}\)</span> is a normalised eigenvector, then <span class="math inline">\(-\boldsymbol{v}\)</span> will also be a normalised eigenvector, therefore this will give rise to <span class="math inline">\(2^M\)</span> possible cases for <span class="math inline">\(U\)</span> (which will be narrowed down later).</li>
</ol>
<div class="callout callout-style-default callout-caution callout-titled" title="Matrix $U$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Matrix <span class="math inline">\(U\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>The normalised eigenpairs of <span class="math inline">\({A}^{\mathrm{T}}A\)</span> are <span class="math display">\[\left\{ 25 ; \frac{1}{\sqrt{2}}\begin{pmatrix} 1 \\ 1 \end{pmatrix} \right\} \quad \text{and} \quad \left\{ 9 ; \frac{1}{\sqrt{2}}\begin{pmatrix} -1 \\ 1 \end{pmatrix} \right\}.\]</span> If <span class="math inline">\(\boldsymbol{u}_1\)</span> is the first normalised eigenvector and <span class="math inline">\(\boldsymbol{u}_2\)</span> is the second normalised eigenvector (i.e.&nbsp;<span class="math inline">\(\boldsymbol{u}_1={\left( 1 \; , \;1 \right)}^{\mathrm{T}}\)</span> and <span class="math inline">\(\boldsymbol{u}_2={\left( -1 \; , \; 1 \right)}^{\mathrm{T}}\)</span>), then the matrix <span class="math inline">\(U \in \mathbb{R}^{2 \times 2}\)</span> can take one of four possible forms <span class="math display">\[\begin{align*}
&amp;U_1=\begin{pmatrix} &amp; \\ \boldsymbol{u}_1 &amp; \boldsymbol{u}_2 \\ &amp; \end{pmatrix}=\frac{1}{\sqrt{2}}\begin{pmatrix} 1 &amp; -1 \\ 1 &amp; 1 \end{pmatrix}, &amp;&amp; U_2=\begin{pmatrix} &amp; \\ \boldsymbol{u}_1 &amp; -\boldsymbol{u}_2 \\ &amp; \end{pmatrix}=\frac{1}{\sqrt{2}}\begin{pmatrix} 1 &amp; 1 \\ 1 &amp; -1 \end{pmatrix} \\
&amp;U_3=\begin{pmatrix} &amp; \\ -\boldsymbol{u}_1 &amp; \boldsymbol{u}_2 \\ &amp; \end{pmatrix}=\frac{1}{\sqrt{2}}\begin{pmatrix} -1 &amp; -1 \\ -1 &amp; 1 \end{pmatrix}, &amp;&amp; U_4=\begin{pmatrix} &amp; \\ -\boldsymbol{u}_1 &amp; -\boldsymbol{u}_2 \\ &amp; \end{pmatrix}=\frac{1}{\sqrt{2}}\begin{pmatrix} -1 &amp; 1 \\ -1 &amp; -1 \end{pmatrix}.
\end{align*}\]</span></p>
</div>
</div>
<ol start="5" type="1">
<li>The matrix <span class="math inline">\(V \in \mathbb{R}^{N \times N}\)</span> will be the matrix whose columns are the normalised eigenvectors of <span class="math inline">\(A{A}^{\mathrm{T}}\)</span> arranged in the same order as the values appear in <span class="math inline">\(\Sigma\)</span>. Just as before, there will technically be <span class="math inline">\(2^N\)</span> choices of <span class="math inline">\(V\)</span>. In this case, one choice of <span class="math inline">\(U\)</span> or <span class="math inline">\(V\)</span> should be fixed.</li>
</ol>
<div class="callout callout-style-default callout-caution callout-titled" title="Matrix $V$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Matrix <span class="math inline">\(V\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>The normalised eigenpairs of <span class="math inline">\({A}^{\mathrm{T}}A\)</span> are <span class="math display">\[\left\{ 25 ; \frac{1}{\sqrt{2}}\begin{pmatrix} 1 \\ 1 \\ 0 \end{pmatrix} \right\}, \quad \left\{ 9 ; \frac{1}{\sqrt{18}}\begin{pmatrix} 1 \\ -1 \\ 4 \end{pmatrix} \right\} \quad \text{and} \quad \left\{ 0 ; \frac{1}{3}\begin{pmatrix}  -2 \\ 2 \\ 1 \end{pmatrix} \right\}.\]</span> Since <span class="math inline">\(V\)</span> has a larger size than <span class="math inline">\(U\)</span>, fix <span class="math inline">\(V\)</span> as the matrix whose columns are the normalised eigenvectors of <span class="math inline">\(A {A}^{\mathrm{T}}\)</span> with no sign changes. This can be accommodated for later on by picking an appropriate choice for <span class="math inline">\(U\)</span>. Then <span class="math display">\[V=\begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{18}} &amp; -\frac{2}{3} \\ \frac{1}{\sqrt{2}} &amp; -\frac{1}{\sqrt{18}} &amp; \frac{2}{3} \\ 0 &amp; \frac{4}{\sqrt{18}} &amp; \frac{1}{3} \end{pmatrix}.\]</span></p>
</div>
</div>
<ol start="6" type="1">
<li>The correct choice for the matrix <span class="math inline">\(U\)</span> can be found in one of two ways:</li>
</ol>
<ul>
<li><strong>Trial &amp; Error</strong>: Perform the multiplication <span class="math inline">\(U \Sigma {V}^{\mathrm{T}}\)</span> for the different choices of <span class="math inline">\(U\)</span> until the correct one is found that gives <span class="math inline">\(A\)</span>. Alternatively, <span class="math inline">\(U\)</span> can be fixed and the different choices for <span class="math inline">\(V\)</span> can be investigated.</li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled" title="Trial &amp; Error">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Trial &amp; Error
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the product <span class="math inline">\(U \Sigma {V}^{\mathrm{T}}\)</span> for the different choices of <span class="math inline">\(U\)</span> and see which one gives the matrix <span class="math inline">\(A\)</span>: <span class="math display">\[\begin{align*}
&amp; U_1 \Sigma {V}^{\mathrm{T}}=\begin{pmatrix} 2 &amp; 3 &amp; -2 \\ 3 &amp; 2 &amp; 2 \end{pmatrix} \neq A \\
&amp; U_2 \Sigma {V}^{\mathrm{T}}=\begin{pmatrix} 3 &amp; 2 &amp; 2 \\ 2 &amp; 3 &amp; -2 \end{pmatrix} = A \\
&amp; U_3 \Sigma {V}^{\mathrm{T}}=\begin{pmatrix} -3 &amp; -2 &amp; -2 \\ -2 &amp; -3 &amp; 2 \end{pmatrix} \neq A \\
&amp; U_4 \Sigma {V}^{\mathrm{T}}=\begin{pmatrix} -2 &amp; -3 &amp; 2 \\ -3 &amp; -2 &amp; -2 \end{pmatrix} \neq A
\end{align*}\]</span> Therefore the correct choice for <span class="math inline">\(U\)</span> is <span class="math inline">\(U_2\)</span>.</p>
</div>
</div>
<ul>
<li><strong>Pseudo-Inversion</strong>: First, consider the expression <span class="math inline">\(A=U \Sigma {V}^{\mathrm{T}}\)</span>, multiplying both sides by <span class="math inline">\(V\)</span> on the right gives <span class="math inline">\(A V=U \Sigma\)</span> (since <span class="math inline">\(V\)</span> is orthogonal meaning that <span class="math inline">\({V}^{\mathrm{T}}V=\mathcal{I}\)</span>). Since <span class="math inline">\(\Sigma\)</span> is rectangular in general, it does not have an inverse but it does have a <strong><em>Pseudo-Inverse</em></strong><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Since <span class="math inline">\(\Sigma\)</span> is a diagonal matrix, then the pseudo-inverse will also be a diagonal matrix with the diagonal entries being the reciprocals of the singular values. For example, if <span class="math display">\[\Sigma=\begin{pmatrix} \sigma_1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; \sigma_2 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; \sigma_3 &amp; 0 \end{pmatrix},\]</span> then the pseudo-inverse of <span class="math inline">\(\Sigma\)</span> is <span class="math display">\[\Sigma^+=\begin{pmatrix} \frac{1}{\sigma_1} &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{\sigma_2} &amp; 0 \\ 0 &amp; 0 &amp; \frac{1}{\sigma_3} \\ 0 &amp; 0 &amp; 0 \end{pmatrix}.\]</span> Similarly if <span class="math display">\[\Sigma=\begin{pmatrix} \sigma_1 &amp; 0 &amp; 0 \\ 0 &amp; \sigma_2 &amp; 0 \\ 0 &amp; 0 &amp; \sigma_3 \\ 0 &amp; 0 &amp; 0 \end{pmatrix},\]</span> then the pseudo-inverse of <span class="math inline">\(\Sigma\)</span> is <span class="math display">\[\Sigma^-=\begin{pmatrix} \frac{1}{\sigma_1} &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{\sigma_2} &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; \frac{1}{\sigma_3} &amp; 0 \end{pmatrix}.\]</span> Therefore multiplying both sides of <span class="math inline">\(A V=U \Sigma\)</span> by <span class="math inline">\(\Sigma^+\)</span> on the right will give the desired expression for <span class="math inline">\(U\)</span> which is <span class="math inline">\(U=AV\Sigma^+\)</span>.</li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled" title="Pseudo-Inverse">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pseudo-Inverse
</div>
</div>
<div class="callout-body-container callout-body">
<p>The pseudo-inverse of <span class="math inline">\(\Sigma \in \mathbb{R}^{2 \times 3}\)</span> is <span class="math inline">\(\Sigma^+ \in \mathbb{R}^{3 \times 2}\)</span> where its diagonal terms are the reciprocals of those in <span class="math inline">\(\Sigma\)</span>, i.e. <span class="math display">\[\Sigma=\begin{pmatrix} 5 &amp; 0 &amp; 0 \\ 0 &amp; 3 &amp; 0 \end{pmatrix} \quad \implies \quad\Sigma^+=\begin{pmatrix} \frac{1}{5} &amp; 0 \\ 0 &amp; \frac{1}{3} \\ 0 &amp; 0 \end{pmatrix}.\]</span> This can be verified by showing that <span class="math inline">\(\Sigma \Sigma^+ = \mathcal{I}\)</span>. To find <span class="math inline">\(U\)</span>, calculate <span class="math display">\[U=AV\Sigma^+=\begin{pmatrix} 3 &amp; 2 &amp; 2 \\ 2 &amp; 3 &amp; -2 \end{pmatrix} \begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{18}} &amp; -\frac{2}{3} \\ \frac{1}{\sqrt{2}} &amp; -\frac{1}{\sqrt{18}} &amp; \frac{2}{3} \\ 0 &amp; \frac{4}{\sqrt{18}} &amp; \frac{1}{3} \end{pmatrix} \begin{pmatrix} \frac{1}{5} &amp; 0 \\ 0 &amp; \frac{1}{3} \\ 0 &amp; 0 \end{pmatrix}=\frac{1}{\sqrt{2}}\begin{pmatrix} 1 &amp; 1 \\ 1 &amp; -1 \end{pmatrix}.\]</span></p>
</div>
</div>
<ol start="7" type="1">
<li>This finally gives all the matrices required for the SVD of <span class="math inline">\(A\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-caution callout-titled" title="SVD of $A$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
SVD of <span class="math inline">\(A\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\underbrace{\begin{pmatrix} 3 &amp; 2 &amp; 2 \\ 2 &amp; 3 &amp; -2 \end{pmatrix}}_A=\underbrace{\begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} &amp; -\frac{1}{\sqrt{2}} \end{pmatrix}}_{U} \underbrace{\begin{pmatrix} 5 &amp; 0 &amp; 0 \\ 0 &amp; 3 &amp; 0 \end{pmatrix}}_{\Sigma} \underbrace{\begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} &amp; 0 \\ \frac{1}{\sqrt{18}} &amp; -\frac{1}{\sqrt{18}} &amp; \frac{4}{\sqrt{18}} \\ -\frac{2}{3} &amp; \frac{2}{3} &amp; \frac{1}{3} \end{pmatrix}}_{{V}^{\mathrm{T}}}.\]</span></p>
</div>
</div>
<p>Note that if the SVD of a matrix <span class="math inline">\(A\)</span> is known, it can also be useful in finding pseudo inverse of <span class="math inline">\(A\)</span>: <span class="math display">\[\begin{align*}
&amp; A=U \Sigma {V}^{\mathrm{T}} \\
\quad \underset{\times V}{\Rightarrow} \quad &amp; A V = U \Sigma {V}^{\mathrm{T}} V \\
\quad \underset{V^{-1}={V}^{\mathrm{T}}}{\Rightarrow} \quad &amp; A V = U \Sigma \\
\quad \underset{ \times \Sigma^+}{\Rightarrow} \quad &amp; A V \Sigma^+ = U \Sigma \Sigma^+ \\
\quad \underset{ \Sigma \Sigma^+=\mathcal{I}}{\Rightarrow} \quad &amp; A V \Sigma^+ = U \\
\quad \underset{ \times {U}^{\mathrm{T}}}{\Rightarrow} \quad &amp; A V \Sigma^+ {U}^{\mathrm{T}} = {U}^{\mathrm{T}} \\
\quad \underset{ U {U}^{\mathrm{T}} = \mathcal{I}}{\Rightarrow} \quad &amp; A V \Sigma^+ {U}^{\mathrm{T}} = \mathcal{I}. \\
\end{align*}\]</span> Therefore, the matrix <span class="math inline">\(A^+=V \Sigma^+ {U}^{\mathrm{T}}\)</span> is the pseudo-inverse of <span class="math inline">\(A\)</span>.</p>
<div class="callout callout-style-default callout-caution callout-titled" title="Pseudo-Inverse of $A$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pseudo-Inverse of <span class="math inline">\(A\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find the pseudo-inverse of <span class="math inline">\(A\)</span> where <span class="math display">\[A=\begin{pmatrix} 3 &amp; 2 &amp; 2 \\ 2 &amp; 3 &amp; -2 \end{pmatrix}.\]</span> The SVD of <span class="math inline">\(A\)</span> is <span class="math display">\[A=\underbrace{\begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} &amp; -\frac{1}{\sqrt{2}} \end{pmatrix}}_{U} \underbrace{\begin{pmatrix} 5 &amp; 0 &amp; 0 \\ 0 &amp; 3 &amp; 0 \end{pmatrix}}_{\Sigma} \underbrace{\begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} &amp; 0 \\ \frac{1}{\sqrt{18}} &amp; -\frac{1}{\sqrt{18}} &amp; \frac{4}{\sqrt{18}} \\ -\frac{2}{3} &amp; \frac{2}{3} &amp; \frac{1}{3} \end{pmatrix}}_{{V}^{\mathrm{T}}}.\]</span></p>
<p>The pseudo-inverse of <span class="math inline">\(A\)</span> is <span class="math display">\[A^+= V \Sigma^+ {U}^{\mathrm{T}} = \begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{18}} &amp; -\frac{2}{3} \\ \frac{1}{\sqrt{2}} &amp; -\frac{1}{\sqrt{18}} &amp; \frac{2}{3} \\ 0 &amp; \frac{4}{\sqrt{18}} &amp; \frac{1}{3} \end{pmatrix} \begin{pmatrix} \frac{1}{5} &amp; 0 \\ 0 &amp; \frac{1}{3} \\ 0 &amp; 0 \end{pmatrix} \begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} &amp; -\frac{1}{\sqrt{2}} \end{pmatrix}=\frac{1}{45} \begin{pmatrix} 7 &amp; 2 \\ 2 &amp; 7 \\ 10 &amp; -10 \end{pmatrix}.\]</span></p>
</div>
</div>
</section>
<section id="svd-in-matlab" class="level4" data-number="G.4.0.1">
<h4 data-number="G.4.0.1" class="anchored" data-anchor-id="svd-in-matlab"><span class="header-section-number">G.4.0.1</span> SVD in MATLAB</h4>
<p>In MATLAB, the SVD of a matrix can be found with the <code>SVD</code> command.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb6-1"><a href="#cb6-1"></a><span class="op">&gt;&gt;</span> <span class="va">A</span><span class="op">=</span>[<span class="fl">3</span><span class="op">,</span> <span class="fl">2</span><span class="op">,</span> <span class="fl">2</span><span class="op">;</span> <span class="fl">2</span><span class="op">,</span> <span class="fl">3</span><span class="op">,</span> <span class="op">-</span><span class="fl">2</span>]</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="va">A</span> <span class="op">=</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>     <span class="fl">3</span>   <span class="fl">2</span>   <span class="fl">2</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>     <span class="fl">2</span>   <span class="fl">3</span>  <span class="op">-</span><span class="fl">2</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="op">&gt;&gt;</span> [<span class="va">U</span><span class="op">,</span><span class="va">S</span><span class="op">,</span><span class="va">V</span>]<span class="op">=</span><span class="va">svd</span>(<span class="va">A</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="va">U</span> <span class="op">=</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>    <span class="op">-</span><span class="fl">0.7071</span>    <span class="fl">0.7071</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>    <span class="op">-</span><span class="fl">0.7071</span>   <span class="op">-</span><span class="fl">0.7071</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="va">S</span> <span class="op">=</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>     <span class="fl">5.0000</span>        <span class="fl">0</span>   <span class="fl">0</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>          <span class="fl">0</span>   <span class="fl">3.0000</span>   <span class="fl">0</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="va">V</span> <span class="op">=</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>    <span class="op">-</span><span class="fl">0.7071</span>    <span class="fl">0.2357</span>   <span class="op">-</span><span class="fl">0.6667</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>    <span class="op">-</span><span class="fl">0.7071</span>   <span class="op">-</span><span class="fl">0.2357</span>    <span class="fl">0.6667</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>    <span class="op">-</span><span class="fl">0.0000</span>    <span class="fl">0.9428</span>    <span class="fl">0.3333</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="op">&gt;&gt;</span> <span class="va">U</span><span class="op">*</span><span class="va">S</span><span class="op">*</span><span class="va">V</span><span class="op">'-</span><span class="va">A</span>    <span class="co">% Check is A=USV'</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="va">ans</span> <span class="op">=</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>     <span class="fl">1.0e-14</span> <span class="op">*</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>          <span class="fl">0</span>         <span class="fl">0</span>   <span class="op">-</span><span class="fl">0.0222</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>    <span class="op">-</span><span class="fl">0.0222</span>   <span class="op">-</span><span class="fl">0.1332</span>    <span class="fl">0.0666</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Notice that sometimes, due to round-off error, <code>U*S*V'-A</code> may not exactly be equal to the zero matrix, but it is still close enough to it.</p>


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Remember that any scalar multiple of an eigenvector is still an eigenvector.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>For a matrix <span class="math inline">\(B \in \mathbb{C}^{M \times N}\)</span> with <span class="math inline">\(M&lt;N\)</span>, then the pseudo-inverse is the matrix <span class="math inline">\(B^+ \in \mathbb{C}^{N \times M}\)</span> such that <span class="math inline">\(B B^+=\mathcal{I}\in \mathbb{R}^{M \times M}\)</span>. Similarly, if <span class="math inline">\(B \in \mathbb{C}^{M \times N}\)</span> with <span class="math inline">\(M&gt;N\)</span>, the pseudo-inverse is the matrix <span class="math inline">\(B^- \in \mathbb{C}^{N \times M}\)</span> such that <span class="math inline">\(B^- B =\mathcal{I}\in \mathbb{R}^{N \times N}\)</span>. Note that if a matrix is square and invertible, then the pseudo-inverse is the inverse.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./Z_App_GE.html" class="pagination-link" aria-label="Gaussian Elimination Method">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Gaussian Elimination Method</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>