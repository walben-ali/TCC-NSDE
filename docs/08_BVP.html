<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Numerical Solutions of Differential Equations – 8&nbsp; Boundary Value Problems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09_MVP.html" rel="next">
<link href="./Part_BVPs.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Part_BVPs.html">Solving Boundary Value Problems</a></li><li class="breadcrumb-item"><a href="./08_BVP.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Boundary Value Problems</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Numerical Solutions of Differential Equations</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.docx">
              <i class="bi bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Internal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Internal Workings of MATLAB</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_LinAlg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Algebra</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_LinAlg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Solving Linear Systems of Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_IVPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Initial Value Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_IVP_Euler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Euler Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_IVP_ModEuler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Modified Euler Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_IVP_RK4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fourth Order Runge-Kutta Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_IVP_InBuilt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">MATLAB’s In-Built Procedures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_IVP_Implicit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Implicit IVP Solvers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_BVPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Boundary Value Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_BVP.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Boundary Value Problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_MVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Mixed Value Problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_SBVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Symmetric Boundary Conditions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_PDEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Partial Differential Equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_PDE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Heat Equation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">MATLAB Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Arrays.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Arrays in MATLAB</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Loops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Loops</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Plotting in MATLAB</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_ReadWrite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Reading &amp; Writing Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_GE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Gaussian Elimination Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_MatDeco.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Matrix Decompositions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_DataFit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Data Fitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Eigen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Eigenvalue Problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Root.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Numerical Solutions of Non-Linear Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#example-of-boundary-value-problems" id="toc-example-of-boundary-value-problems" class="nav-link active" data-scroll-target="#example-of-boundary-value-problems"><span class="header-section-number">8.1</span> Example of Boundary Value Problems</a></li>
  <li><a href="#sec-FDM" id="toc-sec-FDM" class="nav-link" data-scroll-target="#sec-FDM"><span class="header-section-number">8.2</span> Finite Difference Method for Boundary Value Problems</a>
  <ul class="collapse">
  <li><a href="#discretisation-of-the-differential-equation" id="toc-discretisation-of-the-differential-equation" class="nav-link" data-scroll-target="#discretisation-of-the-differential-equation"><span class="header-section-number">8.2.1</span> Discretisation of the Differential Equation</a></li>
  </ul></li>
  <li><a href="#matlab-code" id="toc-matlab-code" class="nav-link" data-scroll-target="#matlab-code"><span class="header-section-number">8.3</span> MATLAB Code</a></li>
  <li><a href="#comparison-between-forward-backward-centred-difference-approximations" id="toc-comparison-between-forward-backward-centred-difference-approximations" class="nav-link" data-scroll-target="#comparison-between-forward-backward-centred-difference-approximations"><span class="header-section-number">8.4</span> Comparison Between Forward, Backward &amp; Centred Difference Approximations</a></li>
  <li><a href="#matlabs-in-built-procedures" id="toc-matlabs-in-built-procedures" class="nav-link" data-scroll-target="#matlabs-in-built-procedures"><span class="header-section-number">8.5</span> MATLAB’s In-Built Procedures</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Part_BVPs.html">Solving Boundary Value Problems</a></li><li class="breadcrumb-item"><a href="./08_BVP.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Boundary Value Problems</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Boundary Value Problems</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p><strong><em>Boundary Value Problems</em></strong> (BVPs) are similar in many ways to initial value problems in the sense that a set of differential equations are given that are to be solved subject to certain conditions. In initial value problems, these conditions are imposed at the starting time but in boundary value problems, they are imposed at particular locations.</p>
<p>One of the most important differences when it comes to solving BVPs versus IVPs is the existence of solutions. Solutions to initial value problems always <em>exist</em> and are <em>unique</em> (subject to certain restriction on the right hand side), this is as a consequence of the <em>Picard-Lindelöf</em> theorem. The same cannot be said for boundary value problems; the solution to BVPs could exist and be unique, exist and not be unique or not exist at all.</p>
<section id="example-of-boundary-value-problems" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="example-of-boundary-value-problems"><span class="header-section-number">8.1</span> Example of Boundary Value Problems</h2>
<p>Consider a mass <span class="math inline">\(m\)</span> hanging from a spring with spring constant <span class="math inline">\(K\)</span>. Suppose that the spring is extended (by pulling the mass) by a distance <span class="math inline">\(x\)</span> as seen below. <img src="figures/Spring.jpg" class="img-fluid"></p>
<p>Then by <em>Hooke’s Law</em>, the force pulling the mass back to its equilibrium position is given by <span class="math display">\[F=-Kx.\]</span> As the mass is released, it will accelerate upwards with an acceleration <span class="math inline">\(a\)</span> and the force responsible for this acceleration is given by <em>Newton’s Second Law of Motion</em> <span class="math display">\[F=ma.\]</span> The acceleration <span class="math inline">\(a\)</span> is the second derivative of the displacement <span class="math inline">\(x\)</span> with respect to time and since it acts in a direction opposite to the extension, then <span class="math display">\[a=-\frac{\mathrm{d}^{2} x}{\mathrm{d} t^{2}} \quad \implies \quad F=-m\frac{\mathrm{d}^{2} x}{\mathrm{d} t^{2}}\]</span> Equating the two expressions for the force from Newton’s Second Law and Hooke’s Law will give <span class="math display">\[-Kx=-m\frac{\mathrm{d}^{2} x}{\mathrm{d} t^{2}} \quad \implies \quad\frac{\mathrm{d}^{2} x}{\mathrm{d} t^{2}}+\omega^2x=0 \quad \text{where} \quad \omega=\sqrt{\frac{K}{m}}.\]</span> This differential equation represents the simple harmonic motion of a mass hanging on a frictionless massless spring which oscillates with a frequency <span class="math inline">\(\omega\)</span>. Since this is a second order differential equation, two conditions need to be imposed:</p>
<ul>
<li><em>Initial conditions</em> can be imposed at the starting time, specifically <span class="math inline">\(x(0)\)</span> and <span class="math inline">\(x'(0)\)</span> which prescribe the initial position and initial speed,</li>
<li><em>Boundary conditions</em> can be imposed at different times, say <span class="math inline">\(x(0)\)</span> and <span class="math inline">\(x(10)\)</span> which prescribe the location at time <span class="math inline">\(t=0\)</span> and time <span class="math inline">\(t=10\)</span>.</li>
</ul>
<!---
### Heat Flux in a Pipe

Consider the heat flow through a cylindrical pipe of across sectional area $A$ in the $x$ direction and let $q$ denote the heat flux in that direction.  It will be assumed that the temperature flux varies only along the length of the pipe.

![](figures/Tube.jpg)

For a small cross section of the cylinder between $x$ and $\delta x$, the heat flux in this region would be
$$(q(x+\delta x)-q(x))A.$$
Within this particular scenario, the pipe could be influenced by the external environment, say by heating or cooling at the ends of the pipe, this means that the heat transfer will have a dependence on $x$ only.  Denote this heat "source" per unit volume function as $f(x)$ (this could also be a heat "sink" per unit volume or a combination thereof).  Therefore within the small cylindrical region between $x$ and $x+\delta x$, the temperature flux should be the product of the source function $f(x)$ and the volume of this small region which is $A\delta x$.

Now there are two expressions for the heat flux between $x$ and $x+\delta x$ and they should balance one another and therefore (by the conservation of energy)
$$(q(x+\delta x)-q(x))A \approx f(x) A \delta x.$$
The expressions are not exactly equal since $\delta x$ is quite small but non-zero and therefore, this can account for the discrepancy that could arise.  Diving both sides by $A \delta x$ gives
$$\frac{q(x+\delta x)-q(x)}{\delta x} \approx f(x).$$
As $\delta x$ becomes tends to $0$, the approximation will become an equality
$$\lim_{\delta x \rightarrow 0}\frac{q(x+\delta x)-q(x)}{\delta x} = f(x).$$
The left hand side of this equation is the $x$ derivative of the heat flux function $q(x)$, therefore
$$\odiff{q}{x} = f(x).$$

In most cases, heat flux can occur due to a combination of two factors, *Conduction* and *Convection*.  For conduction, the heat flux will be
$$q_{cond}=-k_f \odiff{T}{x}$$
where $T$ is the temperature (which depends on the $x$ direction) and $k_f$ is the conductivity constant.  On the other hand, the heat flux for convection is
$$q_{conv}=\rho v C_p (T-T_{ref})$$
where $\rho$ is the density, $v$ is the steady state velocity of the flow, $C_p$ is the specific heat capacity and $T_{ref}$ is the reference temperature.  The overall heat flux will be assumed to be a combination of both conduction and convection, therefore
$$q(x)=q_{cond}(x)+q_{conv}(x).$$
All the parameters of this system can be assumed to be constant, apart from the temperature $T$ of course.  Replacing $q(x)$ into the differential equation $q'=f(x)$ gives a second order differential equation for the temperature $T$ as
$$-k_f \Odiff{T}{x}{2}+\rho v C_p \odiff{T}{x}=f(x).$$
Seeing as that this is a second order differential equation, it would need two conditions in order to yield a valid solution.  These can be boundary conditions at the inflow and outflow, which are labelled as $x=0$ and $x=L$ respectively.  In in the end, the boundary value problem would be posed thus
$$-k_f \Odiff{T}{x}{2}+\rho v C_p \odiff{T}{x}=f(x) \qtq{with} T(0)=T_0 \quad \text{and} \quad T(L)=T_L.$$
--->
<p>Consider the differential equation for the undamped simple harmonic oscillator with frequency 1, namely <span class="math display">\[\frac{\mathrm{d}^{2} u}{\mathrm{d} t^{2}}=-u.\]</span> This differential equation has the general analytic solution <span class="math display">\[u(t)=C_1 \cos(t)+C_2 \sin(t)\]</span> where <span class="math inline">\(C_1\)</span> and <span class="math inline">\(C_2\)</span> are constants of integration which will be determined form the boundary conditions.</p>
<p>Three qualitatively different sets of boundary conditions will be investigated:</p>
<ul>
<li><p><span class="math inline">\(u(0)=1\)</span> and <span class="math inline">\(u(\frac{5\pi}{2})=-1\)</span>: The constants <span class="math inline">\(C_1\)</span> and <span class="math inline">\(C_2\)</span> can be found as: <span class="math display">\[1=u(0)=C_1 \cos(0)+C_2 \sin(0)=C_1 \quad \implies \quad C_1=1\]</span> <span class="math display">\[-1=u\left(\frac{5\pi}{2}\right)=C_1 \cos\left(\frac{5\pi}{2}\right)+C_2 \sin\left(\frac{5\pi}{2}\right)=C_2 \quad \implies \quad C_2=-1.\]</span> Therefore the analytic solution to the boundary value problem subject to these conditions is <span class="math display">\[u(t)=\cos(t)-\sin(t)\]</span> and this is captured by the finite difference approximation. In this case, the solution to the boundary value problem <em>exists</em> and is <em>unique</em>.</p></li>
<li><p><span class="math inline">\(u(0)=0\)</span> and <span class="math inline">\(u(2\pi)=0\)</span>: The constants <span class="math inline">\(C_1\)</span> and <span class="math inline">\(C_2\)</span> can be found as: <span class="math display">\[0=u(0)=C_1 \cos(0)+C_2\sin(0)=C_1 \quad \implies \quad C_1=0\]</span> <span class="math display">\[0=u(2\pi)=C_1 \cos(2\pi)+C_2\sin(2\pi)=C_1 \quad \implies \quad C_1=0.\]</span> These two conditions provide an expressions for the constant <span class="math inline">\(C_1\)</span> only and not <span class="math inline">\(C_2\)</span>, therefore the particular solution will be <span class="math display">\[u(t)=C_2\sin(t)\]</span> which is valid for <em>any</em> value of <span class="math inline">\(C_2\)</span>. Therefore in this case, the solution <em>exists</em> but is <em>not unique</em>.</p></li>
<li><p><span class="math inline">\(u(0)=1\)</span> and <span class="math inline">\(u(2\pi)=-1\)</span>: The constants <span class="math inline">\(C_1\)</span> and <span class="math inline">\(C_2\)</span> can be found as: <span class="math display">\[1=u(0)=C_1 \cos(0)+C_2\sin(0)=C_1 \quad \implies \quad C_1=1\]</span> <span class="math display">\[-1=u(\pi)=C_1 \cos(2\pi)+C_2\sin(2\pi)=C_1 \quad \implies \quad C_1=-1.\]</span> In this case, the boundary values have resulted in a contradiction and therefore the solution <em>does not exist</em> when subject to these boundary conditions.</p></li>
</ul>
<p>This final case is when the solution to a boundary value problem does <em>not exist</em>.</p>
</section>
<section id="sec-FDM" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="sec-FDM"><span class="header-section-number">8.2</span> Finite Difference Method for Boundary Value Problems</h2>
<p>Consider the general second order boundary value problem <span class="math display">\[a(x) \frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}+b(x) \frac{\mathrm{d} u}{\mathrm{d} x}+c(x) u=f(x) \quad \text{with} \quad 0&lt; x &lt; L\]</span> <span class="math display">\[\text{and} \quad u(0)=u_l, \quad u(L)=u_r\]</span> where the functions <span class="math inline">\(a,b,c\)</span> and <span class="math inline">\(f\)</span> are known functions of <span class="math inline">\(x\)</span>. Boundary value problems like this are solved using an incredibly versatile method known as the <strong><em>Finite Difference Method</em></strong>. This procedure essentially changes a differential equation into a set of difference equations by using approximations to the derivatives.</p>
<p>The term <em>finite difference approximation</em> refers to how derivatives can be approximated using linear expressions of the function at neighbouring points. For instance, the derivative of some function <span class="math inline">\(u\)</span> at a given point <span class="math inline">\(X\)</span> can be approximated as the gradient of <span class="math inline">\(u\)</span> between two points around <span class="math inline">\(X\)</span>, for example <span class="math display">\[\frac{\mathrm{d} f}{\mathrm{d} x}(X) \approx \frac{f(X+h)-f(X-h)}{2h}.\]</span> There are many other ways in which these approximations can be made depending on the way in which the grid has been set up or on the context of the problem.</p>
<p>Consider a general unknown function <span class="math inline">\(u(x)\)</span> defined on <span class="math inline">\([0,L]\)</span> where <span class="math inline">\(u(0)\)</span> and <span class="math inline">\(u(L)\)</span> are given (as boundary conditions). First, split the interval into <span class="math inline">\(N\)</span> equally sized sections, each of width <span class="math inline">\(h\)</span>, and label the points as <span class="math inline">\(x_0, x_1, \dots, x_N\)</span> where <span class="math inline">\(x_n=nh\)</span>.</p>
<p><img src="figures/Disc_Zoom.jpg" class="img-fluid"></p>
<p>For first and second derivatives, there are three main approximations that are most widely used:</p>
<ul>
<li><strong>Forward Difference</strong>: <span class="math display">\[\frac{\mathrm{d} u}{\mathrm{d} x}(x_n) \approx \frac{u(x_{n+1})-u(x_n)}{h}\]</span> <span class="math display">\[\frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}(x_n) \approx \frac{u(x_{n+2})-2u(x_{n+1})+u(x_n)}{h^2}\]</span></li>
<li><strong>Backward Difference</strong>: <span class="math display">\[\frac{\mathrm{d} u}{\mathrm{d} x}(x_n) \approx \frac{u(x_{n})-u(x_{n-1})}{h}\]</span> <span class="math display">\[\frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}(x_n) \approx \frac{u(x_{n})-2u(x_{n-1})+u(x_{n-2})}{h^2}\]</span></li>
<li><strong>Centred Difference</strong>: <span class="math display">\[\frac{\mathrm{d} u}{\mathrm{d} x}(x_n) \approx \frac{u(x_{n+1})-u(x_{n-1})}{2h}\]</span> <span class="math display">\[\frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}(x_n) \approx \frac{u(x_{n+1})-2u(x_{n})+u(x_{n-1})}{h^2}\]</span></li>
</ul>
<p>The graphical interpretation of the approximations to the first derivatives are shown below.</p>
<p><img src="figures/FBC.jpg" class="img-fluid"></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Second Derivative Expression
</div>
</div>
<div class="callout-body-container callout-body">
<p>To show how the second derivative expressions are obtained, consider the centred difference approximation <span class="math display">\[\frac{\mathrm{d} u}{\mathrm{d} x}(x_n) \approx \frac{u(x_{n+1})-u(x_{n-1})}{2h}.\]</span></p>
<p>To derive the expression for the second derivative, introduce two fictitious points <span class="math inline">\(x_{n-0.5}\)</span> (which is half-way between <span class="math inline">\(x_{n-1}\)</span> and <span class="math inline">\(x_{n}\)</span>) and <span class="math inline">\(x_{n+0.5}\)</span> (which is half-way between <span class="math inline">\(x_{n}\)</span> and <span class="math inline">\(x_{n+1}\)</span>). Then <span class="math display">\[\begin{align*}
    \frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}(x_n)=\frac{\mathrm{d} }{\mathrm{d} x}\left( \frac{\mathrm{d} u}{\mathrm{d} x}(x_n) \right) &amp;\approx \frac{\mathrm{d} }{\mathrm{d} x} \left( \frac{u(x_{n+0.5})-u(x_{n-0.5})}{h} \right) \\ &amp; \approx \frac{u'(x_{n+0.5})-u'(x_{n-0.5})}{h} \\ &amp; \approx \frac{\frac{u(x_{n+1})-u(x_{n})}{h}-\frac{u(x_{n})-u(x_{n-1})}{h}}{h} \\ &amp; = \frac{u(x_{n+1})-2u(x_n)+u(x_{n-1})}{h^2}.
\end{align*}\]</span></p>
<p>The derivation of the second derivative approximations for the forward and backward differences can be done in a very similar way but without the need for half steps.</p>
</div>
</div>
<p>Any of these three approximations can be used to approximate the derivatives of the function <span class="math inline">\(u\)</span> at the point <span class="math inline">\(x_n\)</span>. Denote the approximation of <span class="math inline">\(u\)</span> at the point <span class="math inline">\(x_n\)</span> by <span class="math inline">\(U_n\)</span>, i.e.&nbsp;<span class="math inline">\(U_n \approx u(x_n)\)</span>, then</p>
<ul>
<li><strong>Forward Difference</strong>: <span class="math display">\[\frac{\mathrm{d} u}{\mathrm{d} x}(x_n) \approx \frac{U_{n+1}-U_n}{h} \quad ; \quad \frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}(x_n) \approx \frac{U_{n+2}-2U_{n+1}+U_n}{h^2}\]</span></li>
<li><strong>Backward Difference</strong>: <span class="math display">\[\frac{\mathrm{d} u}{\mathrm{d} x}(x_n) \approx \frac{U_{n}-U_{n-1}}{h} \quad ; \quad \frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}(x_n) \approx \frac{U_{n}-2U_{n-1}+U_{n-2}}{h^2}\]</span></li>
<li><strong>Centred Difference</strong>: <span class="math display">\[\frac{\mathrm{d} u}{\mathrm{d} x}(x_n) \approx \frac{U_{n+1}-U_{n-1}}{2h} \quad ; \quad \frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}(x_n) \approx \frac{U_{n+1}-2U_{n}+U_{n-1}}{h^2}.\]</span></li>
</ul>
<p>These approximations will form the basis for solving the BVP.</p>
<section id="discretisation-of-the-differential-equation" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="discretisation-of-the-differential-equation"><span class="header-section-number">8.2.1</span> Discretisation of the Differential Equation</h3>
<p>Returning to the differential equation <span class="math display">\[a(x) \frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}+b(x) \frac{\mathrm{d} u}{\mathrm{d} x}+c(x) u=f(x).\]</span> Evaluate this equation at <span class="math inline">\(x=x_n\)</span> for some <span class="math inline">\(n\)</span>, then <span class="math display">\[a(x_n) \frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}(x_n)+b(x_n) \frac{\mathrm{d} u}{\mathrm{d} x}(x_n)+c(x_n) u(x_n)=f(x_n).\]</span></p>
<p>For now, suppose the <em>centred differencing approximation</em> is used to approximate the derivatives. Replacing the approximations of the derivatives of <span class="math inline">\(u\)</span> at <span class="math inline">\(x_n\)</span> gives <span class="math display">\[a(x_n) \frac{U_{n+1}-2U_n+U_{n-1}}{h^2}+b(x_n)  \frac{U_{n+1}-U_{n-1}}{2h}+c(x_n) U_n=f(x_n).\]</span> This can be simplified by collecting the <span class="math inline">\(U\)</span> terms resulting in: <span class="math display">\[\alpha_n U_{n-1}+\beta_n U_n+\gamma_n U_{n+1}=f(x_n)\]</span> <span class="math display">\[\alpha_n=\frac{a(x_n)}{h^2}-\frac{b(x_n)}{2h}, \quad \beta_n=-\frac{2a(x_n)}{h^2}+c(x_n), \quad \gamma_n=\frac{a(x_n)}{h^2}+\frac{b(x_n)}{2h}.\]</span> This expression will hold for all the values of <span class="math inline">\(n=1, 2, \dots, N-1\)</span> (otherwise there will be points <span class="math inline">\(x_{-1}\)</span> and <span class="math inline">\(x_{N+1}\)</span> which are outside the domain <span class="math inline">\([0,L]\)</span>). Therefore, this mean that there will be <span class="math inline">\(N-1\)</span> equations in <span class="math inline">\(N+1\)</span> unknowns which are <span class="math inline">\(U_0, U_1, U_2, \dots, U_N\)</span>.</p>
<p>This system may seem to be undetermined however, there are two boundary conditions that have not been taken into consideration yet, namely <span class="math inline">\(u(x_0)=u_l\)</span> and <span class="math inline">\(u(x_N)=u(L)=u_r\)</span>. Since these are known, the approximations <span class="math inline">\(U_0\)</span> and <span class="math inline">\(U_N\)</span> have defined values, i.e.&nbsp;<span class="math inline">\(U_0 \approx u(x_0)=u_l\)</span> and <span class="math inline">\(U_N=u(x_N)=u_r\)</span>. This eliminates two of the unknowns giving <span class="math inline">\(N-1\)</span> equations in <span class="math inline">\(N-1\)</span> unknowns.</p>
<p>At <span class="math inline">\(n=1\)</span>, the approximation to the differential equation is <span class="math display">\[\alpha_1 U_{0}+\beta_1 U_1+\gamma_1 U_{2}=f(x_1)\]</span> and since <span class="math inline">\(U_0\)</span> is already known, then it can be taken to the right hand side to give <span class="math display">\[\beta_1 U_1+\gamma_1 U_{2}=f(x_1)-\alpha_1 u_{0}.\]</span> Similarly, at <span class="math inline">\(n=N-1\)</span>, the approximation is <span class="math display">\[\alpha_{N-1} U_{N-2}+\beta_{N-1} U_{N-1}+\gamma_{N-1} U_{N}=f(x_{N-1})\]</span> and since <span class="math inline">\(U_N\)</span> is known, this can be rewritten as <span class="math display">\[\alpha_{N-1} U_{N-2}+\beta_{N-1} U_{N-1}=f(x_{N-1})-\gamma_{N-1} u_{L}.\]</span> For <span class="math inline">\(n=2,3,\dots,N-2\)</span>, the approximation is <span class="math display">\[\alpha_n U_{n-1}+\beta_n U_n+\gamma_n U_{n+1}=f(x_n)\]</span> where <span class="math inline">\(U_{n-1}, U_n\)</span> and <span class="math inline">\(U_{n+1}\)</span> are al unknown. In summary, all of these <span class="math inline">\(N-1\)</span> equations are: <span class="math display">\[\begin{align*}
    n=1: &amp; \quad \qquad \quad \; \beta_1 U_1+\gamma_1 U_{2}=f(x_1)-\alpha_1 u_{0} \\
    n=2: &amp; \quad \alpha_2 U_{1}+\beta_2 U_2+\gamma_2 U_{3}=f(x_2) \\
    n=3: &amp; \quad \alpha_3 U_{2}+\beta_3 U_3+\gamma_3 U_{4}=f(x_3) \\
     &amp; \qquad \qquad \qquad \vdots \\
     n=N-3: &amp; \quad \alpha_{N-3} U_{N-4}+\beta_{N-3} U_{N-3}+\gamma_{N-3} U_{N-2}=f(x_{N-3})\\
     n=N-2: &amp; \quad \alpha_{N-2} U_{N-3}+\beta_{N-2} U_{N-2}+\gamma_{N-2} U_{N-1}=f(x_{N-2})\\
    n=N-1: &amp; \quad \alpha_{N-1} U_{N-2}+\beta_{N-1} U_{N-1} \quad \qquad \qquad \; \; =f(x_{N-1})+\gamma_{N-1} u_{L}
\end{align*}\]</span> These can be written in matrix form as <span class="math inline">\(A \boldsymbol{U}=\boldsymbol{g}\)</span>, namely <span class="math display">\[\begin{multline*}
\underbrace{\begin{pmatrix}
    \beta_1  &amp; \gamma_1 &amp; 0        &amp; 0 &amp; \dots  &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    \alpha_2 &amp; \beta_2  &amp; \gamma_2 &amp; 0 &amp; \dots  &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0        &amp; \alpha_3 &amp; \beta_3  &amp; \gamma_3 &amp; \dots  &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0       &amp; \alpha_4 &amp; \beta_4  &amp; \dots  &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    \vdots   &amp; \vdots   &amp; \vdots   &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
    0        &amp; 0        &amp; 0        &amp; 0 &amp; \dots  &amp; \beta_{N-4} &amp; \gamma_{N-4} &amp; 0 &amp; 0 \\
    0        &amp; 0        &amp; 0        &amp; 0 &amp; \dots  &amp; \alpha_{N-3} &amp; \beta_{N-3} &amp; \gamma_{N-3} &amp; 0 \\
    0        &amp; 0        &amp; 0        &amp; 0 &amp; \dots  &amp; 0 &amp; \alpha_{N-2} &amp; \beta_{N-2} &amp; \gamma_{N-2} \\
    0        &amp; 0        &amp; 0        &amp; 0 &amp; \dots  &amp; 0 &amp; 0 &amp; \alpha_{N-1} &amp; \beta_{N-1}
\end{pmatrix}}_{A}
\underbrace{\begin{pmatrix}
    U_1 \\ U_2 \\ U_3 \\ U_4 \\ \vdots \\ U_{N-4} \\ U_{N-3} \\ U_{N-2} \\ U_{N-1}
\end{pmatrix}}_{\boldsymbol{U}} \\=
\underbrace{\begin{pmatrix}
    f(x_1)-\alpha_1 u_l \\ f(x_2) \\ f(x_3) \\ f(x_4) \\ \vdots \\ f(x_{N-4}) \\ f(x_{N-3}) \\ f(x_{N-2}) \\ f(x_{N-1})-\gamma_{N-1}u_r
\end{pmatrix}}_{\boldsymbol{g}}.
\end{multline*}\]</span> The matrix <span class="math inline">\(A\)</span> is of size <span class="math inline">\((N-1) \times (N-1)\)</span> all of whose terms are known, the vector <span class="math inline">\(\boldsymbol{g}\)</span> of size <span class="math inline">\((N-1) \times 1\)</span> also has terms that are all known. The unknown vector here is <span class="math inline">\(\boldsymbol{U}\)</span> and it can be found by inverting <span class="math inline">\(A\)</span> to give <span class="math inline">\(\boldsymbol{U}=A^{-1}\boldsymbol{g}\)</span>.</p>
<p>Carrying out matrix inversions by hand can become increasingly cumbersome if <span class="math inline">\(A\)</span> is larger than <span class="math inline">\(2 \times 2\)</span> and therefore this process should be done computationally. This can be done using TDMA as explained in <a href="02_LinAlg.html#sec-TDMA" class="quarto-xref"><span>Section 2.2.3</span></a> or solved in MATLAB by using either <code>U=inv(A)*g</code> or <code>U=A\g</code>. The <em>backslash</em> method is faster than explicit matrix inversion if the matrix is of a large size.</p>
<p>The same process can be done for the forward and backward differencing approximations as well, the only difference will be the expressions for <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>:</p>
<ul>
<li><p>Forward Differencing: <span class="math display">\[\alpha_n=\frac{a(x_n)}{h^2}-\frac{b(x_n)}{h}+c(x_n), \quad \beta_n=-\frac{2a(x_n)}{h^2}+\frac{b(x_n)}{h}, \quad \gamma_n=\frac{a(x_n)}{h^2}.\]</span></p></li>
<li><p>Backward Differencing: <span class="math display">\[\alpha_n=\frac{a(x_n)}{h^2}, \quad \beta_n=-\frac{2a(x_n)}{h^2}-\frac{b(x_n)}{h}, \quad \gamma_n=\frac{a(x_n)}{h^2}+\frac{b(x_n)}{h}+c(x_n).\]</span></p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Steps of The Finite Difference Method
</div>
</div>
<div class="callout-body-container callout-body">
<p>In summary, these are the steps of the finite difference method:</p>
<ol type="1">
<li>Divide the interval <span class="math inline">\([0,L]\)</span> into <span class="math inline">\(N\)</span> equally sized sections, each of width <span class="math inline">\(h=\frac{L}{N}\)</span> and label the points as <span class="math inline">\(x_0, x_1, x_2, \dots, x_N\)</span> where <span class="math inline">\(x_n=nh\)</span>. <img src="figures/Disc2.jpg" class="img-fluid"></li>
<li>The values of the function <span class="math inline">\(u\)</span> are to be found at all the locations <span class="math inline">\(x_n\)</span>. Denote the approximation to the function <span class="math inline">\(u\)</span> at the point <span class="math inline">\(x_n\)</span> by <span class="math inline">\(U_n\)</span>, i.e.&nbsp;<span class="math inline">\(U_n \approx u(x_n)\)</span> for all <span class="math inline">\(n=0,1,2,\dots,N\)</span>.</li>
<li>Evaluate the differential equation at all the points <span class="math inline">\(x_n\)</span> where the derivatives are replaced by their <em>finite difference approximations</em>.</li>
<li>This will result in a set of <span class="math inline">\(N-1\)</span> linear equations in <span class="math inline">\(N+1\)</span> unknowns, namely, <span class="math inline">\(U_0, U_1, U_2, \dots, U_N\)</span>.</li>
<li>The values for <span class="math inline">\(U_0\)</span> and <span class="math inline">\(U_N\)</span> are known from the boundary conditions, since <span class="math inline">\(U_0=u(0)=u_l\)</span> and <span class="math inline">\(U_N=u(L)=u_r\)</span> and no approximation is needed since the exact values are known.</li>
<li>Write the whole system of equations in the matrix form <span class="math inline">\(A\boldsymbol{U}=\boldsymbol{g}\)</span> and solve using TDMA of MATLAB’s backlash operator.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
BVP Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the boundary value problem <span class="math display">\[\frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}=x^3, \quad x \in[0,2] \quad \text{with} \quad u(0)=0 \quad \text{and} \quad u(2)=1.\]</span> The differential equation itself can be solved analytically to give <span class="math display">\[u(x)=\frac{1}{20}x^5-\frac{3}{10}x.\]</span> This example will be used for the purposes of demonstration and comparison between the numerically obtained solution and the exact solution.</p>
<p>Suppose the interval <span class="math inline">\([0,2]\)</span> is to be divided into <span class="math inline">\(5\)</span> equally sized sections, therefore <span class="math inline">\(N=5\)</span> and <span class="math inline">\(h=\frac{L}{N}=\frac{2}{5}=0.4\)</span>. <img src="figures/Disc04.jpg" class="img-fluid"></p>
<p>The functions <span class="math inline">\(a(x), b(x), c(x)\)</span> and <span class="math inline">\(f(x)\)</span> in this interval are: <span class="math display">\[a(x)=1, \quad b(x)=0, \quad c(x)=0, \quad f(x)=x^3.\]</span></p>
<p>The matrix values are <span class="math display">\[\alpha_n=\frac{a(x_n)}{h^2}-\frac{b(x_n)}{2h}=6.25\]</span> <span class="math display">\[\beta_n=-\frac{2a(x_n)}{h^2}+c(x_n)=-12.5\]</span> <span class="math display">\[\gamma_n=\frac{a(x_n)}{h^2}+\frac{b(x_n)}{2h}=6.25.\]</span></p>
<p>These can be used to obtain expressions for the matrix <span class="math inline">\(A\)</span> and the vector <span class="math inline">\(\boldsymbol{g}\)</span> as <span class="math display">\[
    A=\begin{pmatrix}
    -12.5  &amp;  6.25  &amp;  0     &amp; 0     \\
     6.25  &amp; -12.5  &amp;  6.25  &amp; 0     \\
     0     &amp;  6.25  &amp; -12.5  &amp; 6.25  \\
     0     &amp;  0     &amp;  6.25  &amp; -12.5
    \end{pmatrix}, \quad \boldsymbol{g}=\begin{pmatrix}
    0.064 \\ 0.512 \\ 1.728 \\ 4.096
    \end{pmatrix}.
\]</span> This system can be solved using <code>U=inv(A)*g</code> or <code>U=A\g</code>. The numerical solution is compared to exact solution below. <img src="figures/BVP1.jpg" class="img-fluid"></p>
<p>The advantage of using this boundary value solver is that the computations are in no way taxing on MATLAB. The system that results is composed entirely of linear equations and this system is solvable (provided the boundary value problem does indeed have a solution which may not always be possible). MATLAB’s backslash operator is very effective in dealing with matrices, especially owing to the fact that the matrix <span class="math inline">\(A\)</span> is a tridiagonal matrix.</p>
</div>
</div>
</section>
</section>
<section id="matlab-code" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="matlab-code"><span class="header-section-number">8.3</span> MATLAB Code</h2>
<p>Below is the MATLAB code that solves the BVP <span class="math display">\[\frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}+2\frac{\mathrm{d} u}{\mathrm{d} t}+\mathrm{e}^{-x}u=\sin(x), \quad x \in[0,10] \quad \text{with} \quad u(0)=1 \quad \text{and} \quad u(10)=-1\]</span> using the centred differencing method with <span class="math inline">\(N=50\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">function</span> <span class="va">BVP_CD</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">%% Solve BVPs using centered differences</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">% The bvp is written in the form</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">% a(x) u'' + b(x) u' + c(x) u = f(x) on x in [x0,L]</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">% with the boundary conditions u(x0)=ul and u(L)=ur.</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">% After the centered difference approximation is</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">% used, the system will be written in the form AU=g.</span></span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">%% Lines to change:</span></span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">% Line 26  : x0 - Start point</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">% Line 29  : L  - End point</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">% Line 32  : N  - Number of subdivisions</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">% Line 35  : xl - Left boundary value</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">% Line 38  : xr - Right boundary value</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">% Line 119 : Expression for the function a(x)</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co">% Line 127 : Expression for the function b(x)</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co">% Line 135 : Expression for the function c(x)</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co">% Line 143 : Expression for the function f(x)</span></span>
<span id="cb1-22"><a href="#cb1-22"></a></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="co">%% Set up input values</span></span>
<span id="cb1-24"><a href="#cb1-24"></a></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="co">% Start point</span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="va">x0</span><span class="op">=</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27"></a></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="co">% End point</span></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="va">L</span><span class="op">=</span><span class="fl">10</span><span class="op">;</span></span>
<span id="cb1-30"><a href="#cb1-30"></a></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="co">% Number of subdivisions</span></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="va">N</span><span class="op">=</span><span class="fl">50</span><span class="op">;</span></span>
<span id="cb1-33"><a href="#cb1-33"></a></span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="co">% Boundary value at x=x0</span></span>
<span id="cb1-35"><a href="#cb1-35"></a><span class="va">ul</span><span class="op">=</span><span class="fl">1</span><span class="op">;</span></span>
<span id="cb1-36"><a href="#cb1-36"></a></span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="co">% Boundary value at x=L</span></span>
<span id="cb1-38"><a href="#cb1-38"></a><span class="va">ur</span><span class="op">=-</span><span class="fl">1</span><span class="op">;</span></span>
<span id="cb1-39"><a href="#cb1-39"></a></span>
<span id="cb1-40"><a href="#cb1-40"></a><span class="co">%% Set up BVP solver parameters</span></span>
<span id="cb1-41"><a href="#cb1-41"></a></span>
<span id="cb1-42"><a href="#cb1-42"></a><span class="co">% Interval width</span></span>
<span id="cb1-43"><a href="#cb1-43"></a><span class="va">h</span><span class="op">=</span>(<span class="va">L</span><span class="op">-</span><span class="va">x0</span>)<span class="op">/</span><span class="va">N</span><span class="op">;</span></span>
<span id="cb1-44"><a href="#cb1-44"></a></span>
<span id="cb1-45"><a href="#cb1-45"></a><span class="co">% X = Vector of locations</span></span>
<span id="cb1-46"><a href="#cb1-46"></a><span class="co">% (x1, x2, x3, ..., xN) (notice the start is x1 NOT x0)</span></span>
<span id="cb1-47"><a href="#cb1-47"></a><span class="va">X</span><span class="op">=</span><span class="va">x0</span><span class="op">+</span><span class="va">h</span><span class="op">:</span><span class="va">h</span><span class="op">:</span><span class="va">L</span><span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48"></a></span>
<span id="cb1-49"><a href="#cb1-49"></a><span class="co">% Evaluate the functions a(x), b(x), c(x) and f(x) at X</span></span>
<span id="cb1-50"><a href="#cb1-50"></a><span class="va">aX</span><span class="op">=</span><span class="va">a</span>(<span class="va">X</span>)<span class="op">;</span></span>
<span id="cb1-51"><a href="#cb1-51"></a><span class="va">bX</span><span class="op">=</span><span class="va">b</span>(<span class="va">X</span>)<span class="op">;</span></span>
<span id="cb1-52"><a href="#cb1-52"></a><span class="va">cX</span><span class="op">=</span><span class="va">c</span>(<span class="va">X</span>)<span class="op">;</span></span>
<span id="cb1-53"><a href="#cb1-53"></a><span class="va">fX</span><span class="op">=</span><span class="va">f</span>(<span class="va">X</span>)<span class="op">;</span></span>
<span id="cb1-54"><a href="#cb1-54"></a></span>
<span id="cb1-55"><a href="#cb1-55"></a><span class="co">% Find the expressions for alpha, beta and gamma at X</span></span>
<span id="cb1-56"><a href="#cb1-56"></a><span class="va">alpha</span><span class="op">=</span><span class="va">aX</span><span class="op">/</span>(<span class="va">h</span><span class="op">^</span><span class="fl">2</span>)<span class="op">-</span><span class="va">bX</span><span class="op">/</span>(<span class="fl">2</span><span class="op">*</span><span class="va">h</span>)<span class="op">;</span></span>
<span id="cb1-57"><a href="#cb1-57"></a><span class="va">beta</span><span class="op">=-</span><span class="fl">2</span><span class="op">*</span><span class="va">aX</span><span class="op">/</span>(<span class="va">h</span><span class="op">^</span><span class="fl">2</span>)<span class="op">+</span><span class="va">cX</span><span class="op">;</span></span>
<span id="cb1-58"><a href="#cb1-58"></a><span class="va">gamma</span><span class="op">=</span><span class="va">aX</span><span class="op">/</span>(<span class="va">h</span><span class="op">^</span><span class="fl">2</span>)<span class="op">+</span><span class="va">bX</span><span class="op">/</span>(<span class="fl">2</span><span class="op">*</span><span class="va">h</span>)<span class="op">;</span></span>
<span id="cb1-59"><a href="#cb1-59"></a></span>
<span id="cb1-60"><a href="#cb1-60"></a><span class="co">% Set up the vector g on the right hand side</span></span>
<span id="cb1-61"><a href="#cb1-61"></a><span class="va">g</span><span class="op">=</span><span class="va">zeros</span>(<span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-62"><a href="#cb1-62"></a><span class="va">g</span>(<span class="fl">1</span>)<span class="op">=</span><span class="va">fX</span>(<span class="fl">1</span>)<span class="op">-</span><span class="va">alpha</span>(<span class="fl">1</span>)<span class="op">*</span><span class="va">ul</span><span class="op">;</span></span>
<span id="cb1-63"><a href="#cb1-63"></a><span class="va">g</span>(<span class="va">N</span><span class="op">-</span><span class="fl">1</span>)<span class="op">=</span><span class="va">fX</span>(<span class="va">N</span><span class="op">-</span><span class="fl">1</span>)<span class="op">-</span><span class="va">gamma</span>(<span class="va">N</span><span class="op">-</span><span class="fl">1</span>)<span class="op">*</span><span class="va">ur</span><span class="op">;</span></span>
<span id="cb1-64"><a href="#cb1-64"></a><span class="kw">for</span> <span class="va">j</span><span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">-</span><span class="fl">2</span></span>
<span id="cb1-65"><a href="#cb1-65"></a>    <span class="va">g</span>(<span class="va">j</span>)<span class="op">=</span><span class="va">fX</span>(<span class="va">j</span>)<span class="op">;</span></span>
<span id="cb1-66"><a href="#cb1-66"></a><span class="kw">end</span></span>
<span id="cb1-67"><a href="#cb1-67"></a></span>
<span id="cb1-68"><a href="#cb1-68"></a><span class="co">% Set up the matrix A on the left hand side (LHS_A is</span></span>
<span id="cb1-69"><a href="#cb1-69"></a><span class="co">% to avoid confusion with the function a(x))</span></span>
<span id="cb1-70"><a href="#cb1-70"></a><span class="va">A</span><span class="op">=</span><span class="va">zeros</span>(<span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">,</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-71"><a href="#cb1-71"></a><span class="va">A</span>(<span class="fl">1</span><span class="op">,</span><span class="fl">1</span>)<span class="op">=</span><span class="va">beta</span>(<span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-72"><a href="#cb1-72"></a><span class="va">A</span>(<span class="fl">1</span><span class="op">,</span><span class="fl">2</span>)<span class="op">=</span><span class="va">gamma</span>(<span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-73"><a href="#cb1-73"></a><span class="va">A</span>(<span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">,</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span>)<span class="op">=</span><span class="va">beta</span>(<span class="va">N</span><span class="op">-</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-74"><a href="#cb1-74"></a><span class="va">A</span>(<span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">,</span><span class="va">N</span><span class="op">-</span><span class="fl">2</span>)<span class="op">=</span><span class="va">alpha</span>(<span class="va">N</span><span class="op">-</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-75"><a href="#cb1-75"></a><span class="kw">for</span> <span class="va">j</span><span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">-</span><span class="fl">2</span></span>
<span id="cb1-76"><a href="#cb1-76"></a>    <span class="va">A</span>(<span class="va">j</span><span class="op">,</span><span class="va">j</span><span class="op">-</span><span class="fl">1</span>)<span class="op">=</span><span class="va">alpha</span>(<span class="va">j</span>)<span class="op">;</span></span>
<span id="cb1-77"><a href="#cb1-77"></a>    <span class="va">A</span>(<span class="va">j</span><span class="op">,</span><span class="va">j</span>)<span class="op">=</span><span class="va">beta</span>(<span class="va">j</span>)<span class="op">;</span></span>
<span id="cb1-78"><a href="#cb1-78"></a>    <span class="va">A</span>(<span class="va">j</span><span class="op">,</span><span class="va">j</span><span class="op">+</span><span class="fl">1</span>)<span class="op">=</span><span class="va">gamma</span>(<span class="va">j</span>)<span class="op">;</span></span>
<span id="cb1-79"><a href="#cb1-79"></a><span class="kw">end</span></span>
<span id="cb1-80"><a href="#cb1-80"></a></span>
<span id="cb1-81"><a href="#cb1-81"></a><span class="co">% Solve for the unknown vector U (it is then readjusted</span></span>
<span id="cb1-82"><a href="#cb1-82"></a><span class="co">% from a column vector to a row vector for plotting)</span></span>
<span id="cb1-83"><a href="#cb1-83"></a><span class="va">U</span><span class="op">=</span><span class="va">A</span><span class="op">\</span><span class="va">g</span><span class="op">;</span></span>
<span id="cb1-84"><a href="#cb1-84"></a><span class="va">U</span><span class="op">=</span><span class="va">U</span><span class="op">';</span></span>
<span id="cb1-85"><a href="#cb1-85"></a></span>
<span id="cb1-86"><a href="#cb1-86"></a><span class="co">% Add the missing term x0 to the start of the vector x</span></span>
<span id="cb1-87"><a href="#cb1-87"></a><span class="va">X</span><span class="op">=</span>[<span class="va">x0</span><span class="op">,</span><span class="va">X</span>]<span class="op">;</span></span>
<span id="cb1-88"><a href="#cb1-88"></a></span>
<span id="cb1-89"><a href="#cb1-89"></a><span class="co">% Add the left and right boundary values to the vector U</span></span>
<span id="cb1-90"><a href="#cb1-90"></a><span class="va">U</span><span class="op">=</span>[<span class="va">ul</span><span class="op">,</span><span class="va">U</span><span class="op">,</span><span class="va">ur</span>]<span class="op">;</span></span>
<span id="cb1-91"><a href="#cb1-91"></a></span>
<span id="cb1-92"><a href="#cb1-92"></a><span class="co">%% Setting plot parameters</span></span>
<span id="cb1-93"><a href="#cb1-93"></a></span>
<span id="cb1-94"><a href="#cb1-94"></a><span class="co">% Clear figure</span></span>
<span id="cb1-95"><a href="#cb1-95"></a><span class="va">clf</span></span>
<span id="cb1-96"><a href="#cb1-96"></a></span>
<span id="cb1-97"><a href="#cb1-97"></a><span class="co">% Hold so more than one line can be drawn</span></span>
<span id="cb1-98"><a href="#cb1-98"></a><span class="va">hold</span> <span class="va">on</span></span>
<span id="cb1-99"><a href="#cb1-99"></a></span>
<span id="cb1-100"><a href="#cb1-100"></a><span class="co">% Turn on grid</span></span>
<span id="cb1-101"><a href="#cb1-101"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb1-102"><a href="#cb1-102"></a></span>
<span id="cb1-103"><a href="#cb1-103"></a><span class="co">% Setting font size and style</span></span>
<span id="cb1-104"><a href="#cb1-104"></a><span class="va">set</span>(<span class="va">gca</span><span class="op">,</span><span class="ss">'FontSize'</span><span class="op">,</span><span class="fl">20</span><span class="op">,</span><span class="ss">'FontName'</span><span class="op">,</span><span class="ss">'Times'</span>)</span>
<span id="cb1-105"><a href="#cb1-105"></a></span>
<span id="cb1-106"><a href="#cb1-106"></a><span class="co">% Label the axes</span></span>
<span id="cb1-107"><a href="#cb1-107"></a><span class="va">xlabel</span>(<span class="ss">'$t$'</span><span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'Latex'</span>)</span>
<span id="cb1-108"><a href="#cb1-108"></a><span class="va">ylabel</span>(<span class="ss">'$u(t)$'</span><span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'Latex'</span>)</span>
<span id="cb1-109"><a href="#cb1-109"></a></span>
<span id="cb1-110"><a href="#cb1-110"></a><span class="co">% Plot solution</span></span>
<span id="cb1-111"><a href="#cb1-111"></a><span class="va">plot</span>(<span class="va">X</span><span class="op">,</span><span class="va">U</span><span class="op">,</span><span class="ss">'-k'</span><span class="op">,</span><span class="ss">'LineWidth'</span><span class="op">,</span><span class="fl">2</span>)</span>
<span id="cb1-112"><a href="#cb1-112"></a></span>
<span id="cb1-113"><a href="#cb1-113"></a><span class="kw">end</span></span>
<span id="cb1-114"><a href="#cb1-114"></a></span>
<span id="cb1-115"><a href="#cb1-115"></a><span class="kw">function</span> [<span class="va">A</span>]<span class="op">=</span><span class="va">a</span>(<span class="va">X</span>)</span>
<span id="cb1-116"><a href="#cb1-116"></a><span class="va">A</span><span class="op">=</span><span class="va">zeros</span>(<span class="va">size</span>(<span class="va">X</span>))<span class="op">;</span></span>
<span id="cb1-117"><a href="#cb1-117"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">length</span>(<span class="va">X</span>)</span>
<span id="cb1-118"><a href="#cb1-118"></a>    <span class="va">x</span><span class="op">=</span><span class="va">X</span>(<span class="va">i</span>)<span class="op">;</span></span>
<span id="cb1-119"><a href="#cb1-119"></a>    <span class="va">A</span>(<span class="va">i</span>)<span class="op">=</span><span class="fl">1</span><span class="op">;</span></span>
<span id="cb1-120"><a href="#cb1-120"></a><span class="kw">end</span></span>
<span id="cb1-121"><a href="#cb1-121"></a><span class="kw">end</span></span>
<span id="cb1-122"><a href="#cb1-122"></a></span>
<span id="cb1-123"><a href="#cb1-123"></a><span class="kw">function</span> [<span class="va">B</span>]<span class="op">=</span><span class="va">b</span>(<span class="va">X</span>)</span>
<span id="cb1-124"><a href="#cb1-124"></a><span class="va">B</span><span class="op">=</span><span class="va">zeros</span>(<span class="va">size</span>(<span class="va">X</span>))<span class="op">;</span></span>
<span id="cb1-125"><a href="#cb1-125"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">length</span>(<span class="va">X</span>)</span>
<span id="cb1-126"><a href="#cb1-126"></a>    <span class="va">x</span><span class="op">=</span><span class="va">X</span>(<span class="va">i</span>)<span class="op">;</span></span>
<span id="cb1-127"><a href="#cb1-127"></a>    <span class="va">B</span>(<span class="va">i</span>)<span class="op">=</span><span class="fl">2</span><span class="op">;</span></span>
<span id="cb1-128"><a href="#cb1-128"></a><span class="kw">end</span></span>
<span id="cb1-129"><a href="#cb1-129"></a><span class="kw">end</span></span>
<span id="cb1-130"><a href="#cb1-130"></a></span>
<span id="cb1-131"><a href="#cb1-131"></a><span class="kw">function</span> [<span class="va">C</span>]<span class="op">=</span><span class="va">c</span>(<span class="va">X</span>)</span>
<span id="cb1-132"><a href="#cb1-132"></a><span class="va">C</span><span class="op">=</span><span class="va">zeros</span>(<span class="va">size</span>(<span class="va">X</span>))<span class="op">;</span></span>
<span id="cb1-133"><a href="#cb1-133"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">length</span>(<span class="va">X</span>)</span>
<span id="cb1-134"><a href="#cb1-134"></a>    <span class="va">x</span><span class="op">=</span><span class="va">X</span>(<span class="va">i</span>)<span class="op">;</span></span>
<span id="cb1-135"><a href="#cb1-135"></a>    <span class="va">C</span>(<span class="va">i</span>)<span class="op">=</span><span class="va">exp</span>(<span class="op">-</span><span class="va">x</span>)<span class="op">;</span></span>
<span id="cb1-136"><a href="#cb1-136"></a><span class="kw">end</span></span>
<span id="cb1-137"><a href="#cb1-137"></a><span class="kw">end</span></span>
<span id="cb1-138"><a href="#cb1-138"></a></span>
<span id="cb1-139"><a href="#cb1-139"></a><span class="kw">function</span> [<span class="va">F</span>]<span class="op">=</span><span class="va">f</span>(<span class="va">X</span>)</span>
<span id="cb1-140"><a href="#cb1-140"></a><span class="va">F</span><span class="op">=</span><span class="va">zeros</span>(<span class="va">size</span>(<span class="va">X</span>))<span class="op">;</span></span>
<span id="cb1-141"><a href="#cb1-141"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">length</span>(<span class="va">X</span>)</span>
<span id="cb1-142"><a href="#cb1-142"></a>    <span class="va">x</span><span class="op">=</span><span class="va">X</span>(<span class="va">i</span>)<span class="op">;</span></span>
<span id="cb1-143"><a href="#cb1-143"></a>    <span class="va">F</span>(<span class="va">i</span>)<span class="op">=</span><span class="va">sin</span>(<span class="va">x</span>)<span class="op">;</span></span>
<span id="cb1-144"><a href="#cb1-144"></a><span class="kw">end</span></span>
<span id="cb1-145"><a href="#cb1-145"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="comparison-between-forward-backward-centred-difference-approximations" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="comparison-between-forward-backward-centred-difference-approximations"><span class="header-section-number">8.4</span> Comparison Between Forward, Backward &amp; Centred Difference Approximations</h2>
<p>The main difference between the different differencing schemes if the order of accuracy. Indeed, the error of the forward and backward differencing methods are <span class="math inline">\(\mathcal{O}\left(h\right)\)</span> whereas the error for the centred differencing is <span class="math inline">\(\mathcal{O}\left(h^2\right)\)</span>. This means that if the stepsize <span class="math inline">\(h\)</span> was reduced by a factor of 10, then the error for the forward and backward finite difference approximations would also reduce by a factor of 10 while the centred would reduce by a factor of 100.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Comparison Between CD, FD and BD
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the BVP <span class="math display">\[\frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}=25\pi^2 \sin(5\pi x), \quad x \in[0,1] \quad \text{with} \quad u(0)=0 \quad \text{and} \quad u(1)=0.\]</span></p>
<p>This has the exact solution <span class="math display">\[u(x)=-\sin(5 \pi x).\]</span> Below are the plots for the numerical solution to this boundary value problem using the forward (red), backward (blue) and centred (green) difference approximations compared to the exact solution when <span class="math inline">\(N=10\)</span>. <img src="figures/BVP4.jpg" class="img-fluid"></p>
<p>It can be seen that even for this relatively crude interval subdivision of <span class="math inline">\(N=10\)</span>, the centred approximation has yielded a far more favourable result compared to the other two methods. The following table shows the 2-norm error between the exact solution and the approximation for different values of <span class="math inline">\(N\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Method</th>
<th style="text-align: center;"><span class="math inline">\(N=10\)</span></th>
<th style="text-align: center;"><span class="math inline">\(N=20\)</span></th>
<th style="text-align: center;"><span class="math inline">\(N=50\)</span></th>
<th style="text-align: center;"><span class="math inline">\(N=100\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Forward</td>
<td style="text-align: center;">4.1444</td>
<td style="text-align: center;">3.0875</td>
<td style="text-align: center;">1.9823</td>
<td style="text-align: center;">1.4048</td>
</tr>
<tr class="even">
<td style="text-align: center;">Backward</td>
<td style="text-align: center;">4.7243</td>
<td style="text-align: center;">3.8535</td>
<td style="text-align: center;">2.0939</td>
<td style="text-align: center;">1.4251</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Centred</td>
<td style="text-align: center;">0.5226</td>
<td style="text-align: center;">0.1677</td>
<td style="text-align: center;">0.0413</td>
<td style="text-align: center;">0.0146</td>
</tr>
</tbody>
</table>
<p>It can be seen that even when <span class="math inline">\(N=100\)</span>, the 2-norm error has still not reduced below 1 for the forward and backward difference approximations but the centred has already achieved that even at <span class="math inline">\(N=10\)</span>. This is just a demonstration to show that how a simple change in the way in which derivatives are approximated can have such a drastic effect on the final solution.</p>
</div>
</div>
</section>
<section id="matlabs-in-built-procedures" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="matlabs-in-built-procedures"><span class="header-section-number">8.5</span> MATLAB’s In-Built Procedures</h2>
<p>MATLAB has an in-built mechanism that can also solve second (or even higher order) BVPs, this is done using the <code>bvp4c</code> command.</p>
<p>Below is the MATLAB code that solves the BVP <span class="math display">\[\frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}}+2\frac{\mathrm{d} u}{\mathrm{d} t}+\mathrm{e}^{-x}u=\sin(x), \quad x \in[0,10] \quad \text{with} \quad u(0)=1 \quad \text{and} \quad u(10)=-1\]</span> using <code>bvp4c</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">function</span> <span class="va">BVP_InBuilt</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">%% Solve BVPs using bvp4c</span></span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">% The bvp is written in the form</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">% a(x) u'' + b(x) u' + c(x) u = f(x) on x in [x0,L]</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">% with the boundary conditions u(x0)=ul and u(L)=ur.</span></span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">%% Lines to change:</span></span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">% Line 24 : x0 - Start point</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">% Line 27 : L  - End point</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">% Line 30 : N  - Number of spatial points</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">% Line 33 : xl - Left boundary value</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">% Line 36 : xr - Right boundary value</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">% Line 44 : Expression for the function a(x)</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">% Line 45 : Expression for the function b(x)</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">% Line 46 : Expression for the function c(x)</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">% Line 47 : Expression for the function f(x)</span></span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co">%% Set up input values</span></span>
<span id="cb2-22"><a href="#cb2-22"></a></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="co">% Start point</span></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="va">x0</span><span class="op">=</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb2-25"><a href="#cb2-25"></a></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="co">% End point</span></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="va">L</span><span class="op">=</span><span class="fl">10</span><span class="op">;</span></span>
<span id="cb2-28"><a href="#cb2-28"></a></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="co">% Number of spatial points</span></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="va">N</span><span class="op">=</span><span class="fl">50</span><span class="op">;</span></span>
<span id="cb2-31"><a href="#cb2-31"></a></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="co">% Boundary value at x=x0</span></span>
<span id="cb2-33"><a href="#cb2-33"></a><span class="va">ul</span><span class="op">=</span><span class="fl">1</span><span class="op">;</span></span>
<span id="cb2-34"><a href="#cb2-34"></a></span>
<span id="cb2-35"><a href="#cb2-35"></a><span class="co">% Boundary value at x=L</span></span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="va">ur</span><span class="op">=-</span><span class="fl">1</span><span class="op">;</span></span>
<span id="cb2-37"><a href="#cb2-37"></a></span>
<span id="cb2-38"><a href="#cb2-38"></a><span class="co">%% Set up BVP solver parameters</span></span>
<span id="cb2-39"><a href="#cb2-39"></a></span>
<span id="cb2-40"><a href="#cb2-40"></a><span class="co">% Set up solving space</span></span>
<span id="cb2-41"><a href="#cb2-41"></a><span class="va">X</span><span class="op">=</span><span class="va">linspace</span>(<span class="va">x0</span><span class="op">,</span><span class="va">L</span><span class="op">,</span><span class="va">N</span>)<span class="op">;</span></span>
<span id="cb2-42"><a href="#cb2-42"></a></span>
<span id="cb2-43"><a href="#cb2-43"></a><span class="co">% Define the functions in the BVP</span></span>
<span id="cb2-44"><a href="#cb2-44"></a><span class="va">a</span><span class="op">=</span> <span class="op">@</span>(<span class="va">x</span>) <span class="fl">1</span><span class="op">;</span></span>
<span id="cb2-45"><a href="#cb2-45"></a><span class="va">b</span><span class="op">=</span> <span class="op">@</span>(<span class="va">x</span>) <span class="fl">2</span><span class="op">;</span></span>
<span id="cb2-46"><a href="#cb2-46"></a><span class="va">c</span><span class="op">=</span> <span class="op">@</span>(<span class="va">x</span>) <span class="va">exp</span>(<span class="op">-</span><span class="va">x</span>)<span class="op">;</span></span>
<span id="cb2-47"><a href="#cb2-47"></a><span class="va">f</span><span class="op">=</span> <span class="op">@</span>(<span class="va">x</span>) <span class="va">sin</span>(<span class="va">x</span>)<span class="op">;</span></span>
<span id="cb2-48"><a href="#cb2-48"></a></span>
<span id="cb2-49"><a href="#cb2-49"></a><span class="co">%% Set up BVP solving parameters</span></span>
<span id="cb2-50"><a href="#cb2-50"></a></span>
<span id="cb2-51"><a href="#cb2-51"></a><span class="co">% First, write the second order ODE as a set of first order</span></span>
<span id="cb2-52"><a href="#cb2-52"></a><span class="co">% ODEs:</span></span>
<span id="cb2-53"><a href="#cb2-53"></a><span class="co">% U'=V</span></span>
<span id="cb2-54"><a href="#cb2-54"></a><span class="co">% V'=(-b(x)*V-c(x)*U+f(x))/a(x)</span></span>
<span id="cb2-55"><a href="#cb2-55"></a></span>
<span id="cb2-56"><a href="#cb2-56"></a><span class="co">% Second order BVPs can have more than one solution</span></span>
<span id="cb2-57"><a href="#cb2-57"></a><span class="co">% and vector v is the initialising vector of solutions.</span></span>
<span id="cb2-58"><a href="#cb2-58"></a><span class="co">% It can be kept as a vector of zeros</span></span>
<span id="cb2-59"><a href="#cb2-59"></a><span class="va">v</span><span class="op">=</span>[<span class="fl">0</span> <span class="fl">0</span>]<span class="op">;</span></span>
<span id="cb2-60"><a href="#cb2-60"></a></span>
<span id="cb2-61"><a href="#cb2-61"></a><span class="co">% Initialise vectors for space and v</span></span>
<span id="cb2-62"><a href="#cb2-62"></a><span class="va">init</span><span class="op">=</span><span class="va">bvpinit</span>(<span class="va">X</span><span class="op">,</span><span class="va">v</span>)<span class="op">;</span></span>
<span id="cb2-63"><a href="#cb2-63"></a></span>
<span id="cb2-64"><a href="#cb2-64"></a><span class="co">% Solve the bvp subject to the boundary values and</span></span>
<span id="cb2-65"><a href="#cb2-65"></a><span class="co">% inital guesses</span></span>
<span id="cb2-66"><a href="#cb2-66"></a><span class="va">sol</span><span class="op">=</span><span class="va">bvp4c</span>(<span class="op">@</span>(<span class="va">x</span><span class="op">,</span><span class="va">u</span>) <span class="va">DUDT</span>(<span class="va">x</span><span class="op">,</span><span class="va">u</span><span class="op">,</span><span class="va">a</span><span class="op">,</span><span class="va">b</span><span class="op">,</span><span class="va">c</span><span class="op">,</span><span class="va">f</span>)<span class="op">,@</span>(<span class="va">x0</span><span class="op">,</span><span class="va">L</span>) <span class="va">BCs</span>(<span class="va">x0</span><span class="op">,</span><span class="va">L</span><span class="op">,</span><span class="va">ul</span><span class="op">,</span><span class="va">ur</span>)<span class="op">,</span><span class="va">init</span>)<span class="op">;</span></span>
<span id="cb2-67"><a href="#cb2-67"></a></span>
<span id="cb2-68"><a href="#cb2-68"></a><span class="co">% Evaluate the solution at the grid points</span></span>
<span id="cb2-69"><a href="#cb2-69"></a><span class="va">U</span><span class="op">=</span><span class="va">deval</span>(<span class="va">sol</span><span class="op">,</span><span class="va">X</span>)<span class="op">;</span></span>
<span id="cb2-70"><a href="#cb2-70"></a></span>
<span id="cb2-71"><a href="#cb2-71"></a><span class="co">% Convert U to columns for consistency</span></span>
<span id="cb2-72"><a href="#cb2-72"></a><span class="va">U</span><span class="op">=</span><span class="va">U</span><span class="op">';</span></span>
<span id="cb2-73"><a href="#cb2-73"></a></span>
<span id="cb2-74"><a href="#cb2-74"></a><span class="co">%% Setting plot parameters</span></span>
<span id="cb2-75"><a href="#cb2-75"></a></span>
<span id="cb2-76"><a href="#cb2-76"></a><span class="co">% Clear figure</span></span>
<span id="cb2-77"><a href="#cb2-77"></a><span class="va">clf</span></span>
<span id="cb2-78"><a href="#cb2-78"></a></span>
<span id="cb2-79"><a href="#cb2-79"></a><span class="co">% Hold so more than one line can be drawn</span></span>
<span id="cb2-80"><a href="#cb2-80"></a><span class="va">hold</span> <span class="va">on</span></span>
<span id="cb2-81"><a href="#cb2-81"></a></span>
<span id="cb2-82"><a href="#cb2-82"></a><span class="co">% Turn on grid</span></span>
<span id="cb2-83"><a href="#cb2-83"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb2-84"><a href="#cb2-84"></a></span>
<span id="cb2-85"><a href="#cb2-85"></a><span class="co">% Setting font size and style</span></span>
<span id="cb2-86"><a href="#cb2-86"></a><span class="va">set</span>(<span class="va">gca</span><span class="op">,</span><span class="ss">'FontSize'</span><span class="op">,</span><span class="fl">20</span><span class="op">,</span><span class="ss">'FontName'</span><span class="op">,</span><span class="ss">'Times'</span>)</span>
<span id="cb2-87"><a href="#cb2-87"></a></span>
<span id="cb2-88"><a href="#cb2-88"></a><span class="co">% Label the axes</span></span>
<span id="cb2-89"><a href="#cb2-89"></a><span class="va">xlabel</span>(<span class="ss">'$t$'</span><span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'Latex'</span>)</span>
<span id="cb2-90"><a href="#cb2-90"></a><span class="va">ylabel</span>(<span class="ss">'$u(t)$'</span><span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'Latex'</span>)</span>
<span id="cb2-91"><a href="#cb2-91"></a></span>
<span id="cb2-92"><a href="#cb2-92"></a><span class="co">% Plot solution</span></span>
<span id="cb2-93"><a href="#cb2-93"></a><span class="va">plot</span>(<span class="va">X</span><span class="op">,</span><span class="va">U</span>(<span class="op">:,</span><span class="fl">1</span>)<span class="op">,</span><span class="ss">'-k'</span><span class="op">,</span><span class="ss">'LineWidth'</span><span class="op">,</span><span class="fl">2</span>)</span>
<span id="cb2-94"><a href="#cb2-94"></a></span>
<span id="cb2-95"><a href="#cb2-95"></a><span class="kw">end</span></span>
<span id="cb2-96"><a href="#cb2-96"></a></span>
<span id="cb2-97"><a href="#cb2-97"></a><span class="kw">function</span> [<span class="va">dudx</span>]<span class="op">=</span><span class="va">DUDT</span>(<span class="va">x</span><span class="op">,</span><span class="va">u</span><span class="op">,</span><span class="va">a</span><span class="op">,</span><span class="va">b</span><span class="op">,</span><span class="va">c</span><span class="op">,</span><span class="va">f</span>)</span>
<span id="cb2-98"><a href="#cb2-98"></a></span>
<span id="cb2-99"><a href="#cb2-99"></a><span class="va">dudx</span>(<span class="fl">1</span>)<span class="op">=</span><span class="va">u</span>(<span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb2-100"><a href="#cb2-100"></a></span>
<span id="cb2-101"><a href="#cb2-101"></a><span class="va">dudx</span>(<span class="fl">2</span>)<span class="op">=</span>(<span class="op">-</span><span class="va">b</span>(<span class="va">x</span>)<span class="op">*</span><span class="va">u</span>(<span class="fl">2</span>)<span class="op">-</span><span class="va">c</span>(<span class="va">x</span>)<span class="op">*</span><span class="va">u</span>(<span class="fl">1</span>)<span class="op">+</span><span class="va">f</span>(<span class="va">x</span>))<span class="op">/</span>(<span class="va">a</span>(<span class="va">x</span>))<span class="op">;</span></span>
<span id="cb2-102"><a href="#cb2-102"></a></span>
<span id="cb2-103"><a href="#cb2-103"></a><span class="kw">end</span></span>
<span id="cb2-104"><a href="#cb2-104"></a></span>
<span id="cb2-105"><a href="#cb2-105"></a><span class="kw">function</span> <span class="va">res</span><span class="op">=</span><span class="va">BCs</span>(<span class="va">x0</span><span class="op">,</span><span class="va">L</span><span class="op">,</span><span class="va">ul</span><span class="op">,</span><span class="va">ur</span>)</span>
<span id="cb2-106"><a href="#cb2-106"></a><span class="co">% The boundary conditions are written as</span></span>
<span id="cb2-107"><a href="#cb2-107"></a><span class="co">% u(x0)=ul</span></span>
<span id="cb2-108"><a href="#cb2-108"></a><span class="co">% x(L)=ur</span></span>
<span id="cb2-109"><a href="#cb2-109"></a></span>
<span id="cb2-110"><a href="#cb2-110"></a><span class="va">res</span><span class="op">=</span>[<span class="va">x0</span>(<span class="fl">1</span>)<span class="op">-</span><span class="va">ul</span><span class="op">;</span><span class="va">L</span>(<span class="fl">1</span>)<span class="op">-</span><span class="va">ur</span>]<span class="op">;</span></span>
<span id="cb2-111"><a href="#cb2-111"></a></span>
<span id="cb2-112"><a href="#cb2-112"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./Part_BVPs.html" class="pagination-link" aria-label="Solving Boundary Value Problems">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Solving Boundary Value Problems</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09_MVP.html" class="pagination-link" aria-label="Mixed Value Problems">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Mixed Value Problems</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>