<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Numerical Solutions of Differential Equations – 2&nbsp; Solving Linear Systems of Equations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Part_IVPs.html" rel="next">
<link href="./Part_LinAlg.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Part_LinAlg.html">Linear Algebra</a></li><li class="breadcrumb-item"><a href="./02_LinAlg.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Solving Linear Systems of Equations</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Numerical Solutions of Differential Equations</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.docx">
              <i class="bi bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Internal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Internal Workings of MATLAB</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_LinAlg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Algebra</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_LinAlg.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Solving Linear Systems of Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_IVPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Initial Value Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_IVP_Euler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Euler Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_IVP_ModEuler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Modified Euler Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_IVP_RK4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fourth Order Runge-Kutta Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_IVP_InBuilt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">MATLAB’s In-Built Procedures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_IVP_Implicit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Implicit IVP Solvers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_BVPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Boundary Value Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_BVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Boundary Value Problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_MVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Mixed Value Problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_SBVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Symmetric Boundary Conditions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_PDEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Partial Differential Equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_PDE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Heat Equation</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#computational-stability-of-linear-systems" id="toc-computational-stability-of-linear-systems" class="nav-link active" data-scroll-target="#computational-stability-of-linear-systems"><span class="header-section-number">2.1</span> Computational Stability of Linear Systems</a></li>
  <li><a href="#sec-Dir" id="toc-sec-Dir" class="nav-link" data-scroll-target="#sec-Dir"><span class="header-section-number">2.2</span> Direct Methods</a>
  <ul class="collapse">
  <li><a href="#direct-substitution" id="toc-direct-substitution" class="nav-link" data-scroll-target="#direct-substitution"><span class="header-section-number">2.2.1</span> Direct Substitution</a></li>
  <li><a href="#forwardbackward-substitution" id="toc-forwardbackward-substitution" class="nav-link" data-scroll-target="#forwardbackward-substitution"><span class="header-section-number">2.2.2</span> Forward/Backward Substitution</a></li>
  <li><a href="#tdma-algorithm" id="toc-tdma-algorithm" class="nav-link" data-scroll-target="#tdma-algorithm"><span class="header-section-number">2.2.3</span> TDMA Algorithm</a></li>
  <li><a href="#cramers-rule" id="toc-cramers-rule" class="nav-link" data-scroll-target="#cramers-rule"><span class="header-section-number">2.2.4</span> Cramer’s Rule</a></li>
  <li><a href="#other-direct-methods" id="toc-other-direct-methods" class="nav-link" data-scroll-target="#other-direct-methods"><span class="header-section-number">2.2.5</span> Other Direct Methods</a></li>
  </ul></li>
  <li><a href="#iterative-methods" id="toc-iterative-methods" class="nav-link" data-scroll-target="#iterative-methods"><span class="header-section-number">2.3</span> Iterative Methods</a>
  <ul class="collapse">
  <li><a href="#constructing-an-iterative-method" id="toc-constructing-an-iterative-method" class="nav-link" data-scroll-target="#constructing-an-iterative-method"><span class="header-section-number">2.3.1</span> Constructing an Iterative Method</a></li>
  <li><a href="#computational-cost-stopping-criteria" id="toc-computational-cost-stopping-criteria" class="nav-link" data-scroll-target="#computational-cost-stopping-criteria"><span class="header-section-number">2.3.2</span> Computational Cost &amp; Stopping Criteria</a></li>
  </ul></li>
  <li><a href="#in-built-matlab-procedures" id="toc-in-built-matlab-procedures" class="nav-link" data-scroll-target="#in-built-matlab-procedures"><span class="header-section-number">2.4</span> In-Built MATLAB Procedures</a></li>
  <li><a href="#exersises" id="toc-exersises" class="nav-link" data-scroll-target="#exersises"><span class="header-section-number">2.5</span> Exersises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Part_LinAlg.html">Linear Algebra</a></li><li class="breadcrumb-item"><a href="./02_LinAlg.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Solving Linear Systems of Equations</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Solving Linear Systems of Equations</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p>Before embarking on the main purpose of the course, which is solving differential equations, first solving linear systems will be necessary. The linear systems will take the form <span class="math display">\[A\boldsymbol{x}=\boldsymbol{b} \quad \text{where} \quad A \in \mathbb{C}^{N \times N}, \boldsymbol{x} \in \mathbb{C}^N \quad \text{and} \quad \boldsymbol{b} \in \mathbb{C}^N.\]</span> This is a situation when the LHS forms a system of equations with a vector of unknowns <span class="math inline">\(\boldsymbol{x}\)</span> and the RHS is known.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Simple Example of a Linear System
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(a, b\)</span> and <span class="math inline">\(c\)</span> be integers such that:</p>
<ul>
<li>their sum is equal to 20</li>
<li><span class="math inline">\(a\)</span> is twice as large as <span class="math inline">\(b\)</span></li>
<li><span class="math inline">\(b\)</span> is bigger than <span class="math inline">\(c\)</span> by 10.</li>
</ul>
<p>These three relationships can be written in equation form as: <span class="math display">\[a+b+c=20\]</span> <span class="math display">\[a=2b\]</span> <span class="math display">\[b-c=10\]</span></p>
<p>This can written in matrix form as: <span class="math display">\[\underbrace{\begin{pmatrix} 1 &amp; 1 &amp; 1 \\ 1 &amp; -2 &amp; 0 \\ 0 &amp; 1 &amp; -1 \end{pmatrix}}_{A} \underbrace{\begin{pmatrix} a \\ b \\ c \end{pmatrix}}_{\boldsymbol{x}} = \underbrace{\begin{pmatrix} 20 \\ 0 \\ 10 \end{pmatrix}}_{\boldsymbol{b}}.\]</span></p>
</div>
</div>
<p>There are two main ways in which this can be done, depending on the form of the matrix:</p>
<ul>
<li>Direct Methods:
<ul>
<li>Direct substitution for diagonal systems;</li>
<li>Forward substitution for lower triangular systems;</li>
<li>Backward substitution for upper triangular systems;</li>
<li>TDMA for tridiagonal systems;</li>
<li>Cramer’s Rule and Gaussian Elimination for more general matrix systems.</li>
</ul></li>
<li>Iterative Methods
<ul>
<li>Jacobi;</li>
<li>Gauss-Seidel.</li>
</ul></li>
<li>In-built Methods:
<ul>
<li>Backsklash operator.</li>
</ul></li>
</ul>
<section id="computational-stability-of-linear-systems" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="computational-stability-of-linear-systems"><span class="header-section-number">2.1</span> Computational Stability of Linear Systems</h2>
<p>Before tackling any linear algebra techniques, it is important to understand <strong><em>Computational Stability</em></strong>.</p>
<p>Consider the linear system <span class="math display">\[A\boldsymbol{x}=\boldsymbol{b} \quad \text{where} \quad A \in \mathbb{C}^{N \times N}, \boldsymbol{x} \in \mathbb{C}^N \quad \text{and} \quad \boldsymbol{b} \in \mathbb{C}^N.\]</span> In real-life applications, the matrix <span class="math inline">\(A\)</span> is usually fully known and often invertible while the vector <span class="math inline">\(\boldsymbol{b}\)</span> may not be known exactly and its measurement may often include rounding errors. Suppose that the vector <span class="math inline">\(\boldsymbol{b}\)</span> has a small error <span class="math inline">\(\delta \boldsymbol{b}\)</span>, then the solution <span class="math inline">\(\boldsymbol{x}\)</span> will also have a small error <span class="math inline">\(\delta \boldsymbol{x}\)</span>, meaning that the system will in fact be <span id="eq-err1"><span class="math display">\[A (\boldsymbol{x} + \delta \boldsymbol{x}) = \boldsymbol{b} + \delta \boldsymbol{b}. \tag{2.1}\]</span></span> Subtracting <span class="math inline">\(A\boldsymbol{x}=\boldsymbol{b}\)</span> form <a href="#eq-err1" class="quarto-xref">Equation&nbsp;<span>2.1</span></a> gives <span class="math inline">\(A \delta \boldsymbol{x} = \delta \boldsymbol{b}\)</span>, therefore <span class="math inline">\(\delta \boldsymbol{x}=A^{-1} \delta \boldsymbol{b}\)</span>.</p>
<p>For <span class="math inline">\(p \in \mathbb{N}\)</span>, consider the ratio between the <span class="math inline">\(p\)</span>-norm of the error <span class="math inline">\(\left\| \delta \boldsymbol{x} \right\|_{p}\)</span> and the <span class="math inline">\(p\)</span>-norm of the exact solution <span class="math inline">\(\left\| \boldsymbol{x} \right\|_{p}\)</span>: <span class="math display">\[\begin{align*}
\frac{\left\| \delta \boldsymbol{x} \right\|_{p}}{\left\| \boldsymbol{x} \right\|_{p}} &amp; = \frac{ \left\| A^{-1} \delta \boldsymbol{b} \right\|_{p}}{\left\| \boldsymbol{x} \right\|_{p}} &amp;&amp; \quad \text{since} \quad \delta \boldsymbol{x}=A^{-1} \delta \boldsymbol{b}\\
&amp; \leq \frac{ \left\| A^{-1} \right\|_{p} \left\| \delta \boldsymbol{b} \right\|_{p}}{\left\| \boldsymbol{x} \right\|_{p}} &amp;&amp; \quad \text{by the \emph{Submultiplicative Property}} \\
&amp; = \frac{ \left\| A^{-1} \right\|_{p} \left\| \delta \boldsymbol{b} \right\|_{p}}{\left\| \boldsymbol{x} \right\|_{p}} \times \frac{\left\| A \right\|_{p}}{\left\| A \right\|_{p}} &amp;&amp; \quad \text{multiplying by} \quad 1=\frac{\left\| A \right\|_{p}}{\left\| A \right\|_{p}} \\
&amp; =\left\| A \right\|_{p} \left\| A^{-1} \right\|_{p} \frac{\left\| \delta \boldsymbol{b} \right\|_{p}}{\left\| A \right\|_{p} \left\| \boldsymbol{x} \right\|_{p}} &amp;&amp; \quad \text{rearranging} \\
&amp; \leq \left\| A \right\|_{p} \left\| A^{-1} \right\|_{p} \frac{\left\| \delta \boldsymbol{b} \right\|_{p}}{\left\| \boldsymbol{b} \right\|_{p}} &amp;&amp; \quad \text{since} \; \; \boldsymbol{b}=A\boldsymbol{x} \; \text{then} \; \; \left\| \boldsymbol{b} \right\|_{p} \leq \left\| A \right\|_{p} \left\| \boldsymbol{x} \right\|_{p} \\
&amp;&amp;&amp; \quad \text{by the Submultiplicative Property,} \\
&amp;&amp;&amp; \quad \text{meaning that}\; \; \frac{1}{\left\| \boldsymbol{b} \right\|_{p}} \geq \frac{1}{\left\| A \right\|_{p} \left\| \boldsymbol{x} \right\|_{p}}
\end{align*}\]</span></p>
<div id="nte-SubMult" class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note&nbsp;2.1: Submultiplicative Property of Matrix Norms
</div>
</div>
<div class="callout-body-container callout-body">
<p>For matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> and a vector <span class="math inline">\(\boldsymbol{x}\)</span>, <span class="math display">\[\| A\boldsymbol{x} \| \leq \| A \| \| \boldsymbol{x} \|,\]</span> <span class="math display">\[\| AB \| \leq \|A\| \|B\|.\]</span> In both cases, the equality holds when either <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span> are orthogonal.</p>
</div>
</div>
<p>Let <span class="math inline">\(\kappa_p(A)=\left\| A^{-1} \right\|_{p} \left\| A \right\|_{p}\)</span>, then <span class="math display">\[\frac{\left\| \delta \boldsymbol{x} \right\|_{p}}{\left\| \boldsymbol{x} \right\|_{p} } \leq \kappa_p(A) \frac{\left\| \delta \boldsymbol{b} \right\|_{p}}{\left\| \boldsymbol{b} \right\|_{p}}\]</span></p>
<p>The quantity <span class="math inline">\(\kappa_p(A)\)</span> is called the <strong><em>Condition Number</em></strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> and it can be regarded as a measure of how sensitive a matrix is to perturbations, in other words, it gives an indication as to the stability of the matrix system. A problem is <strong><em>Well-Conditioned</em></strong> if the condition number is small, and is <strong><em>Ill-Conditioned</em></strong> if the condition number is large (the terms “<em>small</em>” and “<em>large</em>” are somewhat subjective here and will depend on the context). Bear in mind that in practice, calculating the condition number may be computationally expensive since it requires inverting the matrix <span class="math inline">\(A\)</span>.</p>
<p>The condition number derived above follows the assumption that the error only occurs in <span class="math inline">\(\boldsymbol{b}\)</span> which then results in an error in <span class="math inline">\(\boldsymbol{x}\)</span>. If an error <span class="math inline">\(\delta A\)</span> is also committed in <span class="math inline">\(A\)</span>, then for sufficiently small <span class="math inline">\(\delta  A\)</span>, the error bound for the ratio is <span class="math display">\[\frac{\left\| \delta \boldsymbol{x} \right\|_{p}}{\left\| \boldsymbol{x} \right\|_{p}} \leq \frac{\kappa_p(A)}{ 1 - \kappa_p(A) \frac{\left\| \delta A \right\|_{p}}{\left\| A \right\|_{p}}} \left( \frac{\left\| \delta \boldsymbol{b} \right\|_{p}}{\left\| \boldsymbol{b} \right\|_{p}} + \frac{\left\| \delta A \right\|_{p}}{\left\| A \right\|_{p}} \right).\]</span></p>
<p>An example for which <span class="math inline">\(A\)</span> is large is a discretisation matrix of a PDE, in this case, the condition number of <span class="math inline">\(A\)</span> can be very large and increases rapidly as the number of mesh points increases. For example, for a PDE with <span class="math inline">\(N\)</span> mesh points in 2-dimensions, the condition number <span class="math inline">\(\kappa_2(A)\)</span> is of order <span class="math inline">\(\mathcal{O}\left(N\right)\)</span> and it is not uncommon to have <span class="math inline">\(N\)</span> between <span class="math inline">\(10^6\)</span> and <span class="math inline">\(10^8\)</span>. In this case, errors in <span class="math inline">\(\boldsymbol{b}\)</span> may be amplified enormously in the solution process. Thus, if <span class="math inline">\(\kappa_p(A)\)</span> is large, there may be difficulties in solving the system reliably, a problem which plagues calculations with partial differential equations.</p>
<p>Moreover, if <span class="math inline">\(A\)</span> is large, then the system <span class="math inline">\(A\boldsymbol{x}= \boldsymbol{b}\)</span> may be solved using an <em>iterative method</em> which generate a sequence of approximations <span class="math inline">\(\boldsymbol{x}_n\)</span> to <span class="math inline">\(\boldsymbol{x}\)</span> while ensuring that each iteration is easy to perform and that <span class="math inline">\(\boldsymbol{x}_n\)</span> rapidly tends to <span class="math inline">\(\boldsymbol{x}\)</span>, within a certain tolerance, as <span class="math inline">\(n\)</span> tends to infinity. If <span class="math inline">\(\kappa_p(A)\)</span> is large, then the number of iterations to reach this tolerance increases rapidly as the size of <span class="math inline">\(A\)</span> increases, often being proportional to <span class="math inline">\(\kappa_p(A)\)</span> or even to <span class="math inline">\(\kappa_p(A)^2\)</span>. Thus not only do errors in <span class="math inline">\(\boldsymbol{x}\)</span> accumulate for large <span class="math inline">\(\kappa_p(A)\)</span>, but the number of computation required to find <span class="math inline">\(\boldsymbol{x}\)</span> increases as well.</p>
<p>In MATLAB, the condition number can be calculated using the <code>cond(A,p)</code> command where <code>A</code> is the square matrix in question and <code>p</code> is the chosen norm which can only be equal to <code>1</code>, <code>2</code>, <code>inf</code> or <code>'Fro'</code> (when using the Frobenius norm). Also note that <code>cond(A)</code> without the second argument <code>p</code> produces the condition number with the 2-norm by default.</p>
<section id="properties-of-the-condition-number" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="properties-of-the-condition-number">Properties of the Condition Number</h4>
<p>Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be invertible matrices, <span class="math inline">\(p \in \mathbb{N}\)</span> and <span class="math inline">\(\lambda \in \mathbb{R}\)</span>. The condition number <span class="math inline">\(\kappa_p\)</span> has the following properties:</p>
<ul>
<li><span class="math inline">\(\kappa_p(A) \geq 1\)</span>;</li>
<li><span class="math inline">\(\kappa_p(A)=1\)</span> if and only if <span class="math inline">\(A\)</span> is an orthogonal matrix, i.e.&nbsp;<span class="math inline">\(A^{-1}=A^{\mathrm{T}}\)</span>;</li>
<li><span class="math inline">\(\kappa_p({A}^{\mathrm{T}})=\kappa_p(A^{-1})=\kappa_p(A)\)</span>;</li>
<li><span class="math inline">\(\kappa_p(\lambda A)=\kappa_p(A)\)</span>;</li>
<li><span class="math inline">\(\kappa_p(AB) \leq \kappa_p(A)\kappa_p(B)\)</span>.</li>
</ul>
</section>
</section>
<section id="sec-Dir" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="sec-Dir"><span class="header-section-number">2.2</span> Direct Methods</h2>
<p>Direct methods can be used to solve matrix systems in a finite number of steps, although these steps could possibly be computationally expensive.</p>
<section id="direct-substitution" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="direct-substitution"><span class="header-section-number">2.2.1</span> Direct Substitution</h3>
<p>Direct substitution is the simplest direct method and requires the matrix <span class="math inline">\(A\)</span> to be a diagonal with none of the diagonal terms being 0 (otherwise the matrix will not be invertible).</p>
<p>Consider the matrix system <span class="math inline">\(A \boldsymbol{x}=\boldsymbol{b}\)</span> where <span class="math display">\[A=\begin{pmatrix} a_1 \\ &amp; a_2 \\ &amp;&amp; \ddots \\ &amp;&amp;&amp; a_{N-1} \\ &amp;&amp;&amp;&amp; a_{N} \end{pmatrix}, \quad \boldsymbol{x}=\begin{pmatrix} x_1 \\ x_2 \\ \vdots \\ x_{N-1} \\ x_N \end{pmatrix} \quad \text{and} \quad \boldsymbol{b}=\begin{pmatrix} b_1 \\ b_2 \\ \vdots \\ b_{N-1} \\ b_N \end{pmatrix}\]</span> and <span class="math inline">\(a_1, a_2, \dots, a_N \neq 0\)</span>. Direct substitution involves simple multiplication and division: <span class="math display">\[A\boldsymbol{x}=\boldsymbol{b} \quad \implies \quad\begin{pmatrix} a_1 \\ &amp; a_2 \\ &amp;&amp; \ddots \\ &amp;&amp;&amp; a_{N-1} \\ &amp;&amp;&amp;&amp; a_N \end{pmatrix}\begin{pmatrix} x_1 \\ x_2 \\ \vdots \\ x_{N-1} \\ x_{N} \end{pmatrix}=\begin{pmatrix} b_1 \\ b_2 \\ \vdots \\ b_{N-1} \\ b_N \end{pmatrix}\]</span> <span class="math display">\[\implies \quad\begin{matrix} a_1 x_1 = b_1 \\ a_2 x_2 = b_2 \\ \vdots \\ a_{N-1}x_{N-1}=b_{N-1} \\ a_N x_N=b_N \end{matrix} \quad \implies \quad\begin{matrix} x_1=\frac{b_1}{a_1} \\ x_2=\frac{b_2}{a_2} \\ \vdots \\ x_{N-1}=\frac{b_{N-1}}{a_{N-1}} \\ x_N=\frac{b_N}{a_N}. \end{matrix}\]</span></p>
<p>The solution can be written explicitly as <span class="math inline">\(x_n=\frac{b_n}{a_n}\)</span> for all <span class="math inline">\(n=1,2,\dots,N\)</span>. Every step can done independently, meaning that direct substitution lends itself well to parallel computing. In total, direct substitution requires exactly <span class="math inline">\(N\)</span> computations (all being division).</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example of Direct Substituion
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the system <span class="math inline">\(A\boldsymbol{x}=\boldsymbol{b}\)</span> where <span class="math display">\[A=\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 0 &amp; -1 \end{pmatrix}, \quad \boldsymbol{x}=\begin{pmatrix} x_1 \\ x_2 \\ x_3 \end{pmatrix} \quad \text{and} \quad \boldsymbol{b}=\begin{pmatrix} 4 \\ 2 \\ 4 \end{pmatrix}.\]</span> Solving the system using direct substitution: <span class="math display">\[A\boldsymbol{x}=\boldsymbol{b} \quad \implies \quad\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 0 &amp; -1 \end{pmatrix}\begin{pmatrix} x_1 \\ x_2 \\ x_3 \end{pmatrix}=\begin{pmatrix} 4 \\ 2 \\ 4 \end{pmatrix}\]</span> <span class="math display">\[\implies \quad\begin{pmatrix} x_1 \\ 2x_2 \\ -x_3 \end{pmatrix}=\begin{pmatrix} 4 \\ 2 \\ 4 \end{pmatrix} \quad \implies \quad\begin{matrix} x_1=4 \\ x_2=1 \\ x_3=-4. \end{matrix}\]</span></p>
</div>
</div>
</section>
<section id="forwardbackward-substitution" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="forwardbackward-substitution"><span class="header-section-number">2.2.2</span> Forward/Backward Substitution</h3>
<p>Forward/backward substitution require that the matrix <span class="math inline">\(A\)</span> be lower/upper triangular.</p>
<p>Consider the matrix system <span class="math inline">\(A \boldsymbol{x}=\boldsymbol{b}\)</span> where <span class="math display">\[A=\begin{pmatrix} a_{11} &amp; a_{12} &amp; \dots &amp; a_{1,N-1} &amp; a_{1N} \\ &amp; a_{22} &amp; \dots &amp; a_{2,N-1} &amp; a_{2N} \\ &amp;&amp; \ddots &amp; \vdots \\ &amp;&amp;&amp; a_{N-1,N-1} &amp; a_{N-1,N} \\ &amp;&amp;&amp;&amp; a_{NN} \end{pmatrix},\]</span> <span class="math display">\[\boldsymbol{x}=\begin{pmatrix} x_1 \\ x_2 \\ \vdots \\ x_{N-1} \\ x_N \end{pmatrix} \quad \text{and} \quad \boldsymbol{b}=\begin{pmatrix} b_1 \\ b_2 \\ \vdots \\ b_{N-1} \\ b_N \end{pmatrix}\]</span> and <span class="math inline">\(a_{11}, a_{22}, \dots, a_{NN} \neq 0\)</span> (so that the determinant is non-zero). The matrix <span class="math inline">\(A\)</span> is upper triangular in this case and will require backwards substitution: <span class="math display">\[A\boldsymbol{x}=\boldsymbol{b} \quad \implies \quad\begin{pmatrix} a_{11} &amp; a_{12} &amp; \dots &amp; a_{1,N-1} &amp; a_{1N} \\ &amp; a_{22} &amp; \dots &amp; a_{2,N-1} &amp; a_{2N} \\ &amp;&amp; \ddots &amp; \vdots \\ &amp;&amp;&amp; a_{N-1,N-1} &amp; a_{N-1,N} \\ &amp;&amp;&amp;&amp; a_{NN} \end{pmatrix}\begin{pmatrix} x_1 \\ x_2 \\ \vdots \\ x_{N-1} \\ x_N \end{pmatrix}=\begin{pmatrix} b_1 \\ b_2 \\ \vdots \\ b_{N-1} \\ b_N. \end{pmatrix}\]</span></p>
<p><span class="math display">\[\implies \quad\begin{matrix}
a_{11}x_1 &amp;+&amp; a_{12}x_2 &amp;+&amp; \dots  &amp;+&amp; a_{1,N-1} x_{N-1}   &amp;+&amp; a_{1N}x_N    &amp;= b_1     \\
          &amp; &amp; a_{22}x_2 &amp;+&amp; \dots  &amp;+&amp; a_{2,N-1} x_{N-1}   &amp;+&amp; a_{2N}x_N    &amp;= b_2     \\
          &amp; &amp;           &amp; &amp; \vdots &amp; &amp;                     &amp; &amp;              &amp;          \\
          &amp; &amp;           &amp; &amp;        &amp; &amp; a_{N-1,N-1} x_{N-1} &amp;+&amp; a_{N-1,N}x_N &amp;= b_{N-1} \\
          &amp; &amp;           &amp; &amp;        &amp; &amp;                     &amp; &amp; a_{NN}x_N    &amp;= b_N
\end{matrix}\]</span></p>
<p>Backward substitution involves using the solutions from the later equations to solve the earlier ones, this gives: <span class="math display">\[x_N=\frac{b_N}{a_{NN}}\]</span> <span class="math display">\[x_{N-1}=\frac{b_{N-1}-a_{N-1,N}x_N}{a_{N-1,N-1}}\]</span> <span class="math display">\[\vdots\]</span> <span class="math display">\[x_2=\frac{b_2-a_{2N}x_N-a_{2,N-1}x_{N-1}-\dots-a_{23}x_3}{a_{22}}\]</span> <span class="math display">\[x_1=\frac{b_1-a_{1N}x_N-a_{1,N-1}x_{N-1}-\dots-a_{12}x_2}{a_{11}}.\]</span></p>
<p>This can be written more explicitly as: <span class="math display">\[x_n=\begin{cases}
\frac{b_N}{a_{NN}} &amp; \quad \text{for} \quad n=N \\
\frac{1}{a_{nn}}\left( b_n - \sum_{i=n+1}^{N}{a_{ni}x_i} \right) &amp; \quad \text{for} \quad n=N-1, \dots, 2, 1.
\end{cases}\]</span> A similar version can be obtained for the forward substitution for lower triangular matrices as follows: <span class="math display">\[x_n=\begin{cases}
\frac{b_1}{a_{11}} &amp; \quad \text{for} \quad n=1 \\
\frac{1}{a_{nn}}\left( b_n - \sum_{i=1}^{n-1}{a_{ni}x_i} \right) &amp; \quad \text{for} \quad n= 2, 3, \dots, N-1.
\end{cases}\]</span></p>
<p>For any <span class="math inline">\(n=1,2,\dots,N-1\)</span>, calculating it requires 1 division, <span class="math inline">\(N-n\)</span> multiplications and <span class="math inline">\(N-n\)</span> subtractions. Therefore cumulatively, <span class="math inline">\(x_1, x_2, \dots, x_{N-1}\)</span> require <span class="math inline">\(N\)</span> divisions, <span class="math inline">\(\frac{1}{2}\left( N^2-N \right)\)</span> multiplications and <span class="math inline">\(\frac{1}{2}\left( N^2-N \right)\)</span> additions with one more division required for <span class="math inline">\(x_N\)</span>, meaning that in total, backward (and forward) substitution requires <span class="math inline">\(N^2+1\)</span> computations.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example of Backward Substitution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the system <span class="math inline">\(A\boldsymbol{x}=\boldsymbol{b}\)</span> where <span class="math display">\[A=\begin{pmatrix} 1 &amp; 2 &amp; 1 \\ 0 &amp; -1 &amp; 4 \\ 0 &amp; 0 &amp; -1 \end{pmatrix}, \quad \boldsymbol{x}=\begin{pmatrix} x_1 \\ x_2 \\ x_3 \end{pmatrix} \quad \text{and} \quad \boldsymbol{b}=\begin{pmatrix} 1 \\ 0 \\ 1 \end{pmatrix}.\]</span> This problem can be solved by suing backward substitution: <span class="math display">\[A\boldsymbol{x}=\boldsymbol{b} \quad \implies \quad\begin{pmatrix} 1 &amp; 2 &amp; 1 \\ 0 &amp; -1 &amp; 4 \\ 0 &amp; 0 &amp; -1 \end{pmatrix}\begin{pmatrix} x_1 \\ x_2 \\ x_3 \end{pmatrix}=\begin{pmatrix} 1 \\ 0 \\ 1 \end{pmatrix} \quad \implies \quad\begin{matrix} x_1+2x_2+x_3=1 \\ -x_2+4x_3=0 \\ -x_3=1 \end{matrix}\]</span> <span class="math display">\[-x_2+4x_3=0 \quad \underset{x_3=-1}{\Rightarrow} \quad -x_2-4=0 \quad \implies \quad x_2=-4\]</span> <span class="math display">\[x_1+2x_2+x_3=1 \quad \underset{x_2=-4, \; x_3=-1}{\Rightarrow} \quad x_1-8-1=1 \quad \implies \quad x_1=10.\]</span></p>
</div>
</div>
</section>
<section id="tdma-algorithm" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="tdma-algorithm"><span class="header-section-number">2.2.3</span> TDMA Algorithm</h3>
<p>The <strong><em>TriDiagonal Matrix Algorithm</em></strong>, abbreviated as <strong><em>TDMA</em></strong> (also called the <strong><em>Thomas Algorithm</em></strong>) was developed by Llewellyn Thomas which solves tridiagonal matrix systems.</p>
<p>Consider the matrix system <span class="math inline">\(A \boldsymbol{x}=\boldsymbol{b}\)</span> where <span class="math display">\[A=\begin{pmatrix} m_1 &amp; r_1 \\ l_2 &amp; m_2 &amp; r_2 \\ &amp; \ddots &amp; \ddots &amp; \ddots \\ &amp;&amp; l_{N-1} &amp; m_{N-1} &amp; r_{N-1} \\ &amp;&amp;&amp; l_N &amp; m_N \end{pmatrix},\]</span> <span class="math display">\[\boldsymbol{x}=\begin{pmatrix} x_1 \\ x_2 \\ \vdots \\ x_{N-1} \\ x_N \end{pmatrix} \quad \text{and} \quad \boldsymbol{b}=\begin{pmatrix} b_1 \\ b_2 \\ \vdots \\ b_{N-1} \\ b_N \end{pmatrix}.\]</span> The <span class="math inline">\(m\)</span> terms denote the diagonal elements, <span class="math inline">\(l\)</span> denote subdiagonal elements (left of the diagonal terms) and <span class="math inline">\(r\)</span> denote the superdiagonal elements (right of the diagonal terms). The TDMA algorithm works in two steps: first, TDMA performs a forward sweep to eliminate all the subdiagonal terms and rescale the matrix to have 1 as the diagonal (the same can also be done to eliminate the superdiagonal instead). This give the matrix system <span class="math display">\[\begin{pmatrix} 1 &amp; R_1 \\ &amp; 1 &amp; R_2 \\ &amp; &amp; \ddots &amp; \ddots \\ &amp;&amp; &amp; 1 &amp; R_{N-1} \\ &amp;&amp;&amp; &amp; 1 \end{pmatrix}\begin{pmatrix} x_1 \\ x_2 \\ \vdots \\ x_{N-1} \\ x_N \end{pmatrix}=\begin{pmatrix} B_1 \\ B_2 \\ \vdots \\ B_{N-1} \\ B_N \end{pmatrix}\]</span> where <span class="math display">\[R_n=
\begin{cases}
\frac{r_1}{m_1} &amp; n=1 \\ \frac{r_n}{m_n-l_n R_{n-1}} &amp; n=2,3,\dots,N-1
\end{cases}\]</span> <span class="math display">\[B_n=
\begin{cases}
\frac{b_1}{m_1} &amp; n=1 \\ \frac{b_n-l_n B_{n-1}}{m_n - l_n R_{n-1}} &amp; n=2,3,\dots,N.
\end{cases}\]</span></p>
<p>This can now be solved with backward substitution: <span class="math display">\[x_n=
\begin{cases}
B_N &amp; n=N \\ B_n-R_n x_{n+1} &amp; n=N-1, N-2, \dots, 2, 1.
\end{cases}\]</span></p>
<p>The computational complexity can be calculated as follows:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Term</th>
<th style="text-align: center;"><span class="math inline">\(\times\)</span></th>
<th style="text-align: center;"><span class="math inline">\(+\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\div\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(R_1\)</span></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(R_2\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(R_{N-1}\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(B_1\)</span></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(B_2\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(B_{N-1}\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(B_N\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(x_1\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(x_2\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(x_{N-1}\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
<p>This gives a total of <span class="math inline">\(3N-5\)</span> computations for <span class="math inline">\(R\)</span>, <span class="math inline">\(5N-4\)</span> computations for <span class="math inline">\(B\)</span> and <span class="math inline">\(2N-2\)</span> computations for <span class="math inline">\(x\)</span> giving a total of <span class="math inline">\(10N-11\)</span> computations.</p>
<p>There are similar ways of performing eliminations that be done for pentadiagonal systems as well as tridiagonal systems with a full first row.</p>
</section>
<section id="cramers-rule" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="cramers-rule"><span class="header-section-number">2.2.4</span> Cramer’s Rule</h3>
<p><strong><em>Cramer’s Rule</em></strong> is a method that can be used to solve <em>any</em> system <span class="math inline">\(A\boldsymbol{x}=\boldsymbol{b}\)</span> (of course provided that <span class="math inline">\(A\)</span> is non-singular).</p>
<p>Cramer’s rule states that the elements of the vector <span class="math inline">\(\boldsymbol{x}\)</span> are given by <span class="math display">\[x_n = \frac{\text{det}(A_n)}{\text{det}(A)} \quad \text{for all} \quad n = 1,2,\dots,N\]</span> where <span class="math inline">\(A_n\)</span> is the matrix obtained from <span class="math inline">\(A\)</span> by replacing the <span class="math inline">\({n}^{\mathrm{th}}\)</span> column by <span class="math inline">\(\boldsymbol{b}\)</span>. This method seems very simple to execute thanks to its very simple formula, but in practice, it can be very computationally expensive.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example of Cramer’s Rule
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the system <span class="math inline">\(A\boldsymbol{x}=\boldsymbol{b}\)</span> where <span class="math display">\[A=\begin{pmatrix} 0 &amp; 4 &amp; 7 \\ 1 &amp; 0 &amp; 1 \\ 0 &amp; 1 &amp; 0 \end{pmatrix} \quad \text{and} \quad \boldsymbol{b}=\begin{pmatrix} 14 \\ 1 \\ 7 \end{pmatrix}.\]</span> The determinant of <span class="math inline">\(A\)</span> is equal to 7. Using Cramer’s rule, the solution <span class="math inline">\(\boldsymbol{x}={\left( x_1, \; x_2, \; x_3 \right)}^{\mathrm{T}}\)</span> can be calculated as: <span class="math display">\[x_1=\frac{\det(A_1)}{\det(A)}=\frac{\det \begin{pmatrix} 14 &amp; 4 &amp; 7 \\ 1 &amp; 0 &amp; 1 \\ 7 &amp; 1 &amp; 0 \end{pmatrix}}{7}=\frac{21}{7}=3.\]</span> <span class="math display">\[x_2=\frac{\det(A_1)}{\det(A)}=\frac{\det \begin{pmatrix} 0 &amp; 14 &amp; 7 \\ 1 &amp; 1 &amp; 1 \\ 0 &amp; 7 &amp; 0 \end{pmatrix}}{7}=\frac{49}{7}=7.\]</span> <span class="math display">\[x_3=\frac{\det(A_1)}{\det(A)}=\frac{\det \begin{pmatrix} 0 &amp; 4 &amp; 14 \\ 1 &amp; 0 &amp; 1 \\ 0 &amp; 1 &amp; 7 \end{pmatrix}}{7}=\frac{-14}{7}=-2.\]</span></p>
</div>
</div>
<p>Generally, for a matrix of size <span class="math inline">\(N \times N\)</span>, the determinant will require <span class="math inline">\(\mathcal{O}\left(N!\right)\)</span> computations (other matrix forms or methods may require fewer, of <span class="math inline">\(\mathcal{O}\left(N^3\right)\)</span> at least). Cramer’s rule requires calculating the determinants of <span class="math inline">\(N+1\)</span> matrices each is size <span class="math inline">\(N \times N\)</span> and performing <span class="math inline">\(N\)</span> divisions, therefore the computational complexity of Cramer’s rule is <span class="math inline">\(\mathcal{O}\left(N+(N+1) \times N!\right)=\mathcal{O}\left(N+(N+1)!\right)\)</span>. This means that if a machine runs at 1 Gigaflops per second (<span class="math inline">\(10^9\)</span> flops), then a matrix system of size <span class="math inline">\(20 \times 20\)</span> will require 1620 years to compute.</p>
</section>
<section id="other-direct-methods" class="level3" data-number="2.2.5">
<h3 data-number="2.2.5" class="anchored" data-anchor-id="other-direct-methods"><span class="header-section-number">2.2.5</span> Other Direct Methods</h3>
<p>There are many other direct methods with more involved calculations like <em>Gaussian Elimination</em>, <em>LU factorisation</em>, <em>QR decomposition</em>, <em>Singular Value Decomposition</em> amongst others. All these methods will be placed in the appendix.</p>
</section>
</section>
<section id="iterative-methods" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="iterative-methods"><span class="header-section-number">2.3</span> Iterative Methods</h2>
<p>For a large matrix <span class="math inline">\(A\)</span>, solving the system <span class="math inline">\(A\boldsymbol{x} = \boldsymbol{b}\)</span> directly can be computationally restrictive as seen in the different methods shown in <a href="#sec-Dir" class="quarto-xref"><span>Section 2.2</span></a>. An alternative would be to use <em>iterative</em> methods which generate a sequence of approximations <span class="math inline">\(\boldsymbol{x}^{(k)}\)</span> to the exact solution <span class="math inline">\(\boldsymbol{x}\)</span>. The hope is that the iterative method converges to the exact solution, i.e. <span class="math display">\[\lim_{k \to \infty}\boldsymbol{x}^{(k)}=\boldsymbol{x}.\]</span></p>
<p>A possible strategy to realise this process is to consider the following recursive definition <span class="math display">\[\boldsymbol{x}^{(k)} = B\boldsymbol{x}^{(k-1)}+\boldsymbol{g} \quad \text{for} \quad k\geq 1,\]</span> where <span class="math inline">\(B\)</span> is a suitable matrix called the <strong><em>Iteration Matrix</em></strong> (which would generally depend on <span class="math inline">\(A\)</span>) and <span class="math inline">\(\boldsymbol{g}\)</span> is a suitable vector (depending on <span class="math inline">\(A\)</span> and <span class="math inline">\(\boldsymbol{b}\)</span>). Since the iterations <span class="math inline">\(\boldsymbol{x}^{(k)}\)</span> must tend to <span class="math inline">\(\boldsymbol{x}\)</span> as <span class="math inline">\(k\)</span> tends to infinity, then <span id="eq-Bxgk"><span class="math display">\[\boldsymbol{x}^{(k)} = B\boldsymbol{x}^{(k-1)}+\boldsymbol{g} \tag{2.2}\]</span></span> <span id="eq-Bxg"><span class="math display">\[\quad \underset{k \to \infty}{\Rightarrow} \quad \boldsymbol{x}=B\boldsymbol{x}+\boldsymbol{g}. \tag{2.3}\]</span></span></p>
<p>Next, a sufficient condition needs to be derived; define <span class="math inline">\(\boldsymbol{e}^{(k)}\)</span> as the error incurred from iteration <span class="math inline">\(k\)</span>, i.e.&nbsp;<span class="math inline">\(\boldsymbol{e}^{(k)} := \boldsymbol{x} - \boldsymbol{x}^{(k)}\)</span> and consider the linear systems <span class="math display">\[\boldsymbol{x} = B\boldsymbol{x}+\boldsymbol{g} \quad \text{and} \quad \boldsymbol{x}^{(k)} = B\boldsymbol{x}^{(k-1)}+\boldsymbol{g}.\]</span> Subtracting these gives <span class="math display">\[\begin{align*}
&amp; \quad \boldsymbol{x}-\boldsymbol{x}^{(k)} = \left( B\boldsymbol{x}+\boldsymbol{g} \right)-\left( B\boldsymbol{x}^{(k-1)}+\boldsymbol{g} \right) \\
\implies &amp; \quad \boldsymbol{x}-\boldsymbol{x}^{(k)} = B\left( \boldsymbol{x}-\boldsymbol{x}^{(k-1)} \right) \\
\implies &amp; \quad \boldsymbol{e}^{(k)}=B\boldsymbol{e}^{(k-1)}.
\end{align*}\]</span></p>
<p>In order to find a bound for the error, take the 2-norm of the error equation <span class="math display">\[\boldsymbol{e}^{(k)}=B\boldsymbol{e}^{(k-1)} \quad \underset{\left\| \cdot \right\|_{2}}{\Rightarrow} \quad \|\boldsymbol{e}^{(k)}\|_2 = \|B\boldsymbol{e}^{(k-1)}\|_2.\]</span> By the submultiplicative property of matrix norms given in <a href="#nte-SubMult" class="quarto-xref">Note&nbsp;<span>2.1</span></a>, the error <span class="math inline">\(\| \boldsymbol{e}^{(k)} \|\)</span> can be bounded above as <span class="math display">\[\left\| \boldsymbol{e}^{(k)} \right\|_{2} = \left\| B\boldsymbol{e}^{(k-1)} \right\|_{2} \leq \left\| B \right\|_{2} \left\| \boldsymbol{e}^{(k-1)} \right\|_{2}.\]</span> This can be iterated backwards, so for <span class="math inline">\(k \geq 1\)</span>, <span class="math display">\[\|\boldsymbol{e}^{(k)}\|_2 \leq \| B \|_2 \|\boldsymbol{e}^{(k-1)}\|_2 \leq \| B \|_2^2 \|\boldsymbol{e}^{(k-2)}\|_2 \leq \dots \leq \| B \|_2^{k} \|\boldsymbol{e}^{(0)}\|_2.\]</span> Generally, this means that the error at any iteration <span class="math inline">\(k\)</span> can be bounded above by the error at the initial iteration <span class="math inline">\(\boldsymbol{e}^{(0)}\)</span>. Therefore, since <span class="math inline">\(\boldsymbol{e}^{(0)}\)</span> is arbitrary, if <span class="math inline">\(\| B \|_2&lt;1\)</span> then the set of vectors <span class="math inline">\(\left\{ \boldsymbol{x}^{(k)} \right\}_{k \in \mathbb{N}}\)</span> generated by the iterative scheme <span class="math inline">\(\boldsymbol{x}^{(k)}=B\boldsymbol{x}^{(k-1)}+\boldsymbol{g}\)</span> will converge to the exact solution <span class="math inline">\(\boldsymbol{x}\)</span> which solves <span class="math inline">\(A\boldsymbol{x}=\boldsymbol{b}\)</span>, hence giving a sufficient condition for convergence.</p>
<section id="constructing-an-iterative-method" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="constructing-an-iterative-method"><span class="header-section-number">2.3.1</span> Constructing an Iterative Method</h3>
<p>A general technique to devise an iterative method to solve <span class="math inline">\(A \boldsymbol{x}=\boldsymbol{b}\)</span> is based on a “splitting” of the matrix <span class="math inline">\(A\)</span>. First, write the matrix <span class="math inline">\(A\)</span> as <span class="math inline">\(A = P-(P-A)\)</span> where <span class="math inline">\(P\)</span> is a suitable non-singular matrix (somehow linked to <span class="math inline">\(A\)</span> and “easy” to invert). Then <span class="math display">\[\begin{align*}
P\boldsymbol{x} &amp; =\left[ A+(P-A) \right]\boldsymbol{x} &amp;&amp; \quad \text{since $P=A+P-A$}\\
&amp; =(P-A)\boldsymbol{x}+A\boldsymbol{x} &amp;&amp; \quad \text{expanding} \\
&amp; =(P-A)\boldsymbol{x}+\boldsymbol{b} &amp;&amp; \quad \text{since $A\boldsymbol{x}=\boldsymbol{b}$}
\end{align*}\]</span></p>
<p>Therefore, the vector <span class="math inline">\(\boldsymbol{x}\)</span> can be written implicitly as <span class="math display">\[\boldsymbol{x}=P^{-1}(P-A)\boldsymbol{x}+P^{-1}\boldsymbol{b}\]</span> which is of the form given in <a href="#eq-Bxg" class="quarto-xref">Equation&nbsp;<span>2.3</span></a> where <span class="math inline">\(B=P^{-1}(P-A)=I-P^{-1}A\)</span> and <span class="math inline">\(\boldsymbol{g}=P^{-1}\boldsymbol{b}\)</span>. It would then stand to reason that if the iterative procedure was of the form <span class="math display">\[\boldsymbol{x}^{(k)}=P^{-1}(P-A)\boldsymbol{x}^{(k-1)}+P^{-1}\boldsymbol{b}\]</span> (as in <a href="#eq-Bxgk" class="quarto-xref">Equation&nbsp;<span>2.2</span></a>), then the method should converge to the exact solution (provided a suitable choice for <span class="math inline">\(P\)</span>). Of course, for the iterative procedure, the iteration needs an initial vector to start which will be <span class="math display">\[\boldsymbol{x}^{(0)}=\begin{pmatrix} x_1^{(0)} \\ x_2^{(0)} \\ \vdots \\ x_N^{(0)} \end{pmatrix}.\]</span></p>
<p>The choice of the matrix <span class="math inline">\(P\)</span> should depend on <span class="math inline">\(A\)</span> in some way. So suppose that the matrix <span class="math inline">\(A\)</span> is broken down into three parts, <span class="math inline">\(A=D+L+U\)</span> where <span class="math inline">\(D\)</span> is the matrix of the diagonal entries of <span class="math inline">\(A\)</span>, <span class="math inline">\(L\)</span> is the strictly lower triangular part or <span class="math inline">\(A\)</span> (i.e.&nbsp;not including the diagonal) and <span class="math inline">\(U\)</span> is the strictly upper triangular part of <span class="math inline">\(A\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For example <span class="math display">\[\underbrace{\begin{pmatrix} a &amp; b &amp; c \\ d &amp; e &amp; f \\ g &amp; h &amp; i \end{pmatrix}}_{A}=\underbrace{\begin{pmatrix} a &amp; 0 &amp; 0 \\ 0 &amp; e &amp; 0 \\ 0 &amp; 0 &amp; i \end{pmatrix}}_{D}+\underbrace{\begin{pmatrix}  0 &amp; 0 &amp; 0 \\ d &amp; 0 &amp; 0 \\ g &amp; h &amp; 0 \end{pmatrix}}_{L}+\underbrace{\begin{pmatrix}  0 &amp; b &amp; c \\ 0 &amp; 0 &amp; f \\ 0 &amp; 0 &amp; 0 \end{pmatrix}}_{U}.\]</span></p>
</div>
</div>
<ul>
<li><strong><em>Jacobi Method</em></strong>: <span class="math inline">\(\boldsymbol{P=D}\)</span></li>
</ul>
<p>The matrix <span class="math inline">\(P\)</span> is chosen to be equal to the diagonal part of <span class="math inline">\(A\)</span>, then the splitting procedure gives the iteration matrix <span class="math inline">\(B=I-D^{-1}A\)</span> and the iteration itself is <span class="math inline">\(\boldsymbol{x}^{(k)} = B\boldsymbol{x}^{(k-1)}+D^{-1}\boldsymbol{b}\)</span> for <span class="math inline">\(k \geq 0\)</span>, which can be written component-wise as <span id="eq-Jmethod"><span class="math display">\[x_i^{(k)}=\frac{1}{a_{ii}}\left(b_i-\sum_{\substack{j=1 \\ j\neq i}}^{N}a_{ij}x_j^{(k-1)}\right) \quad \text{for all} \quad i=1,\dots,N. \tag{2.4}\]</span></span></p>
<p>If <span class="math inline">\(A\)</span> is strictly diagonally dominant by rows<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, then the Jacobi method converges. Note that each component <span class="math inline">\(x_i^{(k)}\)</span> of the new vector <span class="math inline">\(\boldsymbol{x}^{(k)}\)</span> is computed independently of the others, meaning that the update is simultaneous which makes this method suitable for parallel programming.</p>
<ul>
<li><strong><em>Gauss-Seidel Method</em></strong>: <span class="math inline">\(\boldsymbol{P=D+L}\)</span></li>
</ul>
<p>The matrix <span class="math inline">\(P\)</span> is chosen to be equal to the lower triangular part of <span class="math inline">\(A\)</span>, therefore the iteration matrix is given by <span class="math inline">\(B = (D + L)^{-1}(D + L - A)\)</span> and the iteration itself is <span class="math inline">\(\boldsymbol{x}^{(k+1)}=B\boldsymbol{x}^{(k)}+(D+L)^{-1}\boldsymbol{b}\)</span> which can be written component-wise as <span id="eq-GSmethod"><span class="math display">\[x_i^{(k+1)}=\frac{1}{a_{ii}}\left(b_i-\sum_{j=1}^{i-1}a_{ij}x_j^{(k+1)}-\sum_{j=i+1}^{N}a_{ij}x_j^{(k)}\right) \quad \text{for all} \quad i=1,\dots,N. \tag{2.5}\]</span></span></p>
<p>Contrary to Jacobi method, Gauss-Seidel method updates the components in sequential mode.</p>
<p>There are many other methods that use splitting like:</p>
<ul>
<li>Damped Jacobi method: <span class="math inline">\(P=\frac{1}{\omega}D\)</span> for some <span class="math inline">\(\omega \neq 0\)</span></li>
<li>Successive over-relaxation method: <span class="math inline">\(P=\frac{1}{\omega}D+L\)</span> for some <span class="math inline">\(\omega \neq 0\)</span></li>
<li>Symmetric successive over-relaxation method: <span class="math inline">\(P=\frac{1}{\omega(2-\omega)}(D+\omega L) D^{-1} (D+\omega U)\)</span> for some <span class="math inline">\(\omega \neq 0,2.\)</span></li>
</ul>
</section>
<section id="computational-cost-stopping-criteria" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="computational-cost-stopping-criteria"><span class="header-section-number">2.3.2</span> Computational Cost &amp; Stopping Criteria</h3>
<p>There are essentially two factors contributing to the effectiveness of an iterative method for <span class="math inline">\(A\boldsymbol{x}=\boldsymbol{b}\)</span>: the computational cost per iteration and the number of performed iterations. The computational cost per iteration depends on the structure and sparsity of the original matrix <span class="math inline">\(A\)</span> and on the choice of the splitting. For both Jacobi and Gauss-Seidel methods, without further assumptions on <span class="math inline">\(A\)</span>, the computational cost per iteration is <span class="math inline">\(\mathcal{O}\left(N^2\right)\)</span>. Iterations should be stopped when one or more stopping criteria are satisfied, as will be discussed below. For both Jacobi and Gauss-Seidel methods, the cost of performing <span class="math inline">\(k\)</span> iterations is <span class="math inline">\(\mathcal{O}\left(kN^2\right)\)</span>; so as long as <span class="math inline">\(k \ll N\)</span>, these methods are much cheaper than Gaussian elimination.</p>
<p>In theory, iterative methods require an infinite number of iterations to converge to the exact solution of a linear system but in practice, aiming for the exact solution is neither reasonable nor necessary. Indeed, what is actually needed is an approximation <span class="math inline">\(\boldsymbol{x}^{(k)}\)</span> for which the error is guaranteed to be lower than a desired tolerance <span class="math inline">\(\tau&gt;0\)</span>. On the other hand, since the error is itself unknown (as it depends on the exact solution), a suitable <em>a posteriori</em> error estimator is needed which predicts the error starting from quantities that have already been computed. There are two natural estimators one may consider:</p>
<ul>
<li><strong>Residual</strong>: The residual error at the <span class="math inline">\({k}^{\mathrm{th}}\)</span> iteration, denoted <span class="math inline">\(\boldsymbol{r}^{(k)}\)</span> is given by the error between <span class="math inline">\(A\boldsymbol{x}^{(k)}\)</span> and <span class="math inline">\(\boldsymbol{b}\)</span>, namely <span class="math inline">\(\boldsymbol{r}^{(k)}=\boldsymbol{b}-A\boldsymbol{x}^{(k)}\)</span>. An iterative method can be stopped at the first iteration step <span class="math inline">\(k=k_{\min}\)</span> for which <span class="math display">\[\|\boldsymbol{r}^{(k)}\|\leq\tau \|\boldsymbol{b}\|.\]</span></li>
<li><strong>Increment</strong>: The incremental error at the <span class="math inline">\(k^{\mathrm{th}}\)</span> iteration, denoted <span class="math inline">\(\boldsymbol{\delta}^{(k)}\)</span> is the error between consecutive approximations, namely <span class="math inline">\(\boldsymbol{\delta}^{(k)}=\boldsymbol{x}^{(k)}-\boldsymbol{x}^{(k-1)}\)</span>. An iterative method can be stopped after the first iteration step <span class="math inline">\(k=k_{\min}\)</span> for which <span class="math display">\[\|\boldsymbol{\delta}^{(k)}\|\leq\tau.\]</span></li>
</ul>
<p>Of course, another way to stop the iteration is by imposing a maximum number of allowable iterations <span class="math inline">\(K\)</span>, this is usually a good starting point since it is not possible to know beforehand if the method does indeed converge. Enforcing a maximum number of iterations will determine if the initial guess is suitable, if the method is suitable or indeed if there is any convergence.</p>
</section>
</section>
<section id="in-built-matlab-procedures" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="in-built-matlab-procedures"><span class="header-section-number">2.4</span> In-Built MATLAB Procedures</h2>
<p>Given that MATLAB is well-suited to dealing with matrices, it has a very powerful method of solving linear systems and it is using the <strong><em>Backslash Operator</em></strong>. This is a powerful in-built method that can solve any square linear system regardless of its form. MATLAB does this by first determining the general form of the matrix (sparse, triangular, Hermitian, etc.) before applying the appropriate optimised method.</p>
<p>For the linear system <span class="math display">\[A \boldsymbol{x} = \boldsymbol{b} \quad \text{where} \quad A \in \mathbb{R}^{N \times N}, \quad \boldsymbol{x} \in \mathbb{R}^N, \quad \boldsymbol{b} \in \mathbb{R}^N\]</span> MATLAB can solve this using the syntax <code>x=A\b</code>.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Starting Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Returning to the example in the beginning of this section, the matrix system was <span class="math display">\[\underbrace{\begin{pmatrix} 1 &amp; 1 &amp; 1 \\ 1 &amp; -2 &amp; 0 \\ 0 &amp; 1 &amp; -1 \end{pmatrix}}_{A} \underbrace{\begin{pmatrix} a \\ b \\ c \end{pmatrix}}_{\boldsymbol{x}} = \underbrace{\begin{pmatrix} 20 \\ 0 \\ 10 \end{pmatrix}}_{\boldsymbol{b}}.\]</span> This can be solved as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">&gt;&gt;</span> <span class="va">A</span><span class="op">=</span>[<span class="fl">1</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="fl">1</span><span class="op">;</span><span class="fl">1</span><span class="op">,-</span><span class="fl">2</span><span class="op">,</span><span class="fl">0</span><span class="op">;</span><span class="fl">0</span><span class="op">,</span><span class="fl">1</span><span class="op">,-</span><span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="op">&gt;&gt;</span> <span class="va">b</span><span class="op">=</span>[<span class="fl">20</span><span class="op">;</span><span class="fl">0</span><span class="op">;</span><span class="fl">10</span>]<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="op">&gt;&gt;</span> <span class="va">A</span><span class="op">\</span><span class="va">b</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="va">ans</span> <span class="op">=</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>     <span class="fl">15.0000</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>      <span class="fl">7.5000</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>     <span class="op">-</span><span class="fl">2.5000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <a href="https://uk.mathworks.com/help/matlab/ref/double.mldivide.html">MATLAB website</a> shows the following flowcharts for how <code>A\b</code> classifies the problem before solving it.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/mldivide_full.png" class="img-fluid figure-img"></p>
<figcaption>If the matrix <span class="math inline">\(A\)</span> is full.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/mldivide_sparse.png" class="img-fluid figure-img"></p>
<figcaption>If the matrix <span class="math inline">\(A\)</span> is sparse.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="exersises" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="exersises"><span class="header-section-number">2.5</span> Exersises</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 2.1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be invertible matrices, <span class="math inline">\(p \in \mathbb{N}\)</span> and <span class="math inline">\(\lambda \in \mathbb{R}\)</span>. The condition number <span class="math inline">\(\kappa_p\)</span> has the following properties:</p>
<ol type="i">
<li><span class="math inline">\(\kappa_p(A) \geq 1\)</span>;</li>
<li>If <span class="math inline">\(A\)</span> is an orthogonal matrix (<span class="math inline">\(A^{-1}=A^{\mathrm{T}}\)</span>), then <span class="math inline">\(\kappa_2(A)=1\)</span>;</li>
<li><span class="math inline">\(\kappa_2\left( {A}^{\mathrm{T}} \right)=\kappa_2\left( A^{-1} \right)=\kappa_2(A)\)</span>;</li>
<li><span class="math inline">\(\kappa_p(\lambda A)=\kappa_p(A)\)</span>;</li>
<li><span class="math inline">\(\kappa_p(AB) \leq \kappa_p(A)\kappa_p(B)\)</span>.</li>
</ol>
<p>You may use the fact that <span class="math inline">\(\| A \|_2=\| {A}^{\mathrm{T}} \|_2\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution 2.1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\kappa_p(A)=\left\| A \right\|_{p} \left\| A^{-1} \right\|_{p}\]</span></p>
<ol type="i">
<li><p>Using the submultiplicative property of matrices <span class="math display">\[\kappa_p(A)=\left\| A \right\|_{p} \left\| A^{-1} \right\|_{p} \geq \left\| A A^{-1} \right\|_{p} = \left\| \mathcal{I} \right\|_{p}=1.\]</span></p></li>
<li><p>If <span class="math inline">\(A\)</span> is orthogonal (<span class="math inline">\(A^{-1}={A}^{\mathrm{T}}\)</span>), then the submultiplicative property of matrices becomes an equality, so <span class="math display">\[\kappa_2(A)=\left\| A \right\|_{2} \left\| A^{-1} \right\|_{2} = \left\| A A^{-1} \right\|_{2} = \left\| \mathcal{I} \right\|_{2}=1.\]</span></p></li>
<li></li>
</ol>
<p><span class="math display">\[\begin{multline}
\bullet \; \kappa_2\left( {A}^{\mathrm{T}} \right)=\left\| {A}^{\mathrm{T}} \right\|_{2}\left\| {\left( A^{-1} \right)}^{\mathrm{T}} \right\|_{2}=\left\| {A}^{\mathrm{T}} \right\|_{2}\left\| {A^{-1}}^{\mathrm{T}} \right\|_{2} \\ =\left\| A \right\|_{2}\left\| A^{-1} \right\|_{2}=\kappa_2(A).
\end{multline}\]</span> <span class="math display">\[\bullet \; \kappa_2\left( A^{-1} \right)=\left\| A^{-1} \right\|_{2}=\left\| \left( A^{-1} \right)^{-1} \right\|_{2}=\left\| A \right\|_{2}\left\| A^{-1} \right\|_{2}=\kappa_2(A).\]</span></p>
<ol start="4" type="i">
<li></li>
</ol>
<p><span class="math display">\[\begin{multline}
\kappa_p(\lambda A)=\left\| \lambda A \right\|_{p} \left\| (\lambda A)^{-1} \right\|_{p}=\left\| \lambda A \right\|_{p} \left\| \frac{1}{\lambda}A^{-1} \right\|_{p}= \\ |\lambda| \left\| A \right\|_{p} \frac{1}{|\lambda|}\left\| A^{-1} \right\|_{p}=\left\| A \right\|_{p} \left\| A^{-1} \right\|_{p}=\kappa_p(A).
\end{multline}\]</span></p>
<ol start="22" type="a">
<li></li>
</ol>
<p><span class="math display">\[\begin{multline}
\kappa_p(AB)=\left\| AB \right\|_{p} \left\| (AB)^{-1} \right\|_{p}=\left\| AB \right\|_{p} \left\| A^{-1} B^{-1} \right\|_{p} \\ \leq \left\| A \right\|_{p} \left\| B \right\|_{p} \left\| B^{-1} \right\|_{p} \left\| A^{-1} \right\|_{p}=\kappa_p(A)\kappa_p(B).
\end{multline}\]</span></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 2.2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Solve the following linear systems of the form <span class="math inline">\(A \boldsymbol{x}=\boldsymbol{b}\)</span> using the following direct methods:</p>
<ol type="i">
<li><p>Direct substitution <span class="math display">\[A=\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; -2 &amp; 0 \\ 0 &amp; 0 &amp; 5 \end{pmatrix}, \quad \boldsymbol{b}=\begin{pmatrix} 3 \\ 9 \\ 0 \end{pmatrix}\]</span></p></li>
<li><p>Backward substitution <span class="math display">\[A=\begin{pmatrix} 4 &amp; 2 &amp; 1 \\ 0 &amp; 2 &amp; 1 \\ 0 &amp; 0 &amp; 10 \end{pmatrix}, \quad \boldsymbol{b}=\begin{pmatrix} 1 \\ 1 \\ 1 \end{pmatrix}\]</span></p></li>
<li><p>Forwards substitution <span class="math display">\[A=\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 4 &amp; 5 &amp; 0 \\ 9 &amp; 1 &amp; 2 \end{pmatrix}, \quad \boldsymbol{b}=\begin{pmatrix} 0 \\ 0 \\ 1 \end{pmatrix}\]</span></p></li>
<li><p>TDMA <span class="math display">\[A=\begin{pmatrix} 2 &amp; -1 &amp; 0 &amp; 0 &amp; 0 \\ -1 &amp; 2 &amp; -1 &amp; 0 &amp; 0 \\ 0 &amp; -1 &amp; 2 &amp; -1 &amp; 0 \\ 0 &amp; 0 &amp; -1 &amp; 2 &amp; -1 \\ 0 &amp; 0 &amp; 0 &amp; -1 &amp; 2 \end{pmatrix}, \quad \boldsymbol{b}=\begin{pmatrix} 1 \\ 0 \\ 1 \\ 0 \\ 1 \end{pmatrix}\]</span></p></li>
<li><p>Cramer’s Rule <span class="math display">\[A=\begin{pmatrix} 1 &amp; 0 &amp; 2 \\ 2 &amp; 1 &amp; 2 \\ -1 &amp; 0 &amp; 0 \end{pmatrix}, \quad \boldsymbol{b}=\begin{pmatrix} 12 \\ 0 \\ 6 \end{pmatrix}\]</span></p></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions 2.2
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\mathrm{i.} \quad \boldsymbol{x}=\begin{pmatrix} 3 \\ -4.5 \\ 0 \end{pmatrix}\]</span></p>
<p><span class="math display">\[\mathrm{ii.} \quad \boldsymbol{x}=\begin{pmatrix} 0 \\ 0.45 \\ 0.1 \end{pmatrix}\]</span></p>
<p><span class="math display">\[\mathrm{iii.} \quad \boldsymbol{x}=\begin{pmatrix} 0 \\ 0 \\ 0.5 \end{pmatrix}\]</span></p>
<p><span class="math display">\[\mathrm{iv.} \quad \boldsymbol{x}=\begin{pmatrix} 1.5 \\ 2 \\ 2.5 \\ 2 \\ 1.5 \end{pmatrix}\]</span></p>
<p><span class="math display">\[\mathrm{v.} \quad \boldsymbol{x}=\begin{pmatrix} 0 \\ -12 \\ 6 \end{pmatrix}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exersise 2.3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using the formulas derived, write MATLAB codes that can perform:</p>
<ul>
<li>Direct substitution</li>
<li>Backward substitution</li>
<li>Forward substitution</li>
<li>TDMA</li>
<li>Cramer’s Rule</li>
</ul>
<p>Use the examples in Exercise 2.2 as test cases.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions 2.3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Direct Substitution</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">function</span> <span class="va">D_Sub</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="va">A</span><span class="op">=</span><span class="va">diag</span>([<span class="fl">1</span><span class="op">,-</span><span class="fl">2</span><span class="op">,</span><span class="fl">5</span>])<span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="va">b</span><span class="op">=</span>[<span class="fl">3</span><span class="op">;</span><span class="fl">9</span><span class="op">;</span><span class="fl">0</span>]<span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="kw">if</span> <span class="va">isdiag</span>(<span class="va">A</span>)<span class="op">~=</span><span class="fl">1</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>    <span class="va">error</span>(<span class="ss">'A must be a diagonal matrix'</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="kw">end</span></span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="kw">if</span> <span class="va">any</span>(<span class="va">diag</span>(<span class="va">A</span>)<span class="op">==</span><span class="fl">0</span>)</span>
<span id="cb2-11"><a href="#cb2-11"></a>    <span class="va">error</span>(<span class="ss">'All diagonal terms must be non-zero'</span>)</span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="kw">end</span></span>
<span id="cb2-13"><a href="#cb2-13"></a></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="va">N</span><span class="op">=</span><span class="va">length</span>(<span class="va">b</span>)<span class="op">;</span></span>
<span id="cb2-15"><a href="#cb2-15"></a></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="va">x</span><span class="op">=</span><span class="va">zeros</span>(<span class="fl">1</span><span class="op">,</span><span class="va">N</span>)<span class="op">;</span></span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="kw">for</span> <span class="va">n</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>    <span class="va">x</span>(<span class="va">n</span>)<span class="op">=</span><span class="va">b</span>(<span class="va">n</span>)<span class="op">/</span><span class="va">A</span>(<span class="va">n</span><span class="op">,</span><span class="va">n</span>)<span class="op">;</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="kw">end</span></span>
<span id="cb2-21"><a href="#cb2-21"></a></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="va">disp</span>(<span class="ss">'x='</span>)</span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="va">disp</span>(<span class="va">x</span>)</span>
<span id="cb2-24"><a href="#cb2-24"></a></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Backward Substitution</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">function</span> <span class="va">B_Sub</span></span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="va">A</span><span class="op">=</span>[<span class="fl">4</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">1</span><span class="op">;</span><span class="fl">0</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">1</span><span class="op">;</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">10</span>]<span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="va">b</span><span class="op">=</span>[<span class="fl">1</span><span class="op">;</span><span class="fl">1</span><span class="op">;</span><span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="kw">if</span> <span class="va">istriu</span>(<span class="va">A</span>)<span class="op">~=</span><span class="fl">1</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="va">error</span>(<span class="ss">'A must be an upper triangluar matrix'</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw">end</span></span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="kw">if</span> <span class="va">any</span>(<span class="va">diag</span>(<span class="va">A</span>)<span class="op">==</span><span class="fl">0</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="va">error</span>(<span class="ss">'All diagonal terms must be non-zero'</span>)</span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="kw">end</span></span>
<span id="cb3-13"><a href="#cb3-13"></a></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="va">N</span><span class="op">=</span><span class="va">length</span>(<span class="va">b</span>)<span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15"></a></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="va">x</span><span class="op">=</span><span class="va">zeros</span>(<span class="fl">1</span><span class="op">,</span><span class="va">N</span>)<span class="op">;</span></span>
<span id="cb3-17"><a href="#cb3-17"></a></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="va">x</span>(<span class="va">N</span>)<span class="op">=</span><span class="va">b</span>(<span class="va">N</span>)<span class="op">/</span><span class="va">A</span>(<span class="va">N</span><span class="op">,</span><span class="va">N</span>)<span class="op">;</span></span>
<span id="cb3-19"><a href="#cb3-19"></a></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="kw">for</span> <span class="va">n</span><span class="op">=</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">:-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>    <span class="va">S</span><span class="op">=</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>    <span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>        <span class="va">S</span><span class="op">=</span><span class="va">S</span><span class="op">+</span><span class="va">A</span>(<span class="va">n</span><span class="op">,</span><span class="va">i</span>)<span class="op">*</span><span class="va">x</span>(<span class="va">i</span>)<span class="op">;</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>    <span class="kw">end</span></span>
<span id="cb3-25"><a href="#cb3-25"></a>    <span class="va">x</span>(<span class="va">n</span>)<span class="op">=</span>(<span class="va">b</span>(<span class="va">n</span>)<span class="op">-</span><span class="va">S</span>)<span class="op">/</span><span class="va">A</span>(<span class="va">n</span><span class="op">,</span><span class="va">n</span>)<span class="op">;</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="kw">end</span></span>
<span id="cb3-27"><a href="#cb3-27"></a></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="va">disp</span>(<span class="ss">'x='</span>)</span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="va">disp</span>(<span class="va">x</span>)</span>
<span id="cb3-30"><a href="#cb3-30"></a></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Forward Substitution</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">function</span> <span class="va">F_Sub</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="va">A</span><span class="op">=</span>[<span class="fl">1</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">;</span><span class="fl">4</span><span class="op">,</span><span class="fl">5</span><span class="op">,</span><span class="fl">0</span><span class="op">;</span><span class="fl">9</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="fl">2</span>]<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="va">b</span><span class="op">=</span>[<span class="fl">0</span><span class="op">;</span><span class="fl">0</span><span class="op">;</span><span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="kw">if</span> <span class="va">istril</span>(<span class="va">A</span>)<span class="op">~=</span><span class="fl">1</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="va">error</span>(<span class="ss">'A must be a lower triangular matrix'</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="kw">end</span></span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="kw">if</span> <span class="va">any</span>(<span class="va">diag</span>(<span class="va">A</span>)<span class="op">==</span><span class="fl">0</span>)</span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="va">error</span>(<span class="ss">'All diagonal terms must be non-zero'</span>)</span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="kw">end</span></span>
<span id="cb4-13"><a href="#cb4-13"></a></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="va">N</span><span class="op">=</span><span class="va">length</span>(<span class="va">b</span>)<span class="op">;</span></span>
<span id="cb4-15"><a href="#cb4-15"></a></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="va">x</span><span class="op">=</span><span class="va">zeros</span>(<span class="fl">1</span><span class="op">,</span><span class="va">N</span>)<span class="op">;</span></span>
<span id="cb4-17"><a href="#cb4-17"></a></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="va">x</span>(<span class="fl">1</span>)<span class="op">=</span><span class="va">b</span>(<span class="fl">1</span>)<span class="op">/</span><span class="va">A</span>(<span class="fl">1</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb4-19"><a href="#cb4-19"></a></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="kw">for</span> <span class="va">n</span><span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span></span>
<span id="cb4-21"><a href="#cb4-21"></a>    <span class="va">S</span><span class="op">=</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb4-22"><a href="#cb4-22"></a>    <span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span></span>
<span id="cb4-23"><a href="#cb4-23"></a>        <span class="va">S</span><span class="op">=</span><span class="va">S</span><span class="op">+</span><span class="va">A</span>(<span class="va">n</span><span class="op">,</span><span class="va">i</span>)<span class="op">*</span><span class="va">x</span>(<span class="va">i</span>)<span class="op">;</span></span>
<span id="cb4-24"><a href="#cb4-24"></a>    <span class="kw">end</span></span>
<span id="cb4-25"><a href="#cb4-25"></a>    <span class="va">x</span>(<span class="va">n</span>)<span class="op">=</span>(<span class="va">b</span>(<span class="va">n</span>)<span class="op">-</span><span class="va">S</span>)<span class="op">/</span><span class="va">A</span>(<span class="va">n</span><span class="op">,</span><span class="va">n</span>)<span class="op">;</span></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="kw">end</span></span>
<span id="cb4-27"><a href="#cb4-27"></a></span>
<span id="cb4-28"><a href="#cb4-28"></a><span class="va">disp</span>(<span class="ss">'x='</span>)</span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="va">disp</span>(<span class="va">x</span>)</span>
<span id="cb4-30"><a href="#cb4-30"></a></span>
<span id="cb4-31"><a href="#cb4-31"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>TDMA</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">function</span> <span class="va">TDMA</span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="va">m</span><span class="op">=</span>[<span class="fl">2</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">2</span>]<span class="op">;</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="va">l</span><span class="op">=</span>[<span class="op">-</span><span class="fl">1</span><span class="op">,-</span><span class="fl">1</span><span class="op">,-</span><span class="fl">1</span><span class="op">,-</span><span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="va">r</span><span class="op">=</span>[<span class="op">-</span><span class="fl">1</span><span class="op">,-</span><span class="fl">1</span><span class="op">,-</span><span class="fl">1</span><span class="op">,-</span><span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="va">A</span><span class="op">=</span><span class="va">diag</span>(<span class="va">m</span>)<span class="op">+</span><span class="va">diag</span>(<span class="va">l</span><span class="op">,-</span><span class="fl">1</span>)<span class="op">+</span><span class="va">diag</span>(<span class="va">r</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="va">b</span><span class="op">=</span>[<span class="fl">1</span><span class="op">;</span><span class="fl">0</span><span class="op">;</span><span class="fl">1</span><span class="op">;</span><span class="fl">0</span><span class="op">;</span><span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="va">N</span><span class="op">=</span><span class="va">length</span>(<span class="va">b</span>)<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="va">R</span><span class="op">=</span><span class="va">zeros</span>(<span class="fl">1</span><span class="op">,</span><span class="va">N</span>)<span class="op">;</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="va">B</span><span class="op">=</span><span class="va">zeros</span>(<span class="fl">1</span><span class="op">,</span><span class="va">N</span>)<span class="op">;</span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="va">x</span><span class="op">=</span><span class="va">zeros</span>(<span class="fl">1</span><span class="op">,</span><span class="va">N</span>)<span class="op">;</span></span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="va">l</span><span class="op">=</span>[<span class="fl">0</span><span class="op">,</span><span class="va">l</span>]<span class="op">;</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="va">r</span><span class="op">=</span>[<span class="va">r</span><span class="op">,</span><span class="fl">0</span>]<span class="op">;</span></span>
<span id="cb5-18"><a href="#cb5-18"></a></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="va">R</span>(<span class="fl">1</span>)<span class="op">=</span><span class="va">r</span>(<span class="fl">1</span>)<span class="op">/</span><span class="va">m</span>(<span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="kw">for</span> <span class="va">n</span><span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span></span>
<span id="cb5-21"><a href="#cb5-21"></a>    <span class="va">R</span>(<span class="va">n</span>)<span class="op">=</span><span class="va">r</span>(<span class="va">n</span>)<span class="op">/</span>(<span class="va">m</span>(<span class="va">n</span>)<span class="op">-</span><span class="va">l</span>(<span class="va">n</span>)<span class="op">*</span><span class="va">R</span>(<span class="va">n</span><span class="op">-</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="kw">end</span></span>
<span id="cb5-23"><a href="#cb5-23"></a></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="va">B</span>(<span class="fl">1</span>)<span class="op">=</span><span class="va">b</span>(<span class="fl">1</span>)<span class="op">/</span><span class="va">m</span>(<span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="kw">for</span> <span class="va">n</span><span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span></span>
<span id="cb5-26"><a href="#cb5-26"></a>    <span class="va">B</span>(<span class="va">n</span>)<span class="op">=</span>(<span class="va">b</span>(<span class="va">n</span>)<span class="op">-</span><span class="va">l</span>(<span class="va">n</span>)<span class="op">*</span><span class="va">B</span>(<span class="va">n</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="va">m</span>(<span class="va">n</span>)<span class="op">-</span><span class="va">l</span>(<span class="va">n</span>)<span class="op">*</span><span class="va">R</span>(<span class="va">n</span><span class="op">-</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="kw">end</span></span>
<span id="cb5-28"><a href="#cb5-28"></a></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="va">x</span>(<span class="va">N</span>)<span class="op">=</span><span class="va">B</span>(<span class="va">N</span>)<span class="op">;</span></span>
<span id="cb5-30"><a href="#cb5-30"></a><span class="kw">for</span> <span class="va">n</span><span class="op">=</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">:-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span></span>
<span id="cb5-31"><a href="#cb5-31"></a>    <span class="va">x</span>(<span class="va">n</span>)<span class="op">=</span><span class="va">B</span>(<span class="va">n</span>)<span class="op">-</span><span class="va">R</span>(<span class="va">n</span>)<span class="op">*</span><span class="va">x</span>(<span class="va">n</span><span class="op">+</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb5-32"><a href="#cb5-32"></a><span class="kw">end</span></span>
<span id="cb5-33"><a href="#cb5-33"></a></span>
<span id="cb5-34"><a href="#cb5-34"></a><span class="va">disp</span>(<span class="ss">'x='</span>)</span>
<span id="cb5-35"><a href="#cb5-35"></a><span class="va">disp</span>(<span class="va">x</span>)</span>
<span id="cb5-36"><a href="#cb5-36"></a></span>
<span id="cb5-37"><a href="#cb5-37"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Cramer’s Rule</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">function</span> <span class="va">Cramer</span></span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="va">A</span><span class="op">=</span>[<span class="fl">1</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">2</span><span class="op">;</span><span class="fl">2</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="fl">2</span><span class="op">;-</span><span class="fl">1</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="va">b</span><span class="op">=</span>[<span class="fl">12</span><span class="op">;</span><span class="fl">0</span><span class="op">;</span><span class="fl">6</span>]<span class="op">;</span></span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="va">N</span><span class="op">=</span><span class="va">length</span>(<span class="va">b</span>)<span class="op">;</span></span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="va">d</span><span class="op">=</span><span class="va">det</span>(<span class="va">A</span>)<span class="op">;</span></span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="va">x</span><span class="op">=</span><span class="va">zeros</span>(<span class="va">N</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="kw">for</span> <span class="va">n</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>    <span class="va">AA</span><span class="op">=</span><span class="va">A</span><span class="op">;</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>    <span class="va">AA</span>(<span class="op">:,</span><span class="va">n</span>)<span class="op">=</span><span class="va">b</span><span class="op">;</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>    <span class="va">x</span>(<span class="va">n</span>)<span class="op">=</span><span class="va">det</span>(<span class="va">AA</span>)<span class="op">/</span><span class="va">d</span><span class="op">;</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="kw">end</span></span>
<span id="cb6-17"><a href="#cb6-17"></a></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="va">disp</span>(<span class="ss">'x='</span>)</span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="va">disp</span>(<span class="va">x</span>)</span>
<span id="cb6-20"><a href="#cb6-20"></a></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Note that <span class="math inline">\(A^{-1}\)</span> exists only if <span class="math inline">\(A\)</span> is non-singular, meaning that the condition number number only exists if <span class="math inline">\(A\)</span> is non-singular.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>A matrix <span class="math inline">\(A \in \mathbb{R}^{N \times N}\)</span> is <strong><em>Diagonally Dominant</em></strong> if every diagonal entry is larger in absolute value than the sum of the absolute value of all the other terms in that row. More formally <span class="math display">\[|a_{ii}|\geq \sum_{\substack{j=1 \\ j\neq i}}^{N}|a_{ij}| \quad \text{for all} \quad i=1,\dots,N.\]</span> The matrix is <strong><em>Strictly Diagonally Dominant</em></strong> if the inequality is strict.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./Part_LinAlg.html" class="pagination-link" aria-label="Linear Algebra">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Linear Algebra</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Part_IVPs.html" class="pagination-link" aria-label="Solving Initial Value Problems">
        <span class="nav-page-text">Solving Initial Value Problems</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>