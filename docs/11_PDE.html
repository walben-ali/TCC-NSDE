<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Numerical Solutions of Differential Equations – 11&nbsp; Heat Equation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Z_App_Basic.html" rel="next">
<link href="./Part_PDEs.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Part_PDEs.html">Solving Partial Differential Equations</a></li><li class="breadcrumb-item"><a href="./11_PDE.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Heat Equation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Numerical Solutions of Differential Equations</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.docx">
              <i class="bi bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Internal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Internal Workings of MATLAB</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_LinAlg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Algebra</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_LinAlg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Solving Linear Systems of Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_IVPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Initial Value Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_IVP_Euler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Euler Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_IVP_ModEuler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Modified Euler Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_IVP_RK4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fourth Order Runge-Kutta Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_IVP_InBuilt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">MATLAB’s In-Built Procedures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_IVP_Implicit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Implicit IVP Solvers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_BVPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Boundary Value Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_BVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Boundary Value Problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_MVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Mixed Value Problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_SBVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Symmetric Boundary Conditions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_PDEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Partial Differential Equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_PDE.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Heat Equation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">MATLAB Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Arrays.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Arrays in MATLAB</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Loops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Loops</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Plotting in MATLAB</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_ReadWrite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Reading &amp; Writing Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_GE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Gaussian Elimination Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_MatDeco.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Matrix Decompositions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_DataFit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Data Fitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Eigen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Eigenvalue Problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Z_App_Root.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Numerical Solutions of Non-Linear Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-method-of-lines-for-the-heat-equation" id="toc-the-method-of-lines-for-the-heat-equation" class="nav-link active" data-scroll-target="#the-method-of-lines-for-the-heat-equation"><span class="header-section-number">11.1</span> The Method of Lines for the Heat Equation</a></li>
  <li><a href="#linear-advection-equation" id="toc-linear-advection-equation" class="nav-link" data-scroll-target="#linear-advection-equation"><span class="header-section-number">11.2</span> Linear Advection Equation</a></li>
  <li><a href="#convection-diffusion-equation" id="toc-convection-diffusion-equation" class="nav-link" data-scroll-target="#convection-diffusion-equation"><span class="header-section-number">11.3</span> Convection-Diffusion Equation</a></li>
  <li><a href="#asymptotic-stability" id="toc-asymptotic-stability" class="nav-link" data-scroll-target="#asymptotic-stability"><span class="header-section-number">11.4</span> Asymptotic Stability</a>
  <ul class="collapse">
  <li><a href="#stability-of-the-euler-method-for-the-advection-equation" id="toc-stability-of-the-euler-method-for-the-advection-equation" class="nav-link" data-scroll-target="#stability-of-the-euler-method-for-the-advection-equation"><span class="header-section-number">11.4.1</span> Stability of the Euler Method for the Advection Equation</a></li>
  <li><a href="#stability-of-the-euler-method-for-the-heat-equation" id="toc-stability-of-the-euler-method-for-the-heat-equation" class="nav-link" data-scroll-target="#stability-of-the-euler-method-for-the-heat-equation"><span class="header-section-number">11.4.2</span> Stability of the Euler Method for the Heat Equation</a></li>
  </ul></li>
  <li><a href="#stability-of-the-convection-diffusion-equation" id="toc-stability-of-the-convection-diffusion-equation" class="nav-link" data-scroll-target="#stability-of-the-convection-diffusion-equation"><span class="header-section-number">11.5</span> Stability of the Convection-Diffusion Equation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Part_PDEs.html">Solving Partial Differential Equations</a></li><li class="breadcrumb-item"><a href="./11_PDE.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Heat Equation</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Heat Equation</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p>Ordinary differential equations have been the main focus of this course so far but this will now be extended to <em>partial differential equations</em>. The differential equations that will be studied here are the <em>1-Dimensional Heat (or Diffusion) Equation</em> and the <em>1-Dimensional Advection (or Convection) Equation</em>.</p>
<p>The 1-dimensional <em>heat</em> (or <em>diffusion</em>) <em>equation</em> is a partial differential equation that represents the heat transfer across a rod and is given by <span class="math display">\[\frac{\partial u}{\partial t}=\alpha \frac{\partial^{2} u}{\partial x^{2}} \quad \text{with} \quad 0&lt;x&lt;L \quad \text{and} \quad t&gt;0\]</span> where <span class="math inline">\(u=u(x,t)\)</span> is the temperature at location <span class="math inline">\(x\)</span> at time <span class="math inline">\(t\)</span> and <span class="math inline">\(\alpha\)</span> is the thermal diffusivity<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. This equation represents the flow of heat along the length of a rod of length <span class="math inline">\(L\)</span>.</p>
<p>This partial differential equation has three derivatives in total, two derivatives in <span class="math inline">\(x\)</span> and one derivative in <span class="math inline">\(t\)</span>, this means that three conditions are needed, two on <span class="math inline">\(x\)</span> and one on <span class="math inline">\(t\)</span>:</p>
<ul>
<li><span class="math inline">\(u(x,0)=u_{init}(x)\)</span> for <span class="math inline">\(x \in [0,L]\)</span>: Initial heat distribution across the rod;</li>
<li><span class="math inline">\(u(0,t)=u_l(t)\)</span> for <span class="math inline">\(t&gt;0\)</span>: The temperature at the left end of the rod;</li>
<li><span class="math inline">\(u(L,t)=u_r(t)\)</span> for <span class="math inline">\(t&gt;0\)</span>: The temperature at the right end of the rod.</li>
</ul>
<p>This set of conditions along with the differential equation are known collectively as an <strong><em>Initial-Boundary Value Problem</em></strong> and can be solved using the <strong><em>Method of Lines</em></strong>.</p>
<section id="the-method-of-lines-for-the-heat-equation" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="the-method-of-lines-for-the-heat-equation"><span class="header-section-number">11.1</span> The Method of Lines for the Heat Equation</h2>
<p>The outline of the method of lines for the heat equation is as follows:</p>
<ol type="1">
<li>Divide the spatial interval <span class="math inline">\([0,L]\)</span> into <span class="math inline">\(N_x\)</span> equally sized sections and label the points as <span class="math inline">\(x_0, x_1, x_2, \dots, x_{N_x}\)</span> where <span class="math inline">\(x_n=nh_x\)</span> and the spatial interval width is <span class="math inline">\(h_x=\frac{L}{N_x}\)</span>.</li>
</ol>
<p><img src="figures/Disc.jpg" class="img-fluid"></p>
<ol start="2" type="1">
<li><p><strong>Left Hand Side</strong>: For each point <span class="math inline">\(x_n\)</span>, define the approximation <span class="math inline">\(U_n(t) \approx u(x_n,t)\)</span>. Therefore the left hand side of the heat equation can be written as <span class="math display">\[\frac{\partial u}{\partial t}(x_n,t) \approx \frac{\mathrm{d} U_n}{\mathrm{d} t}(t)\]</span> and this holds for <span class="math inline">\(n=1, 2, \dots, N_x-1\)</span> since <span class="math inline">\(U_0(t) \approx u(0,t)=u_l(t)\)</span> and <span class="math inline">\(U_N(t) \approx u(L,t)=u_r(t)\)</span> are already known from the boundary conditions. Notice that the derivative of <span class="math inline">\(U_n\)</span> is an ordinary derivative since <span class="math inline">\(U_n\)</span> is a function of <span class="math inline">\(t\)</span> only.</p></li>
<li><p><strong>Right Hand Side</strong>: Use the finite difference approximation to approximate the <em>spatial</em> derivative in the differential equation. Here, the centred difference approximation for the second derivative will be used, namely <span class="math display">\[\frac{\partial^{2} u}{\partial x^{2}}(x_n,t) \approx \frac{U_{n+1}(t)-2U_{n}(t)+U_{n-1}(t)}{h_x^2}.\]</span> Therefore the right hand side of the heat equation will become <span class="math display">\[\alpha \frac{\partial^{2} u}{\partial x^{2}}(x_n,t) \approx \frac{\alpha}{h_x^2}\left[ U_{n-1}(t)-2U_n(t)+U_{n+1}(t) \right].\]</span> This holds for <span class="math inline">\(n=1, 2, \dots, N_x-1\)</span> bearing in mind, once again, that <span class="math inline">\(U_0(t) \approx u(0,t)=u_l(t)\)</span> and <span class="math inline">\(U_{N_x}(t) \approx u(L,t)=u_r(t)\)</span> are known beforehand.</p></li>
<li><p>These can be combined to give the discretised form of the heat equation <span class="math display">\[\frac{\mathrm{d} U_n}{\mathrm{d} t}=\frac{\alpha}{h_x^2}\left[ U_{n-1}-2U_n+U_{n+1} \right]\]</span> for all <span class="math inline">\(n=1,2,\dots,N_x-1\)</span> where <span class="math inline">\(U_n=U_n(t)\)</span>. This means that the partial differential equation has been split into <span class="math inline">\(N_x-1\)</span> ordinary differential equations.</p></li>
<li><p>This entire system of <span class="math inline">\(N_x-1\)</span> equations can now be written in matrix form as <span class="math inline">\(\frac{\mathrm{d} \boldsymbol{U}}{\mathrm{d} t}=A\boldsymbol{U}+\boldsymbol{b}\)</span> where <span class="math display">\[\begin{multline*}
\frac{\mathrm{d} }{\mathrm{d} t}\underbrace{\begin{pmatrix}
U_1(t) \\
U_2(t) \\
U_3(t) \\
\vdots \\
U_{N_x-3}(t) \\
U_{N_x-2}(t) \\
U_{N_x-1}(t) \\
\end{pmatrix}}_{\boldsymbol{U}}=
\underbrace{\frac{\alpha}{h_x^2}\begin{pmatrix}
-2 &amp; 1 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; -2 &amp; 1 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; -2 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; \dots &amp; -2 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \dots &amp; 1 &amp; -2 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 1 &amp; -2 \\
\end{pmatrix}}_{A}
\underbrace{\begin{pmatrix}
U_1(t) \\
U_2(t) \\
U_3(t) \\
\vdots \\
U_{N_x-3}(t) \\
U_{N_x-2}(t) \\
U_{N_x-1}(t) \\
\end{pmatrix}}_{\boldsymbol{U}} \\
+\underbrace{\frac{\alpha}{h_x^2}\begin{pmatrix}
u_l(t) \\
0 \\
0 \\
\vdots \\
0 \\
0 \\
u_r(t) \\
\end{pmatrix}}_{\boldsymbol{b}}
\end{multline*}\]</span> subject to the <em>initial condition</em> <span class="math display">\[
\boldsymbol{U}_0=\begin{pmatrix}
U_1(0) \\ U_2(0) \\ U_3(0) \\ \vdots \\ U_{N_x-3}(0) \\ U_{N_x-2}(0) \\ U_{N_x-1}(0)
\end{pmatrix}\approx\begin{pmatrix}
u(x_1,0) \\ u(x_2,0) \\ u(x_3,0) \\ \vdots \\ u(x_{N_x-3},0) \\ u(x_{N_x-2},0) \\ u(x_{N_x-1},0)
\end{pmatrix} =\begin{pmatrix}
u_{init}(x_1) \\
u_{init}(x_2) \\
u_{init}(x_3) \\
\vdots \\
u_{init}(x_{N_x-3}) \\
u_{init}(x_{N_x-2}) \\
u_{init}(x_{N_x-1}) \\
\end{pmatrix}.
\]</span> This system can now be solved using any of the IVP solvers with a temporal stepsize <span class="math inline">\(h_t\)</span>.</p></li>
</ol>
<p>In essence, the <em>Method of Lines</em> has converted a PDE into a set of ODEs using the same techniques as BVPs and will be solved in the same way as IVPs.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Heat Equation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider an iron rod (of thermal diffusivity <span class="math inline">\(\alpha=2.3\times 10^{-5}\)</span>) of length 1 where the middle section of length 0.2 has been heated to a temperature of 1 while the rest is at 0. The ends of the rod have been kept at a constant temperature of 2. This system can be represented by the IBVP <span class="math display">\[\frac{\partial u}{\partial t}=\alpha\frac{\partial^{2} u}{\partial t^{2}}, \quad x \in [0,1], \quad t&gt;0\]</span> <span class="math display">\[u(x,0)=u_{init}(x)=\left\{
\begin{matrix}
        0 &amp; 0 \leq x&lt;0.4 \\
        1 &amp; 0.4 \leq x &lt;0.6 \\
        0 &amp; 0.6 \leq x \leq 1 \\
\end{matrix} \right. ,\]</span> <span class="math display">\[u(0,t)=u_l(t)=2, \quad u(L,t)=u_r(t)=2.\]</span></p>
<p>First, divide the interval <span class="math inline">\([0,1]\)</span> into five equal sections (which will be of width <span class="math inline">\(h_x=\frac{1-0}{5}=0.2\)</span>). <img src="figures/Disc02.jpg" class="img-fluid"></p>
<p>This system can be discretised using the centred difference method and written in matrix form as <span class="math inline">\(\frac{\mathrm{d} \boldsymbol{U}}{\mathrm{d} t}=A\boldsymbol{U}+\boldsymbol{b}\)</span> where <span class="math display">\[
    \frac{\mathrm{d} }{\mathrm{d} t}\underbrace{\begin{pmatrix}
        U_1(t) \\
        U_2(t) \\
        U_3(t) \\
        U_4(t) \\
        U_5(t)
    \end{pmatrix}}_{\boldsymbol{U}}=
    \underbrace{\frac{\alpha}{h^2}\begin{pmatrix}
        -2 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
        1 &amp; -2 &amp; 1 &amp; 0 &amp; 0 \\
        0 &amp; 1 &amp; -2 &amp; 1 &amp; 0 \\
        0 &amp; 0 &amp; 1 &amp; -2 &amp; 1 \\
        0 &amp; 0 &amp; 0 &amp; 1 &amp; -2
    \end{pmatrix}}_{A}
    \underbrace{\begin{pmatrix}
        U_1(t) \\
        U_2(t) \\
        U_3(t) \\
        U_4(t) \\
        U_5(t) \\
    \end{pmatrix}}_{\boldsymbol{U}}+
    \underbrace{\frac{\alpha}{h^2}\begin{pmatrix}
        u_l(t) \\
        0 \\
        0 \\
        0 \\
        u_r(t) \\
    \end{pmatrix}}_{\boldsymbol{b}}
\]</span> The differential equation <span class="math display">\[\frac{\mathrm{d} \boldsymbol{U}}{\mathrm{d} t}=A\boldsymbol{U}+\boldsymbol{b}\]</span> can be solved using the Euler method with the initial condition <span class="math display">\[
    \boldsymbol{U}(0)=\begin{pmatrix}
        u_{init}(x_1) \\
        u_{init}(x_2) \\
        u_{init}(x_3) \\
        u_{init}(x_4) \\
        u_{init}(x_5) \\
    \end{pmatrix}
\]</span> subject to a time stepsize <span class="math inline">\(h_t\)</span>. Below are the plots of the heat distribution at <span class="math inline">\(t=0, 100, 1000\)</span> for <span class="math inline">\(N_x=500\)</span> (<span class="math inline">\(h_x=0.002\)</span>) and <span class="math inline">\(h_t=0.02\)</span> (<span class="math inline">\(N_t=50000\)</span>). <img src="figures/Heat1.jpg" class="img-fluid"> <img src="figures/Heat2.jpg" class="img-fluid"> <img src="figures/Heat3.jpg" class="img-fluid"> At the beginning, the temperature at the ends is 2 and the middle section is at a temperature of 1. As time progresses, the heat evens out across the iron bar until eventually, the whole bar will be the same temperature.</p>
</div>
</div>
</section>
<section id="linear-advection-equation" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="linear-advection-equation"><span class="header-section-number">11.2</span> Linear Advection Equation</h2>
<p>The heat equation deals with heat transfer through diffusion throughout a material. Another way in which heat transfer can be achieved by advection (or convection) and this is given by <span class="math display">\[\frac{\partial u}{\partial t}=-v \frac{\partial u}{\partial x} \quad \text{with} \quad 0&lt;x&lt;L \quad \text{and} \quad t&gt;0\]</span> where <span class="math inline">\(u=u(x,t)\)</span> is the temperature at location <span class="math inline">\(x\)</span> at time <span class="math inline">\(t\)</span> and <span class="math inline">\(v\)</span> is the flow speed.</p>
<p>This partial differential equation has two derivatives in total, one in <span class="math inline">\(x\)</span> and one in <span class="math inline">\(t\)</span>, this means that two conditions are needed, one spatial and one temporal:</p>
<ul>
<li><span class="math inline">\(u(x,0)=u_{init}(x)\)</span> for <span class="math inline">\(x \in [0,L]\)</span>: Initial heat distribution across the rod;</li>
<li><span class="math inline">\(u(0,t)=u_l(t)\)</span> for <span class="math inline">\(t&gt;0\)</span>: The temperature at the left end of the rod.</li>
</ul>
<p>Consider the PDE along with the initial condition only, namely <span class="math inline">\(u(x,0)=u_{init}(x)\)</span> for <span class="math inline">\(x \in [0,L]\)</span>. The exact solution to this differential equation is given by <span class="math display">\[u(x,t)=u_{init}(x-vt),\]</span> this can be verified from the partial differential equation as follows: <span class="math display">\[\frac{\partial u}{\partial t}=-v \frac{\partial u}{\partial x} \quad \text{at} \quad u(x,t)=u_{init}(x-vt)\]</span> <span class="math display">\[\begin{align*}
    &amp;\text{LHS}=\frac{\partial }{\partial t}u(x,t)=\frac{\partial }{\partial t}\left( u_{init}(x-vt) \right)=-vu_{init}'(x-vt)\\
    &amp;\text{RHS}=\frac{\partial }{\partial x}u(x,t)=\frac{\partial }{\partial x}\left( u_{init}(x-vt) \right)=-vu_{init}'(x-vt).
\end{align*}\]</span> This means that if the initial heat profile takes the form of <span class="math inline">\(u_{init}(x)\)</span>, then after time <span class="math inline">\(t\)</span>, the profile will look exactly the same but shifted to the right by a distance <span class="math inline">\(vt\)</span>.</p>
<p><img src="figures/Advection.jpg" class="img-fluid"></p>
<p>The “information” moves from left to right so if the finite differences are to be used, the centred differencing approach would not be suitable since the information on the right is not known yet. Therefore the backwards differencing approximation will be the most suitable. This is known as an <em>upwind/upstream scheme</em> (i.e.&nbsp;against the direction of the wind/stream) if <span class="math inline">\(v&gt;0\)</span>. Therefore using the convention <span class="math inline">\(U_n(t) \approx u(x_n,t)\)</span> where <span class="math inline">\(x=x_n\)</span> is the discretisation of the spatial points for <span class="math inline">\(n=0,1,2,\dots,N_x\)</span>, the backward differencing approximation to the spatial derivative is <span class="math display">\[\frac{\partial u}{\partial x}(x_n,t) \approx \frac{\partial U_n}{\partial x}=\frac{U_n-U_{n-1}}{h_x}.\]</span> Therefore is discretised advection equation is <span class="math display">\[\frac{\mathrm{d} U_n}{\mathrm{d} t}= \frac{v}{h_x}\left( U_{n-1}-U_n \right) \quad \text{for} \quad n=1,2,\dots,N_x\]</span> and this can be solved subject to the initial condition <span class="math display">\[u(x,0)=u_{init}(x)\]</span> and boundary condition <span class="math display">\[u(0,t)=u_{l}(t)\]</span> to give the discretised set of equations in the form <span class="math inline">\(\frac{\mathrm{d} \boldsymbol{U}}{\mathrm{d} t}=A\boldsymbol{U}+\boldsymbol{b}\)</span> where <span class="math display">\[\begin{multline*}
     \frac{\mathrm{d} }{\mathrm{d} t}\underbrace{\begin{pmatrix}
        U_1(t) \\
        U_2(t) \\
        U_3(t) \\
        \vdots \\
        U_{N_x-2}(t) \\
        U_{N_x-1}(t) \\
        U_{N_x}(t)
    \end{pmatrix}}_{\boldsymbol{U}}=
    \underbrace{\frac{v}{h_x}\begin{pmatrix}
        -1 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
        1 &amp; -1 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
        0 &amp; 1 &amp; -1 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
        \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\
        0 &amp; 0 &amp; 0 &amp; \dots &amp; -1 &amp; 0 &amp; 0 \\
        0 &amp; 0 &amp; 0 &amp; \dots &amp; 1 &amp; -1 &amp; 0 \\
        0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 1 &amp; -1 \\
    \end{pmatrix}}_{A}
    \underbrace{\begin{pmatrix}
        U_1(t) \\
        U_2(t) \\
        U_3(t) \\
        \vdots \\
        U_{N_x-2}(t) \\
        U_{N_x-1}(t) \\
        U_{N_x}(t)
    \end{pmatrix}}_{\boldsymbol{U}}\\+
    \underbrace{\frac{v}{h_x}\begin{pmatrix}
        u_l(t) \\
        0 \\
        0 \\
        \vdots \\
        0 \\
        0 \\
        0 \\
    \end{pmatrix}}_{\boldsymbol{b}}
\end{multline*}\]</span> and the initial condition is <span class="math display">\[
\boldsymbol{U}_0=\begin{pmatrix}
    U_1(0) \\ U_2(0) \\ U_3(0) \\ \vdots \\ U_{N_x-2}(0) \\ U_{N_x-1}(0) \\ U_{N_x}(0)
\end{pmatrix}\approx\begin{pmatrix}
    u(x_1,0) \\ u(x_2,0) \\ u(x_3,0) \\ \vdots \\ u(x_{N_x-2},0) \\ u(x_{N_x-1},0) \\ u(x_{N_x},0)
\end{pmatrix} =\begin{pmatrix}
    u_{init}(x_1) \\
    u_{init}(x_2) \\
    u_{init}(x_3) \\
    \vdots \\
    u_{init}(x_{N_x-2}) \\
    u_{init}(x_{N_x-1}) \\
    u_{init}(x_{N_x}) \\
\end{pmatrix}
\]</span>.</p>
</section>
<section id="convection-diffusion-equation" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="convection-diffusion-equation"><span class="header-section-number">11.3</span> Convection-Diffusion Equation</h2>
<p>The heat (or diffusion) equation dictates the spread of heat across a length of material while on the other hand, the advection (or convection) equation dictates the flow of heat in a certain direction. The combination of these two effects gives rise to the <strong><em>Convection-Diffusion Equation</em></strong> which takes the form <span class="math display">\[\frac{\partial u}{\partial t}=\alpha \frac{\partial^{2} u}{\partial x^{2}}-v \frac{\partial u}{\partial x} \quad \text{with} \quad 0&lt;x&lt;L, \quad t&gt;0.\]</span></p>
<p>Just as in the heat equation, this partial differential equation has three derivatives in total, two derivatives in <span class="math inline">\(x\)</span> and one derivative in <span class="math inline">\(t\)</span>, this means that three conditions are needed, two on <span class="math inline">\(x\)</span> and one on <span class="math inline">\(t\)</span>, these will be as follows:</p>
<ul>
<li><span class="math inline">\(u(x,0)=u_{init}(x)\)</span> for <span class="math inline">\(x \in [0,L]\)</span>: Initial heat distribution across the rod;</li>
<li><span class="math inline">\(u(0,t)=u_l(t)\)</span> for <span class="math inline">\(t&gt;0\)</span>: The temperature at the left end of the rod;</li>
<li><span class="math inline">\(u(L,t)=u_r(t)\)</span> for <span class="math inline">\(t&gt;0\)</span>: The temperature at the right end of the rod.</li>
</ul>
<p>In order to discretise this system, a finite difference approximation needs to be chosen first. The centred difference approximation was used for the heat equation and the backwards difference approximation for the advection. Here, the combination of both will be used. Even though this might initially seem like an inconsistency, but in fact, this will allow the system to present a distinct stable advantage as will be seen in the next section.</p>
<p>This system can be discretised in exactly the same way as before, so for <span class="math inline">\(n=1,2,\dots,N_x-1\)</span>, <span class="math display">\[\frac{\mathrm{d} U_n}{\mathrm{d} t}(t)= \frac{\alpha}{h_x^2}\left[ U_{n-1}(t)-2U_n(t)+U_{n+1}(t) \right]-\frac{v}{h_x}\left[U_n(t)+U_{n-1}(t) \right].\]</span> This system can be written in the form <span class="math inline">\(\frac{\mathrm{d} \boldsymbol{U}}{\mathrm{d} t}=A\boldsymbol{U}+\boldsymbol{b}\)</span> where <span class="math display">\[\begin{multline}
A=\frac{\alpha}{h_x^2}\begin{pmatrix}
    -2 &amp; 1 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    1 &amp; -2 &amp; 1 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 1 &amp; -2 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; -2 &amp; 1 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; 1 &amp; -2 &amp; 1 \\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 1 &amp; -2 \\
\end{pmatrix} \\ +\frac{v}{h_x}\begin{pmatrix}
    -1 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    1 &amp; -1 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 1 &amp; -1 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; -1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; 1 &amp; -1 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 1 &amp; -1 \\
\end{pmatrix},
\end{multline}\]</span> <span class="math display">\[
\boldsymbol{U}=\begin{pmatrix}
    U_1(t) \\
    U_2(t) \\
    \vdots \\
    U_{N-2}(t) \\
    U_{N-1}(t) \\
\end{pmatrix}, \quad \boldsymbol{b}=\frac{\alpha}{h_x^2}\begin{pmatrix}
    u_l(t) \\
    0 \\
    \vdots \\
    0 \\
    u_r(t) \\
\end{pmatrix}+\frac{v}{h_x}\begin{pmatrix}
    u_l(t) \\
    0 \\
    \vdots \\
    0 \\
    0 \\
\end{pmatrix}.
\]</span> and this system can be solved using an Euler iteration subject to the initial condition <span class="math inline">\(u(x,0)=u_{init}(x)\)</span>.</p>
</section>
<section id="asymptotic-stability" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="asymptotic-stability"><span class="header-section-number">11.4</span> Asymptotic Stability</h2>
<p>The method of lines is essentially a hybrid method that makes use of a combination between a finite difference approximation and the Euler method and is very effective at solving partial differential equations, as seen from solving the heat, advection and convection-diffusion equations. The derivation of the method of lines for the different methods builds on the very same principle and the codes can be adapted quite easily. One main issue that arises here is the choice for the stepsizes for both the spatial and temporal discretisations, i.e.&nbsp;the choice of <span class="math inline">\(h_t\)</span> and <span class="math inline">\(h_x\)</span> respectively. When both methods are combined, there needs to be a restriction on both stepsizes.</p>
<p>The first issue that needs to be addressed is the asymptotic stability of the heat equation and the advection equation. For arbitrarily large matrices, it may not be simple to determine if all the eigenvalues are negative since it may be computationally restrictive to do so. However, a result can be used to see if all the eigenvalues are negative without explicitly calculating them.</p>
<div id="thm-Gersh" class="theorem">
<p><span class="theorem-title"><strong>Theorem 11.1 (Gershgorin Circle Theorem)</strong></span> Let <span class="math inline">\(A\)</span> be an <span class="math inline">\(N \times N\)</span> given by <span class="math display">\[
A=\begin{pmatrix}
    a_{11} &amp; a_{12} &amp; a_{13} &amp; \dots  &amp; a_{1N} \\
    a_{21} &amp; a_{22} &amp; a_{23} &amp; \dots  &amp; a_{2N} \\
    a_{31} &amp; a_{32} &amp; a_{33} &amp; \dots  &amp; a_{3N} \\
    \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
    a_{N1} &amp; a_{N2} &amp; a_{N3} &amp; \dots  &amp; a_{NN}
\end{pmatrix}.
\]</span> On the complex plane, consider <span class="math inline">\(N\)</span> closed discs, each centred at the locations <span class="math inline">\(a_{ii}\)</span> for <span class="math inline">\(i=1,2,\dots,n\)</span> (the diagonal terms) where the disc centred at <span class="math inline">\(a_{ii}\)</span> has a radius <span class="math inline">\(R_i\)</span> where <span class="math display">\[R_i=\sum_{j \neq i}{|a_{ij}|}.\]</span> Then all the eigenvalues of the matrix <span class="math inline">\(A\)</span> will have to lie in at least one of these discs. In other words, every eigenvalues of <span class="math inline">\(A\)</span> satisfies <span class="math display">\[|\lambda-a_{ii}| \leq R_i \quad \text{for at least one } \quad i=1,2,\dots,n.\]</span></p>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Gershgorin Circle Theorem Exapmple
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the matrix <span class="math display">\[
A=\begin{pmatrix}
    -1 &amp; 3 &amp; 4 &amp; 2 &amp; -4 \\
    0 &amp; 5 &amp; 4 &amp; 7 &amp; 1 \\
    4 &amp; -2 &amp; 0 &amp; -3 &amp; 0 \\
    6 &amp; -6 &amp; -4 &amp; -6 &amp; -1 \\
    7 &amp; 4 &amp; 7 &amp; 9 &amp; 7
\end{pmatrix}.
\]</span> Following the steps of the theorem:</p>
<ol type="1">
<li><p>Indicate the locations of the diagonal terms (namely <span class="math inline">\(-1, 5, 0, -6, 7\)</span>) on the complex plane.</p></li>
<li><p>Find the radii <span class="math inline">\(R_i\)</span> which are equal to the row sum of the absolute terms <em>without</em> the diagonal terms, in other words, <span class="math display">\[
\text{abs}(A)=\begin{pmatrix}
1 &amp; 3 &amp; 4 &amp; 2 &amp; 4 \\
0 &amp; 5 &amp; 4 &amp; 7 &amp; 1 \\
4 &amp; 2 &amp; 0 &amp; 3 &amp; 0 \\
6 &amp; 6 &amp; 4 &amp; 6 &amp; 1 \\
7 &amp; 4 &amp; 7 &amp; 9 &amp; 7
\end{pmatrix}
\begin{matrix}
\rightarrow \\ \rightarrow \\ \rightarrow \\ \rightarrow \\ \rightarrow
\end{matrix}
\begin{matrix}
3+4+2+4 \\ 0+4+7+1 \\ 4+2+3+0 \\ 6+6+4+1 \\ 7+4+7+9
\end{matrix}
\begin{matrix}
=13 \\ =12 \\ =9 \\ =17 \\ =27
\end{matrix}
\begin{matrix}
\rightarrow R_1 \\ \rightarrow R_2 \\ \rightarrow R_3 \\ \rightarrow R_4 \\ \rightarrow R_5
\end{matrix}
\]</span></p></li>
<li><p>Draw a circle around <span class="math inline">\(a_{11}=-1\)</span> with radius <span class="math inline">\(R_1=13\)</span>, a circle around <span class="math inline">\(a_{22}=5\)</span> with radius <span class="math inline">\(R_2=12\)</span> and so on.</p></li>
<li><p>All the eigenvalues of the matrix <span class="math inline">\(A\)</span> must lie in at least one of the circles indicated. Indeed, the following figure shows the diagonal terms each with circles around them with the appropriate radius. The eigenvalues are given in red and the blue circles are those which contain all said eigenvalues. <img src="figures/Ger.jpg" class="img-fluid"></p></li>
</ol>
</div>
</div>
<section id="stability-of-the-euler-method-for-the-advection-equation" class="level3" data-number="11.4.1">
<h3 data-number="11.4.1" class="anchored" data-anchor-id="stability-of-the-euler-method-for-the-advection-equation"><span class="header-section-number">11.4.1</span> Stability of the Euler Method for the Advection Equation</h3>
<p>Consider the matrix <span class="math inline">\(A_2\)</span> of size <span class="math inline">\(N \times N\)</span> from the advection equation <span class="math display">\[
A_2=\begin{pmatrix}
    -1 &amp; 0 &amp; \dots &amp; 0 &amp; 0 \\
    1 &amp; -1 &amp; \dots &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
    0 &amp; 0 &amp; \dots &amp; -1 &amp; 0 \\
    0 &amp; 0 &amp; \dots &amp; 1 &amp; -1 \\
\end{pmatrix}.
\]</span> Following the steps of the Gershgorin theorem, the centres of all the circles on the complex plane will be located at the diagonal terms, all of which are <span class="math inline">\(-1\)</span>. The radii of these circles are the row sums of the matrix <span class="math inline">\(A_2\)</span> without the diagonal terms, which means that all the radii will be 1. The figure below shows the circle that results on the complex plane. Therefore regardless of what the eigenvalues might be, it is known that they will always have negative real parts and therefore the advection matrix forms an asymptotically stable system. <img src="figures/Ger_Ad.jpg" class="img-fluid"></p>
<p>Since the advection equation is asymptotically stable, a bound for the temporal stepsize needs to be found. Consider the advection equation after the discretisation <span class="math inline">\(\frac{\mathrm{d} \boldsymbol{U}}{\mathrm{d} t}=A\boldsymbol{U}+\boldsymbol{b}\)</span> where <span class="math inline">\(A=\frac{v}{h_x}A_2\)</span>. The Euler method is numerically stable if the time step <span class="math inline">\(h_t\)</span> satisfies <span class="math display">\[\left\| \mathcal{I}+h_t A \right\|_{\infty} \leq 1.\]</span> First calculate <span class="math inline">\(\mathcal{I}+h_t A\)</span>: <span class="math display">\[
\mathcal{I}+h_t A=\mathcal{I}+\frac{vh_t}{h_x}A_2=
\begin{pmatrix}
    1-\tilde{v} &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \tilde{v} &amp; 1-\tilde{v} &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; \tilde{v} &amp; 1-\tilde{v} &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; 0&amp;  \tilde{v} &amp; 1-\tilde{v}
\end{pmatrix}.
\]</span> where <span class="math inline">\(\tilde{v}=\frac{vh_t}{h_x}\)</span>. Now taking the absolute value of all the terms and taking the row sums gives: <span class="math display">\[
\mathrm{abs}\left( \mathcal{I}+\frac{vh_t}{h_x}A_2 \right)=
\begin{pmatrix}
    |1-\tilde{v}| &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \tilde{v} &amp; |1-\tilde{v}| &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; \tilde{v} &amp; |1-\tilde{v}| &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; 0&amp;  \tilde{v} &amp; |1-\tilde{v}|
\end{pmatrix}\begin{matrix}
\to \\ \to \\ \to \\ \vdots \\ \to
\end{matrix}\begin{matrix}
|1-\tilde{v}| \\ \tilde{v}+|1-\tilde{v}| \\ \tilde{v}+|1-\tilde{v}| \\ \vdots \\ \tilde{v}+|1-\tilde{v}|
\end{matrix}.
\]</span> The row sums of the absolute terms of this matrix are <span class="math display">\[a=|1-\tilde{v}| \quad \text{and} \quad b=|1-\tilde{v}|+\tilde{v}.\]</span> Since it is assumed that <span class="math inline">\(v&gt;0\)</span>, then <span class="math inline">\(b&gt;a\)</span> therefore, <span class="math inline">\(\left\| \mathcal{I}+h_tA \right\|_{\infty}=b=|1-\tilde{v}|+\tilde{v}\)</span>. Consider the two cases when <span class="math inline">\(1-\tilde{v}&gt;0\)</span> and <span class="math inline">\(1-\tilde{v}&lt;0.\)</span></p>
<ol type="1">
<li><p>If <span class="math inline">\(1-\tilde{v}&gt;0\)</span>, then <span class="math inline">\(0&lt;\tilde{v}&lt;1\)</span>: <span class="math display">\[\left\| \mathcal{I}+h_tA \right\|_{\infty}=|1-\tilde{v}|+\tilde{v}=1-\tilde{v}+\tilde{v}=1.\]</span> Therefore if <span class="math inline">\(1-\tilde{v}&gt;0\)</span>, then <span class="math inline">\(\left\| \mathcal{I}+h_tA \right\|_{\infty}\leq 1\)</span>.</p></li>
<li><p>If <span class="math inline">\(1-\tilde{v}&lt;0\)</span>, then <span class="math inline">\(\tilde{v}&gt;1\)</span>: <span class="math display">\[\left\| \mathcal{I}+h_tA \right\|_{\infty}=|1-\tilde{v}|+\tilde{v}=\tilde{v}-1+\tilde{v}=2\tilde{v}-1,\]</span> therefore in this case, if <span class="math inline">\(\left\| \mathcal{I}+h_tA \right\|_{\infty}\)</span> needs to be less than or equal to <span class="math inline">\(1\)</span>, then <span class="math display">\[\left\| \mathcal{I}+h_tA \right\|_{\infty}\leq 1 \quad \implies \quad 2\tilde{v}-1\leq 1 \quad \implies \quad\tilde{v} \leq 1\]</span> which contradicts with the assumption that <span class="math inline">\(\tilde{v}&gt;1\)</span>.</p></li>
</ol>
<p>Therefore, the Euler method will produce a convergent solution if <span class="math display">\[\tilde{v} &lt; 1 \quad \implies \quad v\frac{h_t}{h_x}&lt;1.\]</span> In terms of number of spatial and temporal points <span class="math inline">\(N_x\)</span> and <span class="math inline">\(N_t\)</span> respectively, this restriction would be <span class="math display">\[v \frac{t_f-t_0}{L-x_0} \frac{N_x}{N_t} &lt; 1\]</span> So for a fixed velocity <span class="math inline">\(v\)</span>, if the time step <span class="math inline">\(h_t\)</span> is to be halved, then the spatial step would also need to be halved as well.</p>
</section>
<section id="stability-of-the-euler-method-for-the-heat-equation" class="level3" data-number="11.4.2">
<h3 data-number="11.4.2" class="anchored" data-anchor-id="stability-of-the-euler-method-for-the-heat-equation"><span class="header-section-number">11.4.2</span> Stability of the Euler Method for the Heat Equation</h3>
<p>Consider the matrix <span class="math inline">\(A_1\)</span> of size <span class="math inline">\(N \times N\)</span> from the heat equation <span class="math display">\[
A_1=\begin{pmatrix}
    -2 &amp; 1 &amp; \dots &amp; 0 &amp; 0 \\
    1 &amp; -2 &amp; \dots &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
    0 &amp; 0 &amp; \dots &amp; -2 &amp; 1 \\
    0 &amp; 0 &amp; \dots &amp; 1 &amp; -2 \\
\end{pmatrix}.
\]</span> The steps of the Gershgorin theorem can be followed to produce the following figure on the complex plane. <img src="figures/Ger_Heat.jpg" class="img-fluid"> Once again, this shows that all the eigenvalues will have negative real parts even though their explicit values are not known.</p>
<p>To determine the bound on the stepsize, consider the heat equation after the discretisation, which is <span class="math inline">\(\frac{\mathrm{d} \boldsymbol{U}}{\mathrm{d} t}=A\boldsymbol{U}+\boldsymbol{b}\)</span> where <span class="math inline">\(A=\frac{\alpha}{h_x^2}A_1\)</span>. The Euler method is numerically stable if the time step <span class="math inline">\(h_t\)</span> satisfies <span class="math display">\[\left\| \mathcal{I}+h_t A \right\|_{\infty} \leq 1.\]</span> First calculate <span class="math inline">\(\mathcal{I}+h_t A\)</span>: <span class="math display">\[
\mathcal{I}+h_t A=\mathcal{I}+\frac{\alpha h_t}{h_x^2}A_1=
\begin{pmatrix}
    1-2\tilde{\alpha} &amp; \tilde{\alpha} &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \tilde{\alpha} &amp; 1-2\tilde{\alpha} &amp; \tilde{\alpha} &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; \tilde{\alpha} &amp; 1-2\tilde{\alpha} &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; 0&amp;  \tilde{\alpha} &amp; 1-2\tilde{\alpha}
\end{pmatrix}
\]</span> where <span class="math inline">\(\tilde{\alpha}=\frac{\alpha h_t}{h_x^2}\)</span>. Now taking the absolute value of all the terms and taking the row sums gives: <span class="math display">\[
\mathrm{abs}\left( \mathcal{I}+\frac{\alpha h_t}{h_x^2}A_1 \right)=
\begin{pmatrix}
    |1-2\tilde{\alpha}| &amp; \tilde{\alpha} &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \tilde{\alpha} &amp; |1-2\tilde{\alpha}| &amp; \tilde{\alpha} &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; \tilde{\alpha} &amp; |1-2\tilde{\alpha}| &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; 0&amp;  \tilde{\alpha} &amp; |1-2\tilde{\alpha}|
\end{pmatrix}\begin{matrix}
    \to \; \; \tilde{\alpha}+|1-2\tilde{\alpha}| \\ \to 2\tilde{\alpha}+|1-2\tilde{\alpha}|\\ \to 2\tilde{\alpha}+|1-2\tilde{\alpha}|\\ \vdots \\ \to \; \; \tilde{\alpha}+|1-2\tilde{\alpha}|.
\end{matrix}
\]</span> The row sums of the absolute terms of this matrix are <span class="math display">\[a=\tilde{\alpha}+|1-2\tilde{\alpha}| \quad \text{and} \quad b=2\tilde{\alpha}+|1-2\tilde{\alpha}|.\]</span> Since <span class="math inline">\(tilde{\alpha}&gt;0\)</span>, then <span class="math inline">\(b&gt;a\)</span> and therefore, <span class="math inline">\(\left\| \mathcal{I}+h_tA \right\|_{\infty}=b=2\tilde{\alpha}+|1-2\tilde{\alpha}|\)</span>. Consider the two cases <span class="math inline">\(1-2\tilde{\alpha}&gt;0\)</span> and <span class="math inline">\(1-2\tilde{\alpha}&lt;0\)</span>.</p>
<ol type="1">
<li><p>If <span class="math inline">\(1-2\tilde{\alpha}&gt;0\)</span>, then <span class="math inline">\(0&lt;\tilde{\alpha}&lt;\frac{1}{2}\)</span>: <span class="math display">\[\left\| \mathcal{I}+h_tA \right\|_{\infty}=|1-2\tilde{\alpha}|+2\tilde{\alpha}=1-2\tilde{\alpha}+2\tilde{\alpha}=1,\]</span> therefore <span class="math inline">\(\left\| \mathcal{I}+h_tA \right\|_{\infty} \leq 1\)</span>.</p></li>
<li><p>If <span class="math inline">\(1-2\tilde{\alpha}&lt;0\)</span>, then <span class="math inline">\(\tilde{\alpha}&gt;\frac{1}{2}\)</span>: <span class="math display">\[\left\| \mathcal{I}+h_tA \right\|_{\infty}=|1-2\tilde{\alpha}|+2\tilde{\alpha}=2\tilde{\alpha}-1+2\tilde{\alpha}=4\tilde{\alpha}-1,\]</span> therefore in this case, if <span class="math inline">\(\left\| \mathcal{I}+h_tA \right\|_{\infty}\)</span> needs to be less than or equal to <span class="math inline">\(1\)</span>, then <span class="math display">\[\left\| \mathcal{I}+h_tA \right\|_{\infty}\leq 1 \quad \implies \quad 4\tilde{\alpha}-1\leq 1 \quad \implies \quad\tilde{\alpha} \leq \frac{1}{2}\]</span> which contradicts with the assumption that <span class="math inline">\(\tilde{\alpha}&gt;\frac{1}{2}\)</span>.</p></li>
</ol>
<p>This means that the Euler method produces a stable convergent solution if <span class="math display">\[\tilde{\alpha} &lt; \frac{1}{2} \quad \implies \quad \alpha\frac{h_t}{h_x^2}&lt;\frac{1}{2}.\]</span> In terms of number of spatial and temporal points <span class="math inline">\(N_x\)</span> and <span class="math inline">\(N_t\)</span> respectively, this restriction would be <span class="math display">\[2 \alpha \frac{t_f-t_0}{(L-x_0)^2} \frac{N_x^2}{N_t} &lt; 1\]</span> So for a fixed diffusivity <span class="math inline">\(\alpha\)</span>, if the time step <span class="math inline">\(h_t\)</span> is to be halved, then the spatial step would should be quartered.</p>
</section>
</section>
<section id="stability-of-the-convection-diffusion-equation" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="stability-of-the-convection-diffusion-equation"><span class="header-section-number">11.5</span> Stability of the Convection-Diffusion Equation</h2>
<p>Now that it has been established that both the heat and advection equations are asymptotically stable and the stepsize bounds have been found, it is time to combine both cases to tackle the convection-diffusion equation.</p>
<p>When discretised, the convection-diffusion equation can be written as <span class="math inline">\(\frac{\mathrm{d} \boldsymbol{U}}{\mathrm{d} t}=A\boldsymbol{U}+\boldsymbol{b}\)</span> where the matrix <span class="math inline">\(A\)</span> is given by <span class="math display">\[
A=\frac{\alpha}{h_x^2}\begin{pmatrix}
    -2 &amp; 1 &amp; \dots &amp; 0 &amp; 0 \\
    1 &amp; -2 &amp; \dots &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
    0 &amp; 0 &amp; \dots &amp; -2 &amp; 1 \\
    0 &amp; 0 &amp; \dots &amp; 1 &amp; -2 \\
\end{pmatrix}+\frac{v}{h_x}\begin{pmatrix}
    -1 &amp; 0 &amp; \dots &amp; 0 &amp; 0 \\
    1 &amp; -1 &amp; \dots &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
    0 &amp; 0 &amp; \dots &amp; -1 &amp; 0 \\
    0 &amp; 0 &amp; \dots &amp; 1 &amp; -1 \\
\end{pmatrix}.
\]</span></p>
<p>The Gershgorin theorem can be applied to the matrix <span class="math inline">\(A\)</span> to show that all the eigenvectors have negative real parts. Indeed, <span class="math display">\[
A=
\begin{pmatrix}
    -2\hat{\alpha}-\hat{v} &amp; \hat{\alpha} &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \hat{\alpha}+\hat{v} &amp; -2\hat{\alpha}-\hat{v} &amp; \hat{\alpha} &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; \hat{\alpha}+\hat{v} &amp; -2\hat{\alpha}-\hat{v} &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; 0&amp;  \hat{\alpha}+\hat{v} &amp; -2\hat{\alpha}-\hat{v}
\end{pmatrix}.
\]</span> where <span class="math inline">\(\hat{\alpha}=\frac{\alpha}{h_x^2}\)</span> and <span class="math inline">\(\hat{v}=\frac{v}{h_x}\)</span>. By the Gershgorin theorem, the centres of the circles will be located at the diagonal terms, namely at <span class="math inline">\(-2\hat{\alpha}-\hat{v}\)</span> with the radii <span class="math inline">\(\hat{\alpha}\)</span>, <span class="math inline">\(\hat{\alpha}+\hat{v}\)</span> and <span class="math inline">\(2\hat{\alpha}+\hat{v}\)</span>. The largest radius is <span class="math inline">\(2\hat{\alpha}+\hat{v}\)</span> which means that all the eigenvalues will be negative as shown below. Therefore the convection-diffusion equation is asymptotically stable.</p>
<p><img src="figures/Gersch.jpg" class="img-fluid"></p>
<p>To find the bound for the stepsizes, consider the convection-diffusion equation after the discretisation <span class="math inline">\(\frac{\mathrm{d} \boldsymbol{U}}{\mathrm{d} t}=A\boldsymbol{U}+\boldsymbol{b}\)</span> where <span class="math inline">\(A=\frac{\alpha}{h_x^2}A_1+\frac{v}{h_x}A_2\)</span>. The Euler method is numerically stable if the time step <span class="math inline">\(h_t\)</span> satisfies <span class="math display">\[\left\| \mathcal{I}+h_t A \right\|_{\infty} \leq 1.\]</span> Calculating <span class="math inline">\(\mathcal{I}+h_t A\)</span>: <span class="math display">\[
\mathcal{I}+h_t A=
\begin{pmatrix}
    1-2\tilde{\alpha}-\tilde{v} &amp; \tilde{\alpha} &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \tilde{\alpha}+\tilde{v} &amp; 1-2\tilde{\alpha}-\tilde{v} &amp; \tilde{\alpha} &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; \tilde{\alpha}+\tilde{v} &amp; 1-2\tilde{\alpha}-\tilde{v} &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; 1-2\tilde{\alpha}-\tilde{v} &amp; \tilde{\alpha} &amp; 0\\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; \tilde{\alpha}+\tilde{v} &amp; 1-2\tilde{\alpha}-\tilde{v} &amp; \tilde{\alpha} \\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; 0&amp;  \tilde{\alpha}+\tilde{v} &amp; 1-2\tilde{\alpha}-\tilde{v}
\end{pmatrix}
\]</span> where <span class="math inline">\(\tilde{\alpha}=\frac{\alpha h_t}{h_x^2}\)</span> and <span class="math inline">\(\tilde{v}=\frac{v h_t}{h_x}\)</span>. Taking the absolute value of all the terms and adding the rows gives <span class="math display">\[\begin{multline*}
\mathrm{abs}\left( \mathcal{I}+h_t A \right)=
\begin{pmatrix}
    |1-2\tilde{\alpha}-\tilde{v}| &amp; \tilde{\alpha} &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \tilde{\alpha}+\tilde{v} &amp; |1-2\tilde{\alpha}-\tilde{v}| &amp; \tilde{\alpha} &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; \tilde{\alpha}+\tilde{v} &amp; |1-2\tilde{\alpha}-\tilde{v}| &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; 0&amp;  \tilde{\alpha}+\tilde{v} &amp; |1-2\tilde{\alpha}-\tilde{v}|
\end{pmatrix}\\\begin{matrix}
\to \; \; \; \; \; \; \; \; \tilde{\alpha} +|1-2\tilde{\alpha}-\tilde{v}| \\ \to 2\tilde{\alpha}+\tilde{v}+|1-2\tilde{\alpha}-\tilde{v}|\\ \to 2\tilde{\alpha}+\tilde{v}+|1-2\tilde{\alpha}-\tilde{v}|\\ \vdots \\ \to \; \; \tilde{\alpha}+\tilde{v}+|1-2\tilde{\alpha}-\tilde{v}|
\end{matrix}.
\end{multline*}\]</span></p>
<p>The row sums of the absolute terms of this matrix are <span class="math display">\[a=\tilde{\alpha}+|1-2\tilde{\alpha}-\tilde{v}|, \quad b=2\tilde{\alpha}+\tilde{v}+|1-2\tilde{\alpha}-\tilde{v}| \quad \text{and} \quad c=\tilde{\alpha}+\tilde{v}+|1-2\tilde{\alpha}-\tilde{v}|.\]</span> Since <span class="math inline">\(\tilde{\alpha}&gt;0\)</span> and <span class="math inline">\(\tilde{v}&gt;0\)</span>, then <span class="math inline">\(b&gt;c&gt;a\)</span>, therefore, <span class="math inline">\(\left\| \mathcal{I}+h_tA \right\|_{\infty}=b=2\tilde{\alpha}+\tilde{v}+|1-2\tilde{\alpha}-\tilde{v}|\)</span>. Consider the two cases <span class="math inline">\(1-2\tilde{\alpha}-\tilde{v}&gt;0\)</span> and <span class="math inline">\(1-2\tilde{\alpha}-\tilde{v}&lt;0\)</span>.</p>
<ol type="1">
<li><p>If <span class="math inline">\(1-2\tilde{\alpha}-\tilde{v}&gt;0\)</span>, then <span class="math inline">\(2\tilde{\alpha}+\tilde{v}&lt;1\)</span>: <span class="math display">\[\left\| \mathcal{I}+h_tA \right\|_{\infty}=|1-2\tilde{\alpha}-\tilde{v}|+2\tilde{\alpha}+\tilde{v}=1-2\tilde{\alpha}-\tilde{v}+2\tilde{\alpha}+\tilde{v}=1,\]</span> therefore <span class="math inline">\(\left\| \mathcal{I}+h_tA \right\|_{\infty} \leq 1\)</span>.</p></li>
<li><p>If <span class="math inline">\(1-2\tilde{\alpha}-\tilde{v}&lt;0\)</span>, then <span class="math inline">\(2\tilde{\alpha}+\tilde{v}&gt;1\)</span>: <span class="math display">\[\left\| \mathcal{I}+h_tA \right\|_{\infty}=|1-2\tilde{\alpha}-\tilde{v}|+2\tilde{\alpha}+\tilde{v}=2\tilde{\alpha}+\tilde{v}-1+2\tilde{\alpha}+\tilde{v}=4\tilde{\alpha}+2\tilde{v}-1,\]</span> therefore in this case, if <span class="math inline">\(\left\| \mathcal{I}+h_tA \right\|_{\infty}\)</span> needs to be less than or equal to <span class="math inline">\(1\)</span>, then <span class="math display">\[\left\| \mathcal{I}+h_tA \right\|_{\infty}\leq 1 \quad \implies \quad 4\tilde{\alpha}+2\tilde{v}-1\leq 1 \quad \implies \quad 2\tilde{\alpha}+\tilde{v} \leq 1\]</span> which contradicts with the assumption that <span class="math inline">\(2\tilde{\alpha}+\tilde{v}&gt;1\)</span>.</p></li>
</ol>
<p>This means that the Euler method will produce a stable convergent solution if <span class="math display">\[2\tilde{\alpha}+\tilde{v} &lt; 1 \quad \implies \quad 2\alpha\frac{h_t}{h_x^2}+v\frac{h_t}{h_x}&lt;1.\]</span> This means that a choice can be made with regards to the bounds of the different components, for instance, the values of <span class="math inline">\(h_x\)</span> and <span class="math inline">\(h_t\)</span> can be chosen such that <span class="math display">\[\tilde{\alpha}&lt;\frac{1}{4} \quad \text{and} \quad \tilde{v}&lt;\frac{1}{2} \quad \text{or} \quad \tilde{\alpha}&lt;\frac{1}{3} \quad \text{and} \quad \tilde{v}&lt;\frac{1}{3}\]</span> or any combination thereof provided that the choices satisfy the inequality <span class="math inline">\(2\tilde{\alpha}+\tilde{v} &lt; 1\)</span>.</p>
<div class="callout callout-style-default callout-caution callout-titled" title="Bound for Convection-Diffusion">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bound for Convection-Diffusion
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the convection-diffusion equation <span class="math display">\[
\frac{\partial u}{\partial t}=0.1\frac{\partial^{2} u}{\partial x^{2}}-0.5\frac{\partial u}{\partial x} \quad
\begin{matrix}
    t \in [0,10] \\ x \in [-2,2]
\end{matrix}
\]</span> <span class="math display">\[u(x,0)=u_{init}(x)=10, \quad u(-2,t)=u_l(t)=1, \quad u(2,t)=u_r(t)=0.\]</span> This can be discretised to give <span class="math inline">\(\frac{\mathrm{d} \boldsymbol{U}}{\mathrm{d} t}=A\boldsymbol{U}\)</span> where <span class="math display">\[
\frac{\mathrm{d} }{\mathrm{d} t}\underbrace{\begin{pmatrix}
    U_1(t) \\
    U_2(t) \\
    \vdots \\
    U_{N-1}(t) \\
    U_N(t)
\end{pmatrix}}_{\boldsymbol{U}}\]</span> <span class="math display">\[=
\underbrace{\left[\frac{0.1}{h_x^2}\begin{pmatrix}
    -2 &amp; 1 &amp; \dots &amp; 0 &amp; 0 \\
    1 &amp; -2 &amp; \dots &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
    0 &amp; 0 &amp; \dots &amp; -2 &amp; 1 \\
    0 &amp; 0 &amp; \dots &amp; 1 &amp; -2 \\
\end{pmatrix}+\frac{0.5}{h_x}\begin{pmatrix}
    -1 &amp; 0 &amp; \dots &amp; 0 &amp; 0 \\
    1 &amp; -1 &amp; \dots &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
    0 &amp; 0 &amp; \dots &amp; -1 &amp; 0 \\
    0 &amp; 0 &amp; \dots &amp; 1 &amp; -1 \\
\end{pmatrix}\right]}_{A}
\underbrace{\begin{pmatrix}
    U_1(t) \\
    U_2(t) \\
    \vdots \\
    U_{N-1}(t) \\
    U_N(t)
\end{pmatrix}}_{\boldsymbol{U}}
\]</span> subject to <span class="math display">\[
    \boldsymbol{U}(0)=\begin{pmatrix}
        u_{init}(x_1) \\
        u_{init}(x_2) \\
        \vdots \\
        u_{init}(x_{N-1}) \\
        u_{init}(x_{N}) \\
    \end{pmatrix} \quad \text{where} \quad u_{init}(x)=10.
\]</span> As yet, the value of <span class="math inline">\(N\)</span> has not been put forward since the stepsizes need to be established first. For a stable Euler method, the stepsizes <span class="math inline">\(h_t\)</span> and <span class="math inline">\(h_x\)</span> need to satisfy <span class="math display">\[2\alpha\frac{h_t}{h_x^2}+v\frac{h_t}{h_x} &lt; 1 \quad \implies \quad 2\frac{h_t}{h_x}+5\frac{h_t}{h_x^2}&lt;10.\]</span> If <span class="math inline">\(h_t=2.5\times 10^{-5}\)</span> and <span class="math inline">\(h_x=0.02\)</span> (which corresponds to <span class="math inline">\(N_t=40000\)</span> and <span class="math inline">\(N_x=100\)</span>), then the Euler method will be stable.</p>
</div>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The thermal diffusivity will always be regarded as a constant and usually takes the form <span class="math inline">\(\alpha=\frac{k}{\rho Cp}\)</span> where <span class="math inline">\(k\)</span> is the thermal conductivity, <span class="math inline">\(\rho\)</span> is the density of the material and <span class="math inline">\(Cp\)</span> is the specific heat capacity.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./Part_PDEs.html" class="pagination-link" aria-label="Solving Partial Differential Equations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Solving Partial Differential Equations</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Z_App_Basic.html" class="pagination-link" aria-label="MATLAB Basics">
        <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">MATLAB Basics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>