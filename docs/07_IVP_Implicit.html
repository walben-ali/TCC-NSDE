<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Numerical Solutions of Differential Equations – 7&nbsp; Implicit IVP Solvers</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Part_BVPs.html" rel="next">
<link href="./06_IVP_InBuilt.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Part_IVPs.html">Solving Initial Value Problems</a></li><li class="breadcrumb-item"><a href="./07_IVP_Implicit.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Implicit IVP Solvers</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Numerical Solutions of Differential Equations</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.docx">
              <i class="bi bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Numerical-Solutions-of-Differential-Equations.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Internal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Internal Workings of MATLAB</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_LinAlg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Algebra</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_LinAlg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Solving Linear Systems of Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_IVPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Initial Value Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_IVP_Euler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Euler Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_IVP_ModEuler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Modified Euler Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_IVP_RK4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fourth Order Runge-Kutta Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_IVP_InBuilt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">MATLAB’s In-Built Procedures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_IVP_Implicit.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Implicit IVP Solvers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_BVPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Boundary Value Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_BVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Boundary Value Problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_MVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Mixed Value Problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_SBVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Symmetric Boundary Conditions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Part_PDEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving Partial Differential Equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_PDE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Heat Equation</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#backwards-euler-method" id="toc-backwards-euler-method" class="nav-link active" data-scroll-target="#backwards-euler-method"><span class="header-section-number">7.1</span> Backwards Euler Method</a></li>
  <li><a href="#stability-of-the-backwards-euler-method" id="toc-stability-of-the-backwards-euler-method" class="nav-link" data-scroll-target="#stability-of-the-backwards-euler-method"><span class="header-section-number">7.2</span> Stability of the Backwards Euler Method</a></li>
  <li><a href="#order-of-accuracy" id="toc-order-of-accuracy" class="nav-link" data-scroll-target="#order-of-accuracy"><span class="header-section-number">7.3</span> Order of Accuracy</a></li>
  <li><a href="#matlab-code" id="toc-matlab-code" class="nav-link" data-scroll-target="#matlab-code"><span class="header-section-number">7.4</span> MATLAB Code</a></li>
  <li><a href="#stiff-differential-equations" id="toc-stiff-differential-equations" class="nav-link" data-scroll-target="#stiff-differential-equations"><span class="header-section-number">7.5</span> Stiff Differential Equations</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Part_IVPs.html">Solving Initial Value Problems</a></li><li class="breadcrumb-item"><a href="./07_IVP_Implicit.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Implicit IVP Solvers</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Implicit IVP Solvers</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p>In some cases, IVPs can be difficult to solve because of the non-linearity of its terms, this is where <strong><em>Implicit Methods</em></strong> should be used to accommodate for these issues.</p>
<section id="backwards-euler-method" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="backwards-euler-method"><span class="header-section-number">7.1</span> Backwards Euler Method</h2>
<p>Consider the Euler method at the starting time <span class="math inline">\(t=t_0\)</span>. The value of the function <span class="math inline">\(y\)</span> at <span class="math inline">\(t_1=t_0+h\)</span> is approximated by <span class="math display">\[
    y(t_1) \approx Y_1=Y_0+hy'(t_0)
\]</span> and this gives an upper bound for a stable stepsize of <span class="math display">\[
    h_0=2\min\left(\frac{|\Re(\lambda_k)|}{|\lambda_k|^2}\right)
\]</span> in order to ensure that the Euler method is computationally stable. However, suppose that this modified slightly by using the gradient at <span class="math inline">\(y(t_1)\)</span> rather than at <span class="math inline">\(y(t_0)\)</span>, in other words, suppose that the value of <span class="math inline">\(y\)</span> at <span class="math inline">\(t_1\)</span> is approximated by <span class="math display">\[
    y(t_1) \approx Y_1=Y_0+h\underline{\underline{y'(t_1)}}.
\]</span> This approach is known as the <strong><em>Backwards Euler Method</em></strong> and is an implicit procedure since the value of <span class="math inline">\(y'(t_1)\)</span> is not known to begin with.</p>
<p>The general formulation is as follows: Consider the system of differential equations <span class="math display">\[\boldsymbol{y}'=A\boldsymbol{y}+\boldsymbol{b}(t) \quad \text{with} \quad \boldsymbol{y}(t_0)=\boldsymbol{y}_0, \quad x \in [t_0,t_f].\]</span> Discretise the interval <span class="math inline">\([t_0,t_f]\)</span> into <span class="math inline">\(N\)</span> equal subintervals, each with width <span class="math inline">\(h=\frac{t_f-t_0}{N}\)</span>. At the time step <span class="math inline">\(t=t_n=t_0+nh\)</span>, the backwards Euler method is <span class="math display">\[\boldsymbol{Y}_{n+1}=\boldsymbol{Y}_n+h\boldsymbol{y}'(t_{n+1})=\boldsymbol{Y}_n+h\left[ A\boldsymbol{Y}_{n+1}+\boldsymbol{b}(t_{n+1}) \right].\]</span> This can be rearranged to give <span class="math display">\[(I-hA)\boldsymbol{Y}_{n+1}=\boldsymbol{Y}_n+h\boldsymbol{b}(t_{n+1}).\]</span></p>
<p>Rearranging further fives the basis for the Backwards Euler iteration which is <span class="math display">\[\boldsymbol{Y}_{n+1}=(I-hA)^{-1}\left[\boldsymbol{Y}_n+h\boldsymbol{b}(t_{n+1})\right]\]</span> whereas the standard Euler method in matrix form is <span class="math display">\[\boldsymbol{Y}_{n+1}=(I+hA)^{-1}\boldsymbol{Y}_n+h\boldsymbol{g}(t_{n+1}).\]</span> The Euler method requires <em>explicit calculations</em> using matrix multiplications but the backwards Euler method requires matrix inversion instead.</p>
</section>
<section id="stability-of-the-backwards-euler-method" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="stability-of-the-backwards-euler-method"><span class="header-section-number">7.2</span> Stability of the Backwards Euler Method</h2>
<p>Consider the initial value problem in its scalar form <span class="math display">\[\frac{\mathrm{d} y}{\mathrm{d} t}=\lambda y+b(t) \quad \text{with} \quad y(0)=y_0.\]</span> The backwards Euler method at the time <span class="math inline">\(t=t_{n+1}=t_0+(n+1)h\)</span> gives <span class="math display">\[Y_{n+1}=(1-h \lambda)^{-1}\left[Y_n+hg(t_{n+1})\right].\]</span> This initial condition can be perturbed by adding a small parameter <span class="math inline">\(\varepsilon\neq 0\)</span> to give the perturbed differential equation <span class="math display">\[\frac{\mathrm{d} z}{\mathrm{d} t}=\lambda z+g(t) \quad \text{with} \quad z(0)=y_0+\varepsilon.\]</span> The backwards Euler then yields <span class="math display">\[Z_{n+1}=(1-h \lambda)^{-1}\left[Z_n+hg(t_{n+1})\right]\]</span> The differential equations in <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span> can be subtracted to give a perturbation term <span class="math inline">\(E\)</span> where <span class="math display">\[E_{n+1}=Z_{n+1}-Y_{n+1}=(1-h \lambda)^{-1}\left[Z_n-Y_n\right]=(1-h \lambda)^{-1}E_n.\]</span> Notice that once again, the forcing function <span class="math inline">\(g(t)\)</span> has been eliminated and therefore does not affect the stability of the backwards Euler method. The differential equation for <span class="math inline">\(E\)</span> will have the initial condition <span class="math inline">\(E_0=Z_0-Y_0=\varepsilon\)</span>. This expression can be used to represent <span class="math inline">\(E_n\)</span> in terms of <span class="math inline">\(\varepsilon\)</span> recursively as: <span class="math display">\[\begin{multline*}
E_n=(1-h\lambda)^{-1}E_{n-1}=(1-h\lambda)^{-2}E_{n-2}\\
=\dots=(1-h\lambda)^{-(n-1)}E_1=(1-h\lambda)^{-n}E_0=(1-h\lambda)^{-n}\varepsilon.
\end{multline*}\]</span> <span class="math display">\[\implies \quad E_n=(1-h\lambda)^{-n}\varepsilon.\]</span> This means that the method is stable for stepsizes <span class="math inline">\(h\)</span> that satisfy <span class="math inline">\(|1-h\lambda|&gt;1\)</span> and since <span class="math inline">\(\lambda&lt;0\)</span> for an asymptotically stable system, then this inequality is <em>always</em> satisfied. This means that the backwards Euler method is stable <em>for all</em> stepsizes <span class="math inline">\(h&gt;0\)</span>, no matter how large.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Backwards Euler Method
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the differential equation <span class="math display">\[
    y'=-100y+100\sin(t) \quad \text{with} \quad y(0)=1.
\]</span> In this case, <span class="math inline">\(\lambda&lt;0\)</span> meaning that this differential equation is asymptotic stable. The maximum allowable stepsize for the Euler method is <span class="math inline">\(h_0=\frac{2}{|-100|}=0.02\)</span>. However, the backwards Euler method is stable for any stepsize <span class="math inline">\(h\)</span> as seen below (very large stepsizes will still converge but they will not give any useful information).</p>
<p><img src="figures/Unstable3.jpg" class="img-fluid"></p>
</div>
</div>
<p>The formulation presented above also holds for sets of differential equations in the same way with one difference. Instead of having <span class="math inline">\((1-h\lambda)^{-1}=\frac{1}{1-h\lambda}\)</span>, the procedure for systems will require the matrix inverse <span class="math inline">\((1-\lambda A)^{-1}\)</span> or the MATLAB backslash operator can be used instead.</p>
</section>
<section id="order-of-accuracy" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="order-of-accuracy"><span class="header-section-number">7.3</span> Order of Accuracy</h2>
<p>The backwards Euler method is numerically stable for all values the stepsize <span class="math inline">\(h\)</span> and has the same order of accuracy as the Euler method, i.e.&nbsp;the local truncation error is of <span class="math inline">\(\mathcal{O}\left(h^2\right)\)</span> while the global integration error is of <span class="math inline">\(\mathcal{O}\left(h\right)\)</span>. However, this increased stability comes at a cost, the backwards Euler methods requires double the computational cost compared to the Euler method.</p>
</section>
<section id="matlab-code" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="matlab-code"><span class="header-section-number">7.4</span> MATLAB Code</h2>
<p>The following MATLAB code performs the Backwards Euler iteration for the system <span class="math inline">\(\boldsymbol{y}'=A\boldsymbol{y}+\boldsymbol{b}(t)\)</span> subject to <span class="math inline">\(\boldsymbol{y}(0)=\boldsymbol{y}_0\)</span> where <span class="math display">\[A=\begin{pmatrix} -7 &amp; -2 &amp; 1 \\ 2 &amp; -1 &amp; -9 \\ 0 &amp; 0 &amp; -5 \end{pmatrix}, \quad \boldsymbol{b}(t)=\begin{pmatrix} \sin(t) \\ 0 \\ 2 \end{pmatrix}, \quad \boldsymbol{y}_0=\begin{pmatrix} 0 \\ 1 \\ 0 \end{pmatrix}.\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">function</span> <span class="va">IVP_Back_Euler</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">%% Solve a set of first order IVPs using Backwards Euler</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">% This code solves a set of IVP when written in the form</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">% dydt=A*y+b(t) on the interval [t0,tf] subject to the</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">% initial conditions y(0)=y0.  The output will be the graph</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">% of the solution(s) and the vector value at the final</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">% point tf.</span></span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">%% Lines to change:</span></span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">% Line 25   : t0 - Start time</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">% Line 28   : tf - End time</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">% Line 31   : N  - Number of subdivisions</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">% Line 34   : A  - Matrix A</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">% Line 37   : b  -  Forcing vector b(t)</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">% Line 40   : y0 - Vector of initial values</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co">% Line 106+ : Which functions to plot, remembering to assign</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co">%             a colour, texture and legend label</span></span>
<span id="cb1-21"><a href="#cb1-21"></a></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="co">%% Set up input values</span></span>
<span id="cb1-23"><a href="#cb1-23"></a></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co">% Start time</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="va">t0</span><span class="op">=</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb1-26"><a href="#cb1-26"></a></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="co">% End time</span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="va">tf</span><span class="op">=</span><span class="fl">1</span><span class="op">;</span></span>
<span id="cb1-29"><a href="#cb1-29"></a></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="co">% Number of subdivisions</span></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="va">N</span><span class="op">=</span><span class="fl">5000</span><span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32"></a></span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="co">% Matrix A</span></span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="va">A</span><span class="op">=</span>[<span class="op">-</span><span class="fl">7</span><span class="op">,-</span><span class="fl">2</span><span class="op">,</span><span class="fl">1</span><span class="op">;</span><span class="fl">2</span><span class="op">,-</span><span class="fl">1</span><span class="op">,-</span><span class="fl">9</span><span class="op">;</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,-</span><span class="fl">5</span>]<span class="op">;</span></span>
<span id="cb1-35"><a href="#cb1-35"></a></span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="co">% Vector b, which can be a function of t in general</span></span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="va">b</span><span class="op">=@</span>(<span class="va">t</span>) [<span class="va">sin</span>(<span class="va">t</span>)<span class="op">;</span><span class="fl">0</span><span class="op">;</span><span class="fl">2</span>]<span class="op">;</span></span>
<span id="cb1-38"><a href="#cb1-38"></a></span>
<span id="cb1-39"><a href="#cb1-39"></a><span class="co">% Column vector initial values y0=y(t0)</span></span>
<span id="cb1-40"><a href="#cb1-40"></a><span class="va">y0</span><span class="op">=</span>[<span class="fl">0</span><span class="op">;</span><span class="fl">1</span><span class="op">;</span><span class="fl">0</span>]<span class="op">;</span></span>
<span id="cb1-41"><a href="#cb1-41"></a></span>
<span id="cb1-42"><a href="#cb1-42"></a><span class="co">%% Set up IVP solver parameters</span></span>
<span id="cb1-43"><a href="#cb1-43"></a></span>
<span id="cb1-44"><a href="#cb1-44"></a><span class="co">% T = Vector of times t0,t1,...,tN.</span></span>
<span id="cb1-45"><a href="#cb1-45"></a><span class="co">% This is generated using linspace which splits the</span></span>
<span id="cb1-46"><a href="#cb1-46"></a><span class="co">% interval [t0,tf] into N+1 points (or N subintervals)</span></span>
<span id="cb1-47"><a href="#cb1-47"></a><span class="va">T</span><span class="op">=</span><span class="va">linspace</span>(<span class="va">t0</span><span class="op">,</span><span class="va">tf</span><span class="op">,</span><span class="va">N</span><span class="op">+</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48"></a></span>
<span id="cb1-49"><a href="#cb1-49"></a><span class="co">% Stepsize</span></span>
<span id="cb1-50"><a href="#cb1-50"></a><span class="va">h</span><span class="op">=</span>(<span class="va">tf</span><span class="op">-</span><span class="va">t0</span>)<span class="op">/</span><span class="va">N</span><span class="op">;</span></span>
<span id="cb1-51"><a href="#cb1-51"></a></span>
<span id="cb1-52"><a href="#cb1-52"></a><span class="co">% Number of differential equations</span></span>
<span id="cb1-53"><a href="#cb1-53"></a><span class="va">K</span><span class="op">=</span><span class="va">length</span>(<span class="va">y0</span>)<span class="op">;</span></span>
<span id="cb1-54"><a href="#cb1-54"></a></span>
<span id="cb1-55"><a href="#cb1-55"></a><span class="co">%% Perform the Euler iteration</span></span>
<span id="cb1-56"><a href="#cb1-56"></a></span>
<span id="cb1-57"><a href="#cb1-57"></a><span class="co">% Y = Solution matrix</span></span>
<span id="cb1-58"><a href="#cb1-58"></a><span class="co">% The matrix Y will contain K rows and N+1 columns.  Every</span></span>
<span id="cb1-59"><a href="#cb1-59"></a><span class="co">% row corresponds to a different IVP and every column</span></span>
<span id="cb1-60"><a href="#cb1-60"></a><span class="co">% corresponds to a different time.  So the matrix Y will</span></span>
<span id="cb1-61"><a href="#cb1-61"></a><span class="co">% take the following form:</span></span>
<span id="cb1-62"><a href="#cb1-62"></a><span class="co">% y_1(t_0)  y_1(t_1)  y_1(t_2)  ...  y_1(t_N)</span></span>
<span id="cb1-63"><a href="#cb1-63"></a><span class="co">% y_2(t_0)  y_2(t_1)  y_2(t_2)  ...  y_2(t_N)</span></span>
<span id="cb1-64"><a href="#cb1-64"></a><span class="co">% ...</span></span>
<span id="cb1-65"><a href="#cb1-65"></a><span class="co">% y_K(t_0)  y_K(t_1)  y_K(t_2)  ...  y_K(t_N)</span></span>
<span id="cb1-66"><a href="#cb1-66"></a><span class="va">Y</span><span class="op">=</span><span class="va">zeros</span>(<span class="va">K</span><span class="op">,</span><span class="va">N</span><span class="op">+</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-67"><a href="#cb1-67"></a></span>
<span id="cb1-68"><a href="#cb1-68"></a><span class="co">% The first column of the vector Y is the initial vector y0</span></span>
<span id="cb1-69"><a href="#cb1-69"></a><span class="va">Y</span>(<span class="op">:,</span><span class="fl">1</span>)<span class="op">=</span><span class="va">y0</span><span class="op">;</span></span>
<span id="cb1-70"><a href="#cb1-70"></a></span>
<span id="cb1-71"><a href="#cb1-71"></a><span class="co">% Set the current time t to be the starting time t0 and the</span></span>
<span id="cb1-72"><a href="#cb1-72"></a><span class="co">% current value of the vector y to be the strtaing values y0</span></span>
<span id="cb1-73"><a href="#cb1-73"></a><span class="va">y</span><span class="op">=</span><span class="va">y0</span><span class="op">;</span></span>
<span id="cb1-74"><a href="#cb1-74"></a></span>
<span id="cb1-75"><a href="#cb1-75"></a><span class="kw">for</span> <span class="va">n</span><span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">+</span><span class="fl">1</span></span>
<span id="cb1-76"><a href="#cb1-76"></a></span>
<span id="cb1-77"><a href="#cb1-77"></a>    <span class="va">t</span><span class="op">=</span><span class="va">T</span>(<span class="va">n</span>)<span class="op">;</span>                     <span class="co">% Update the new time</span></span>
<span id="cb1-78"><a href="#cb1-78"></a></span>
<span id="cb1-79"><a href="#cb1-79"></a>    <span class="va">y</span><span class="op">=</span>(<span class="va">eye</span>(<span class="va">K</span><span class="op">,</span><span class="va">K</span>)<span class="op">-</span><span class="va">h</span><span class="op">*</span><span class="va">A</span>)<span class="op">\</span>(<span class="va">y</span><span class="op">+</span><span class="va">h</span><span class="op">*</span><span class="va">b</span>(<span class="va">t</span>))<span class="op">;</span><span class="co">% Find y at the current step</span></span>
<span id="cb1-80"><a href="#cb1-80"></a></span>
<span id="cb1-81"><a href="#cb1-81"></a>    <span class="va">Y</span>(<span class="op">:,</span><span class="va">n</span>)<span class="op">=</span><span class="va">y</span><span class="op">;</span>                   <span class="co">% Replace row n in Y with y</span></span>
<span id="cb1-82"><a href="#cb1-82"></a></span>
<span id="cb1-83"><a href="#cb1-83"></a><span class="kw">end</span></span>
<span id="cb1-84"><a href="#cb1-84"></a></span>
<span id="cb1-85"><a href="#cb1-85"></a><span class="co">%% Setting plot parameters</span></span>
<span id="cb1-86"><a href="#cb1-86"></a></span>
<span id="cb1-87"><a href="#cb1-87"></a><span class="co">% Clear figure</span></span>
<span id="cb1-88"><a href="#cb1-88"></a><span class="va">clf</span></span>
<span id="cb1-89"><a href="#cb1-89"></a></span>
<span id="cb1-90"><a href="#cb1-90"></a><span class="co">% Hold so more than one line can be drawn</span></span>
<span id="cb1-91"><a href="#cb1-91"></a><span class="va">hold</span> <span class="va">on</span></span>
<span id="cb1-92"><a href="#cb1-92"></a></span>
<span id="cb1-93"><a href="#cb1-93"></a><span class="co">% Turn on grid</span></span>
<span id="cb1-94"><a href="#cb1-94"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb1-95"><a href="#cb1-95"></a></span>
<span id="cb1-96"><a href="#cb1-96"></a><span class="co">% Setting font size and style</span></span>
<span id="cb1-97"><a href="#cb1-97"></a><span class="va">set</span>(<span class="va">gca</span><span class="op">,</span><span class="ss">'FontSize'</span><span class="op">,</span><span class="fl">20</span><span class="op">,</span><span class="ss">'FontName'</span><span class="op">,</span><span class="ss">'Times'</span>)</span>
<span id="cb1-98"><a href="#cb1-98"></a><span class="va">set</span>(<span class="va">legend</span><span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'Latex'</span>)</span>
<span id="cb1-99"><a href="#cb1-99"></a></span>
<span id="cb1-100"><a href="#cb1-100"></a><span class="co">% Label the axes</span></span>
<span id="cb1-101"><a href="#cb1-101"></a><span class="va">xlabel</span>(<span class="ss">'$t$'</span><span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'Latex'</span>)</span>
<span id="cb1-102"><a href="#cb1-102"></a><span class="va">ylabel</span>(<span class="ss">'$\mathbf{y}(t)$'</span><span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'Latex'</span>)</span>
<span id="cb1-103"><a href="#cb1-103"></a></span>
<span id="cb1-104"><a href="#cb1-104"></a><span class="co">% Plot the desried solutions.  If all the solutions are</span></span>
<span id="cb1-105"><a href="#cb1-105"></a><span class="co">% needed, then consider using a for loop in that case</span></span>
<span id="cb1-106"><a href="#cb1-106"></a><span class="va">plot</span>(<span class="va">T</span><span class="op">,</span><span class="va">Y</span>(<span class="fl">1</span><span class="op">,:</span>)<span class="op">,</span><span class="ss">'-b'</span><span class="op">,</span><span class="ss">'LineWidth'</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="ss">'DisplayName'</span><span class="op">,</span><span class="ss">'$y_1(t)$'</span>)</span>
<span id="cb1-107"><a href="#cb1-107"></a><span class="va">plot</span>(<span class="va">T</span><span class="op">,</span><span class="va">Y</span>(<span class="fl">2</span><span class="op">,:</span>)<span class="op">,</span><span class="ss">'-r'</span><span class="op">,</span><span class="ss">'LineWidth'</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="ss">'DisplayName'</span><span class="op">,</span><span class="ss">'$y_1(t)$'</span>)</span>
<span id="cb1-108"><a href="#cb1-108"></a><span class="va">plot</span>(<span class="va">T</span><span class="op">,</span><span class="va">Y</span>(<span class="fl">3</span><span class="op">,:</span>)<span class="op">,</span><span class="ss">'-k'</span><span class="op">,</span><span class="ss">'LineWidth'</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="ss">'DisplayName'</span><span class="op">,</span><span class="ss">'$y_1(t)$'</span>)</span>
<span id="cb1-109"><a href="#cb1-109"></a></span>
<span id="cb1-110"><a href="#cb1-110"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stiff-differential-equations" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="stiff-differential-equations"><span class="header-section-number">7.5</span> Stiff Differential Equations</h2>
<p>Stiff sets of differential equations with a large value of the total computational cost <span class="math inline">\(N_0\)</span> can be very difficult to solve numerically using explicit methods but implicit methods can work very well. MATLAB has its very own built-in stiff differential equation solver under the command <code>ode15s</code> and this can be implemented exactly as <code>ode45</code>. This solves sets of differential equations implicitly using numerical differentiation of orders 1 to 5.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stiff IVPs
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the set of differential equations on the interval <span class="math inline">\([0,3500]\)</span> <span class="math display">\[\begin{align*}
&amp; \frac{\mathrm{d} y_1}{\mathrm{d} t}=y_2 &amp; y_1(0)=2 \\
&amp; \frac{\mathrm{d} y_2}{\mathrm{d} t}=1000(1-y_1^2)y_2-y_1 &amp; y_2(0)=0.
\end{align*}\]</span></p>
<p>This is a very stiff set of differential equations, solving this using <code>ode45</code> takes upwards of 92 seconds while solving using the stiff solver <code>ode15s</code> requires a mere 0.233 seconds (depending on you machine). The result of solving this differential equation is shown below for <span class="math inline">\(y_1(t)\)</span> only since <span class="math inline">\(y_2(t)\)</span> takes very large values and this distorts the graphical interpretation.</p>
<p><img src="figures/Back1.jpg" class="img-fluid"></p>
<p>Using the stiff solver optimises the stepsizes for stiff regions. Particularly, if a region is deemed to be considerably “stiff”, the <code>ode15s</code> will use smaller stepsizes to solve the problem but if there is a region where the differential is not “stiff”, then larger stepsizes will be used. Therefore, <code>ode15s</code> usually requires fewer grid points overall, for instance to solve the above set of differential equations, <code>ode15s</code> only requires 1,836 grid points while <code>ode45</code> requires 7,820,485 grid points, that is over 4,200 times more grid points than <code>ode15s</code>. This just goes to show that stiff differential need implicit methods, even though the cost for every step is greater than that of an explicit method, fewer steps are required in total.</p>
<p>An alternative stiff differential equation solver is <code>ode23s</code> which achieves that same outcome as <code>ode15s</code> but with a lower accuracy and more grid points using only second and third order methods.</p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./06_IVP_InBuilt.html" class="pagination-link" aria-label="MATLAB's In-Built Procedures">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">MATLAB’s In-Built Procedures</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Part_BVPs.html" class="pagination-link" aria-label="Solving Boundary Value Problems">
        <span class="nav-page-text">Solving Boundary Value Problems</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>